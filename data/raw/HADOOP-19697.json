{"expand": "renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations", "id": "13629211", "self": "https://issues.apache.org/jira/rest/api/2/issue/13629211", "key": "HADOOP-19697", "fields": {"summary": "google gs connector registration failing", "description": "Surfaced during HADOOP-19696 and work with all the cloud connectors on the classpath.\r\n\r\nThere's a missing dependency causing the gcs connector to fail to register *when the first filesystem is instantiated*, because the service registration process loads the gcs connector class, instantiates one and asks for its schema.\r\n\r\nAs well as a sign of a problem, it's better to just add an entry in core-default.xml as this saves all classloading overhead. It's what the other asf bundled ones do.", "reporter": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org", "name": "stevel@apache.org", "key": "stevel@apache.org", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"}, "displayName": "Steve Loughran", "active": true, "timeZone": "Europe/London"}, "comment": {"comments": [{"self": "https://issues.apache.org/jira/rest/api/2/issue/13629211/comment/18020924", "id": "18020924", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org", "name": "stevel@apache.org", "key": "stevel@apache.org", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"}, "displayName": "Steve Loughran", "active": true, "timeZone": "Europe/London"}, "body": "Trying to list local root  \r\n\r\nIf there are dependencies needed in the HADOOP-19696 let's make sure they get into common/lib, but this registration process mustn't fail this way, so let's just have a fs.gs.impl declararation in core-default.xml\r\n\r\n{code}\r\n bin/hadoop fs -ls file:///\r\n2025-09-17 15:03:47,688 [main] WARN  fs.FileSystem (FileSystem.java:loadFileSystems(3539)) - Cannot load filesystem\r\njava.util.ServiceConfigurationError: org.apache.hadoop.fs.FileSystem: org.apache.hadoop.fs.gs.GoogleHadoopFileSystem Unable to get public no-arg constructor\r\n        at java.base/java.util.ServiceLoader.fail(ServiceLoader.java:586)\r\n        at java.base/java.util.ServiceLoader.getConstructor(ServiceLoader.java:679)\r\n        at java.base/java.util.ServiceLoader$LazyClassPathLookupIterator.hasNextService(ServiceLoader.java:1240)\r\n        at java.base/java.util.ServiceLoader$LazyClassPathLookupIterator.hasNext(ServiceLoader.java:1273)\r\n        at java.base/java.util.ServiceLoader$2.hasNext(ServiceLoader.java:1309)\r\n        at java.base/java.util.ServiceLoader$3.hasNext(ServiceLoader.java:1393)\r\n        at org.apache.hadoop.fs.FileSystem.loadFileSystems(FileSystem.java:3522)\r\n        at org.apache.hadoop.fs.FileSystem.getFileSystemClass(FileSystem.java:3562)\r\n        at org.apache.hadoop.fs.FileSystem.createFileSystem(FileSystem.java:3612)\r\n        at org.apache.hadoop.fs.FileSystem$Cache.getInternal(FileSystem.java:3716)\r\n        at org.apache.hadoop.fs.FileSystem$Cache.get(FileSystem.java:3667)\r\n        at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:557)\r\n        at org.apache.hadoop.fs.Path.getFileSystem(Path.java:373)\r\n        at org.apache.hadoop.fs.shell.PathData.expandAsGlob(PathData.java:347)\r\n        at org.apache.hadoop.fs.shell.Command.expandArgument(Command.java:265)\r\n        at org.apache.hadoop.fs.shell.Command.expandArguments(Command.java:248)\r\n        at org.apache.hadoop.fs.shell.FsCommand.processRawArguments(FsCommand.java:105)\r\n        at org.apache.hadoop.fs.shell.Command.run(Command.java:192)\r\n        at org.apache.hadoop.fs.FsShell.run(FsShell.java:327)\r\n        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:82)\r\n        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:97)\r\n        at org.apache.hadoop.fs.FsShell.main(FsShell.java:390)\r\nCaused by: java.lang.NoClassDefFoundError: com/google/auth/Credentials\r\n        at java.base/java.lang.Class.getDeclaredConstructors0(Native Method)\r\n        at java.base/java.lang.Class.privateGetDeclaredConstructors(Class.java:3373)\r\n        at java.base/java.lang.Class.getConstructor0(Class.java:3578)\r\n        at java.base/java.lang.Class.getConstructor(Class.java:2271)\r\n        at java.base/java.util.ServiceLoader$1.run(ServiceLoader.java:666)\r\n        at java.base/java.util.ServiceLoader$1.run(ServiceLoader.java:663)\r\n        at java.base/java.security.AccessController.doPrivileged(AccessController.java:569)\r\n        at java.base/java.util.ServiceLoader.getConstructor(ServiceLoader.java:674)\r\n        ... 20 more\r\nCaused by: java.lang.ClassNotFoundException: com.google.auth.Credentials\r\n        at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)\r\n        at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)\r\n        at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:525)\r\n        ... 28 more\r\nFound 20 items\r\n----------   1 root admin          0 2025-08-16 19:44 file:///.file\r\n...\r\n{code}\r\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org", "name": "stevel@apache.org", "key": "stevel@apache.org", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"}, "displayName": "Steve Loughran", "active": true, "timeZone": "Europe/London"}, "created": "2025-09-17T14:06:18.904+0000", "updated": "2025-09-17T14:06:18.904+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13629211/comment/18028260", "id": "18028260", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=cnauroth", "name": "cnauroth", "key": "cnauroth", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"}, "displayName": "Chris Nauroth", "active": true, "timeZone": "America/Los_Angeles"}, "body": "Hi [~stevel@apache.org]. Not fully caught up on this one, but there is a {{fs.gs.impl}} entry in core-default.xml now. Was that all we needed?\r\n\r\nhttps://github.com/apache/hadoop/blob/trunk/hadoop-common-project/hadoop-common/src/main/resources/core-default.xml#L4508", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=cnauroth", "name": "cnauroth", "key": "cnauroth", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=cnauroth&avatarId=11432", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=cnauroth&avatarId=11432", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=cnauroth&avatarId=11432", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=cnauroth&avatarId=11432"}, "displayName": "Chris Nauroth", "active": true, "timeZone": "America/Los_Angeles"}, "created": "2025-10-08T04:44:25.761+0000", "updated": "2025-10-08T04:44:25.761+0000"}], "maxResults": 2, "total": 2, "startAt": 0}, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/1", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/blocker.svg", "name": "Blocker", "id": "1"}, "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/1", "description": "The issue is open and ready for the assignee to start work on it.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png", "name": "Open", "id": "1", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2", "id": 2, "key": "new", "colorName": "blue-gray", "name": "To Do"}}}}