{"expand": "renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations", "id": "13628941", "self": "https://issues.apache.org/jira/rest/api/2/issue/13628941", "key": "KAFKA-19716", "fields": {"summary": "OOM when loading large uncompacted __consumer_offsets partitions with transactional workload", "description": "When loading a large poorly compacted __consumer_offsets partition with a transactional workload (alternating transaction offset commits and commit markers), we create and discard lots of TimelineHashMaps. These accumulate in the SnapshotRegistry's rollback mechanism. Overall, memory usage is linear in the size of the partition.\r\n\r\nWe can commit the snapshot every N offsets in {{{}CoordinatorLoaderImpl{}}}, to allow the memory to be reclaimed.", "reporter": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=squah-confluent", "name": "squah-confluent", "key": "JIRAUSER304653", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Sean Quah", "active": true, "timeZone": "Europe/London"}, "comment": {"comments": [{"self": "https://issues.apache.org/jira/rest/api/2/issue/13628941/comment/18022434", "id": "18022434", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=dajac", "name": "dajac", "key": "dajac", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "David Jacot", "active": true, "timeZone": "Europe/Zurich"}, "body": "Fix for 4.0.x and 4.1.x is tracked by https://issues.apache.org/jira/browse/KAFKA-19732.", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=dajac", "name": "dajac", "key": "dajac", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "David Jacot", "active": true, "timeZone": "Europe/Zurich"}, "created": "2025-09-24T13:56:36.252+0000", "updated": "2025-09-24T13:56:36.252+0000"}], "maxResults": 1, "total": 1, "startAt": 0}, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/4", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg", "name": "Minor", "id": "4"}, "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}