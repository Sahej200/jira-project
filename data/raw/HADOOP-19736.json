{"expand": "renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations", "id": "13632383", "self": "https://issues.apache.org/jira/rest/api/2/issue/13632383", "key": "HADOOP-19736", "fields": {"summary": "ABFS: Support for new auth type: User-bound SAS", "description": "Adding support for new authentication type: user bound SAS", "reporter": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=manika137", "name": "manika137", "key": "JIRAUSER306912", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Manika Joshi", "active": true, "timeZone": "Etc/UTC"}, "comment": {"comments": [{"self": "https://issues.apache.org/jira/rest/api/2/issue/13632383/comment/18032721", "id": "18032721", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "manika137 opened a new pull request, #8051:\nURL: https://github.com/apache/hadoop/pull/8051\n\n   ### Description of PR\r\n   Adding support for new authentication type: user bound SAS\r\n   \r\n   ### How was this patch tested?\r\n   Test suite will be run for the patch\r\n   \r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-24T09:44:17.799+0000", "updated": "2025-10-24T09:44:17.799+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13632383/comment/18032747", "id": "18032747", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #8051:\nURL: https://github.com/apache/hadoop/pull/8051#issuecomment-3442714485\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |  20m 52s |  |  Docker mode activated.  |\r\n   |||| _ Prechecks _ |\r\n   | +1 :green_heart: |  dupname  |   0m  0s |  |  No case conflicting files found.  |\r\n   | +0 :ok: |  codespell  |   0m  0s |  |  codespell was not available.  |\r\n   | +0 :ok: |  detsecrets  |   0m  0s |  |  detect-secrets was not available.  |\r\n   | +0 :ok: |  markdownlint  |   0m  0s |  |  markdownlint was not available.  |\r\n   | +1 :green_heart: |  @author  |   0m  0s |  |  The patch does not contain any @author tags.  |\r\n   | +1 :green_heart: |  test4tests  |   0m  0s |  |  The patch appears to include 5 new or modified test files.  |\r\n   |||| _ trunk Compile Tests _ |\r\n   | +1 :green_heart: |  mvninstall  |  34m 38s |  |  trunk passed  |\r\n   | +1 :green_heart: |  compile  |   0m 44s |  |  trunk passed with JDK Ubuntu-21.0.7+6-Ubuntu-0ubuntu120.04  |\r\n   | +1 :green_heart: |  compile  |   0m 45s |  |  trunk passed with JDK Ubuntu-17.0.15+6-Ubuntu-0ubuntu120.04  |\r\n   | +1 :green_heart: |  checkstyle  |   0m 34s |  |  trunk passed  |\r\n   | +1 :green_heart: |  mvnsite  |   0m 50s |  |  trunk passed  |\r\n   | +1 :green_heart: |  javadoc  |   0m 45s |  |  trunk passed with JDK Ubuntu-21.0.7+6-Ubuntu-0ubuntu120.04  |\r\n   | +1 :green_heart: |  javadoc  |   0m 37s |  |  trunk passed with JDK Ubuntu-17.0.15+6-Ubuntu-0ubuntu120.04  |\r\n   | -1 :x: |  spotbugs  |   1m 23s | [/branch-spotbugs-hadoop-tools_hadoop-azure-warnings.html](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/1/artifact/out/branch-spotbugs-hadoop-tools_hadoop-azure-warnings.html) |  hadoop-tools/hadoop-azure in trunk has 178 extant spotbugs warnings.  |\r\n   | +1 :green_heart: |  shadedclient  |  26m 16s |  |  branch has no errors when building and testing our client artifacts.  |\r\n   |||| _ Patch Compile Tests _ |\r\n   | -1 :x: |  mvninstall  |   0m 34s | [/patch-mvninstall-hadoop-tools_hadoop-azure.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/1/artifact/out/patch-mvninstall-hadoop-tools_hadoop-azure.txt) |  hadoop-azure in the patch failed.  |\r\n   | -1 :x: |  compile  |   0m 35s | [/patch-compile-hadoop-tools_hadoop-azure-jdkUbuntu-21.0.7+6-Ubuntu-0ubuntu120.04.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/1/artifact/out/patch-compile-hadoop-tools_hadoop-azure-jdkUbuntu-21.0.7+6-Ubuntu-0ubuntu120.04.txt) |  hadoop-azure in the patch failed with JDK Ubuntu-21.0.7+6-Ubuntu-0ubuntu120.04.  |\r\n   | -1 :x: |  javac  |   0m 35s | [/patch-compile-hadoop-tools_hadoop-azure-jdkUbuntu-21.0.7+6-Ubuntu-0ubuntu120.04.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/1/artifact/out/patch-compile-hadoop-tools_hadoop-azure-jdkUbuntu-21.0.7+6-Ubuntu-0ubuntu120.04.txt) |  hadoop-azure in the patch failed with JDK Ubuntu-21.0.7+6-Ubuntu-0ubuntu120.04.  |\r\n   | -1 :x: |  compile  |   0m 35s | [/patch-compile-hadoop-tools_hadoop-azure-jdkUbuntu-17.0.15+6-Ubuntu-0ubuntu120.04.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/1/artifact/out/patch-compile-hadoop-tools_hadoop-azure-jdkUbuntu-17.0.15+6-Ubuntu-0ubuntu120.04.txt) |  hadoop-azure in the patch failed with JDK Ubuntu-17.0.15+6-Ubuntu-0ubuntu120.04.  |\r\n   | -1 :x: |  javac  |   0m 35s | [/patch-compile-hadoop-tools_hadoop-azure-jdkUbuntu-17.0.15+6-Ubuntu-0ubuntu120.04.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/1/artifact/out/patch-compile-hadoop-tools_hadoop-azure-jdkUbuntu-17.0.15+6-Ubuntu-0ubuntu120.04.txt) |  hadoop-azure in the patch failed with JDK Ubuntu-17.0.15+6-Ubuntu-0ubuntu120.04.  |\r\n   | -1 :x: |  blanks  |   0m  0s | [/blanks-eol.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/1/artifact/out/blanks-eol.txt) |  The patch has 3 line(s) that end in blanks. Use git apply --whitespace=fix <<patch_file>>. Refer https://git-scm.com/docs/git-apply  |\r\n   | -0 :warning: |  checkstyle  |   0m 22s | [/results-checkstyle-hadoop-tools_hadoop-azure.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/1/artifact/out/results-checkstyle-hadoop-tools_hadoop-azure.txt) |  hadoop-tools/hadoop-azure: The patch generated 36 new + 4 unchanged - 0 fixed = 40 total (was 4)  |\r\n   | -1 :x: |  mvnsite  |   0m 37s | [/patch-mvnsite-hadoop-tools_hadoop-azure.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/1/artifact/out/patch-mvnsite-hadoop-tools_hadoop-azure.txt) |  hadoop-azure in the patch failed.  |\r\n   | -1 :x: |  javadoc  |   0m 32s | [/results-javadoc-javadoc-hadoop-tools_hadoop-azure-jdkUbuntu-21.0.7+6-Ubuntu-0ubuntu120.04.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/1/artifact/out/results-javadoc-javadoc-hadoop-tools_hadoop-azure-jdkUbuntu-21.0.7+6-Ubuntu-0ubuntu120.04.txt) |  hadoop-tools_hadoop-azure-jdkUbuntu-21.0.7+6-Ubuntu-0ubuntu120.04 with JDK Ubuntu-21.0.7+6-Ubuntu-0ubuntu120.04 generated 2 new + 1472 unchanged - 0 fixed = 1474 total (was 1472)  |\r\n   | -1 :x: |  javadoc  |   0m 30s | [/results-javadoc-javadoc-hadoop-tools_hadoop-azure-jdkUbuntu-17.0.15+6-Ubuntu-0ubuntu120.04.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/1/artifact/out/results-javadoc-javadoc-hadoop-tools_hadoop-azure-jdkUbuntu-17.0.15+6-Ubuntu-0ubuntu120.04.txt) |  hadoop-tools_hadoop-azure-jdkUbuntu-17.0.15+6-Ubuntu-0ubuntu120.04 with JDK Ubuntu-17.0.15+6-Ubuntu-0ubuntu120.04 generated 2 new + 1413 unchanged - 0 fixed = 1415 total (was 1413)  |\r\n   | -1 :x: |  spotbugs  |   0m 34s | [/patch-spotbugs-hadoop-tools_hadoop-azure.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/1/artifact/out/patch-spotbugs-hadoop-tools_hadoop-azure.txt) |  hadoop-azure in the patch failed.  |\r\n   | +1 :green_heart: |  shadedclient  |  29m  4s |  |  patch has no errors when building and testing our client artifacts.  |\r\n   |||| _ Other Tests _ |\r\n   | -1 :x: |  unit  |   0m 41s | [/patch-unit-hadoop-tools_hadoop-azure.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/1/artifact/out/patch-unit-hadoop-tools_hadoop-azure.txt) |  hadoop-azure in the patch failed.  |\r\n   | +1 :green_heart: |  asflicense  |   0m 34s |  |  The patch does not generate ASF License warnings.  |\r\n   |  |   | 119m 57s |  |  |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | Docker | ClientAPI=1.51 ServerAPI=1.51 base: https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/1/artifact/out/Dockerfile |\r\n   | GITHUB PR | https://github.com/apache/hadoop/pull/8051 |\r\n   | JIRA Issue | HADOOP-19736 |\r\n   | Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient spotbugs checkstyle codespell detsecrets markdownlint |\r\n   | uname | Linux 88abe69cd96c 5.15.0-156-generic #166-Ubuntu SMP Sat Aug 9 00:02:46 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux |\r\n   | Build tool | maven |\r\n   | Personality | dev-support/bin/hadoop.sh |\r\n   | git revision | trunk / 05b52e40f1bc99edc039fc0d2ab5f83d1ceb0da9 |\r\n   | Default Java | Ubuntu-17.0.15+6-Ubuntu-0ubuntu120.04 |\r\n   | Multi-JDK versions | /usr/lib/jvm/java-21-openjdk-amd64:Ubuntu-21.0.7+6-Ubuntu-0ubuntu120.04 /usr/lib/jvm/java-17-openjdk-amd64:Ubuntu-17.0.15+6-Ubuntu-0ubuntu120.04 |\r\n   |  Test Results | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/1/testReport/ |\r\n   | Max. process+thread count | 779 (vs. ulimit of 5500) |\r\n   | modules | C: hadoop-tools/hadoop-azure U: hadoop-tools/hadoop-azure |\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/1/console |\r\n   | versions | git=2.25.1 maven=3.9.11 spotbugs=4.9.7 |\r\n   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-24T11:45:38.208+0000", "updated": "2025-10-24T11:45:38.208+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13632383/comment/18033415", "id": "18033415", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #8051:\nURL: https://github.com/apache/hadoop/pull/8051#issuecomment-3454395745\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |   0m  0s |  |  Docker mode activated.  |\r\n   | -1 :x: |  docker  |   4m 52s |  |  Docker failed to build run-specific yetus/hadoop:tp-4947}.  |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | GITHUB PR | https://github.com/apache/hadoop/pull/8051 |\r\n   | JIRA Issue | HADOOP-19736 |\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/2/console |\r\n   | versions | git=2.34.1 |\r\n   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-28T03:40:16.476+0000", "updated": "2025-10-28T03:40:16.476+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13632383/comment/18033416", "id": "18033416", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #8051:\nURL: https://github.com/apache/hadoop/pull/8051#issuecomment-3454455082\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |   0m  0s |  |  Docker mode activated.  |\r\n   | -1 :x: |  docker  |   6m 57s |  |  Docker failed to build run-specific yetus/hadoop:tp-29291}.  |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | GITHUB PR | https://github.com/apache/hadoop/pull/8051 |\r\n   | JIRA Issue | HADOOP-19736 |\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/3/console |\r\n   | versions | git=2.34.1 |\r\n   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-28T04:12:50.949+0000", "updated": "2025-10-28T04:12:50.949+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13632383/comment/18033442", "id": "18033442", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #8051:\nURL: https://github.com/apache/hadoop/pull/8051#issuecomment-3454654532\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |   0m  0s |  |  Docker mode activated.  |\r\n   | -1 :x: |  docker  |   6m  5s |  |  Docker failed to build run-specific yetus/hadoop:tp-27223}.  |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | GITHUB PR | https://github.com/apache/hadoop/pull/8051 |\r\n   | JIRA Issue | HADOOP-19736 |\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-8051/4/console |\r\n   | versions | git=2.34.1 |\r\n   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-28T05:32:29.452+0000", "updated": "2025-10-28T05:32:29.452+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13632383/comment/18033802", "id": "18033802", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "bhattmanish98 commented on code in PR #8051:\nURL: https://github.com/apache/hadoop/pull/8051#discussion_r2472593921\n\n\n##########\nhadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azurebfs/services/AbfsClientHandler.java:\n##########\n@@ -80,6 +80,25 @@ public AbfsClientHandler(final URL baseUrl,\n         abfsClientContext);\n   }\n \n+  public AbfsClientHandler(final URL baseUrl,\n\nReview Comment:\n   Java doc missing for the constructor\n\n\n\n##########\nhadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azurebfs/constants/AbfsHttpConstants.java:\n##########\n@@ -187,7 +187,8 @@ public enum ApiVersion {\n     DEC_12_2019(\"2019-12-12\"),\n     APR_10_2021(\"2021-04-10\"),\n     AUG_03_2023(\"2023-08-03\"),\n-    NOV_04_2024(\"2024-11-04\");\n+    NOV_04_2024(\"2024-11-04\"),\n+    JULY_05_2025(\"2025-07-05\");\n\nReview Comment:\n   We should follow the same format: JUL_05_2025, what do you think?\n\n\n\n##########\nhadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azurebfs/services/AbfsDfsClient.java:\n##########\n@@ -174,6 +174,17 @@ public AbfsDfsClient(final URL baseUrl,\n         encryptionContextProvider, abfsClientContext, AbfsServiceType.DFS);\n   }\n \n+  public AbfsDfsClient(final URL baseUrl,\n\nReview Comment:\n   Java doc missing\n\n\n\n##########\nhadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azurebfs/services/AbfsRestOperation.java:\n##########\n@@ -570,6 +570,11 @@ public void signRequest(final AbfsHttpOperation httpOperation, int bytesToSign)\n         // do nothing; the SAS token should already be appended to the query string\n         httpOperation.setMaskForSAS(); //mask sig/oid from url for logs\n         break;\n+      case UserboundSASWithOAuth:\n+        httpOperation.setRequestProperty(HttpHeaderConfigurations.AUTHORIZATION,\n+            client.getAccessToken());\n+        httpOperation.setMaskForSAS(); //mask sig/oid from url for logs\n\nReview Comment:\n   Typo: *sign\n\n\n\n##########\nhadoop-tools/hadoop-azure/src/test/java/org/apache/hadoop/fs/azurebfs/constants/TestConfigurationKeys.java:\n##########\n@@ -55,6 +55,9 @@ public final class TestConfigurationKeys {\n \n   public static final String FS_AZURE_TEST_APP_SERVICE_PRINCIPAL_OBJECT_ID = \"fs.azure.test.app.service.principal.object.id\";\n \n+  public static final String FS_AZURE_END_USER_TENANT_ID = \"fs.azure.test.end.user.tenant.id\";\n\nReview Comment:\n   Rename the variable to FS_AZURE_TEST_END_USER_TENANT_ID \n\n\n\n##########\nhadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azurebfs/AzureBlobFileSystemStore.java:\n##########\n@@ -1741,7 +1741,15 @@ private void initializeClient(URI uri, String fileSystemName,\n     } else if (authType == AuthType.SAS) {\n       LOG.trace(\"Fetching SAS Token Provider\");\n       sasTokenProvider = abfsConfiguration.getSASTokenProvider();\n-    } else {\n+    } else if(authType == AuthType.UserboundSASWithOAuth){\n+      LOG.trace(\"Fetching SAS and OAuth Token Provider for user bound SAS\");\n+      AzureADAuthenticator.init(abfsConfiguration);\n+      tokenProvider = abfsConfiguration.getTokenProvider();\n+      ExtensionHelper.bind(tokenProvider, uri,\n+          abfsConfiguration.getRawConfiguration());\n+      sasTokenProvider = abfsConfiguration.getSASTokenProviderForUserBoundSAS();\n+    }\n\nReview Comment:\n   else can be started in the same line after }, same format we are using at other places as well.\n\n\n\n##########\nhadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azurebfs/services/AbfsClient.java:\n##########\n@@ -363,6 +363,21 @@ public AbfsClient(final URL baseUrl,\n     this.sasTokenProvider = sasTokenProvider;\n   }\n \n+  public AbfsClient(final URL baseUrl,\n\nReview Comment:\n   Java doc missing\n\n\n\n##########\nhadoop-tools/hadoop-azure/src/test/java/org/apache/hadoop/fs/azurebfs/constants/TestConfigurationKeys.java:\n##########\n@@ -55,6 +55,9 @@ public final class TestConfigurationKeys {\n \n   public static final String FS_AZURE_TEST_APP_SERVICE_PRINCIPAL_OBJECT_ID = \"fs.azure.test.app.service.principal.object.id\";\n \n+  public static final String FS_AZURE_END_USER_TENANT_ID = \"fs.azure.test.end.user.tenant.id\";\n+  public static final String FS_AZURE_END_USER_OBJECT_ID = \"fs.azure.test.end.user.object.id\";\n\nReview Comment:\n   same as above\n\n\n\n##########\nhadoop-tools/hadoop-azure/src/site/markdown/index.md:\n##########\n@@ -303,6 +303,7 @@ driven by them.\n 3. Deployed in-Azure with the Azure VMs providing OAuth 2.0 tokens to the application, \"Managed Instance\".\n 4. Using Shared Access Signature (SAS) tokens provided by a custom implementation of the SASTokenProvider interface.\n 5. By directly configuring a fixed Shared Access Signature (SAS) token in the account configuration settings files.\n+6. Using user-bound SAS auth type, which is requires OAuth 2.0 setup (point 2 above) and SAS setup (point 4 above)\n\nReview Comment:\n   Grammatical mistake: which requires or which is required?\n\n\n\n##########\nhadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azurebfs/services/AuthType.java:\n##########\n@@ -24,5 +24,6 @@ public enum AuthType {\n     SharedKey,\n     OAuth,\n     Custom,\n-    SAS\n+    SAS,\n+     UserboundSASWithOAuth\n\nReview Comment:\n   Format issue: There is an extra space before UserboundSASWithOAuth\n\n\n\n##########\nhadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azurebfs/AzureBlobFileSystemStore.java:\n##########\n@@ -1741,7 +1741,15 @@ private void initializeClient(URI uri, String fileSystemName,\n     } else if (authType == AuthType.SAS) {\n       LOG.trace(\"Fetching SAS Token Provider\");\n       sasTokenProvider = abfsConfiguration.getSASTokenProvider();\n-    } else {\n+    } else if(authType == AuthType.UserboundSASWithOAuth){\n\nReview Comment:\n   Missing space between if and (\n\n\n\n##########\nhadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azurebfs/AzureBlobFileSystemStore.java:\n##########\n@@ -1770,7 +1778,12 @@ private void initializeClient(URI uri, String fileSystemName,\n     }\n \n     LOG.trace(\"Initializing AbfsClient for {}\", baseUrl);\n-    if (tokenProvider != null) {\n+    if(tokenProvider != null && sasTokenProvider != null){\n\nReview Comment:\n   Space between if and (\n\n\n\n##########\nhadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azurebfs/AzureBlobFileSystemStore.java:\n##########\n@@ -1770,7 +1778,12 @@ private void initializeClient(URI uri, String fileSystemName,\n     }\n \n     LOG.trace(\"Initializing AbfsClient for {}\", baseUrl);\n-    if (tokenProvider != null) {\n+    if(tokenProvider != null && sasTokenProvider != null){\n+      this.clientHandler = new AbfsClientHandler(baseUrl, creds, abfsConfiguration,\n+          tokenProvider, sasTokenProvider, encryptionContextProvider,\n+          populateAbfsClientContext());\n+    }\n+    else if (tokenProvider != null) {\n\nReview Comment:\n   same as above\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-29T11:36:52.517+0000", "updated": "2025-10-29T11:36:52.517+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13632383/comment/18034389", "id": "18034389", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "anmolanmol1234 commented on code in PR #8051:\nURL: https://github.com/apache/hadoop/pull/8051#discussion_r2481295321\n\n\n##########\nhadoop-tools/hadoop-azure/src/test/java/org/apache/hadoop/fs/azurebfs/utils/SASGenerator.java:\n##########\n@@ -41,7 +41,8 @@ public abstract class SASGenerator {\n   public enum AuthenticationVersion {\n     Nov18(\"2018-11-09\"),\n     Dec19(\"2019-12-12\"),\n-    Feb20(\"2020-02-10\");\n+    Feb20(\"2020-02-10\"),\n+    July5(\"2025-07-05\");\n\nReview Comment:\n   Same here should be JUL\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-31T12:43:06.479+0000", "updated": "2025-10-31T12:43:06.479+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13632383/comment/18034391", "id": "18034391", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "anmolanmol1234 commented on code in PR #8051:\nURL: https://github.com/apache/hadoop/pull/8051#discussion_r2481303390\n\n\n##########\nhadoop-tools/hadoop-azure/src/test/java/org/apache/hadoop/fs/azurebfs/utils/DelegationSASGenerator.java:\n##########\n@@ -36,20 +38,26 @@ public class DelegationSASGenerator extends SASGenerator {\n   private final String ske;\n   private final String sks = \"b\";\n   private final String skv;\n+  private final String skdutid;\n+  private final String sduoid;\n \n-  public DelegationSASGenerator(byte[] userDelegationKey, String skoid, String sktid, String skt, String ske, String skv) {\n+  public DelegationSASGenerator(byte[] userDelegationKey, String skoid, String sktid, String skt, String ske, String skv, String skdutid, String sduoid) {\n\nReview Comment:\n   add javadoc for what do all these params signify\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-31T12:45:50.560+0000", "updated": "2025-10-31T12:45:50.560+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13632383/comment/18034392", "id": "18034392", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "anmolanmol1234 commented on code in PR #8051:\nURL: https://github.com/apache/hadoop/pull/8051#discussion_r2481307275\n\n\n##########\nhadoop-tools/hadoop-azure/src/test/java/org/apache/hadoop/fs/azurebfs/utils/DelegationSASGenerator.java:\n##########\n@@ -117,6 +125,15 @@ public String getDelegationSAS(String accountName, String containerName, String\n     qb.addQuery(\"ske\", ske);\n     qb.addQuery(\"sks\", sks);\n     qb.addQuery(\"skv\", skv);\n+\n+    //skdutid and sduoid are required for user bound SAS only\n+    if(!Objects.equals(skdutid, EMPTY_STRING)){\n\nReview Comment:\n   spaces after if\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-31T12:47:31.632+0000", "updated": "2025-10-31T12:47:31.632+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13632383/comment/18034393", "id": "18034393", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "anmolanmol1234 commented on code in PR #8051:\nURL: https://github.com/apache/hadoop/pull/8051#discussion_r2481327412\n\n\n##########\nhadoop-tools/hadoop-azure/src/test/java/org/apache/hadoop/fs/azurebfs/utils/DelegationSASGenerator.java:\n##########\n@@ -197,6 +228,7 @@ private String computeSignatureForSAS(String sp, String st, String se, String sv\n \n     String stringToSign = sb.toString();\n     LOG.debug(\"Delegation SAS stringToSign: \" + stringToSign.replace(\"\\n\", \".\"));\n+    System.out.println(\"Delegation SAS stringToSign: \" + stringToSign.replace(\"\\n\", \".\"));\n\nReview Comment:\n   Remove this\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-31T12:55:56.570+0000", "updated": "2025-10-31T12:55:56.570+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13632383/comment/18034396", "id": "18034396", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "anmolanmol1234 commented on code in PR #8051:\nURL: https://github.com/apache/hadoop/pull/8051#discussion_r2481341233\n\n\n##########\nhadoop-tools/hadoop-azure/src/test/java/org/apache/hadoop/fs/azurebfs/extensions/MockUserBoundSASTokenProvider.java:\n##########\n@@ -0,0 +1,166 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.fs.azurebfs.extensions;\n+\n+import java.io.IOException;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.nio.charset.StandardCharsets;\n+import java.time.Duration;\n+import java.time.Instant;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants;\n+import org.apache.hadoop.fs.azurebfs.constants.TestConfigurationKeys;\n+import org.apache.hadoop.fs.azurebfs.constants.HttpHeaderConfigurations;\n+import org.apache.hadoop.fs.azurebfs.contracts.exceptions.InvalidUriException;\n+import org.apache.hadoop.fs.azurebfs.oauth2.ClientCredsTokenProvider;\n+import org.apache.hadoop.fs.azurebfs.services.AbfsHttpHeader;\n+import org.apache.hadoop.fs.azurebfs.services.AbfsJdkHttpOperation;\n+import org.apache.hadoop.fs.azurebfs.utils.Base64;\n+import org.apache.hadoop.fs.azurebfs.utils.DelegationSASGenerator;\n+import org.apache.hadoop.fs.azurebfs.utils.SASGenerator;\n+import org.apache.hadoop.security.AccessControlException;\n+\n+import static org.apache.hadoop.fs.azurebfs.constants.FileSystemConfigurations.DEFAULT_HTTP_CONNECTION_TIMEOUT;\n+import static org.apache.hadoop.fs.azurebfs.constants.FileSystemConfigurations.DEFAULT_HTTP_READ_TIMEOUT;\n+\n+/**\n+ * A mock user-bound SAS token provider implementation.\n+ */\n+\n+public class MockUserBoundSASTokenProvider implements SASTokenProvider {\n+\n+  private DelegationSASGenerator generator;\n+\n+  public static final String TEST_OWNER = \"325f1619-4205-432f-9fce-3fd594325ce5\";\n+  public static final String CORRELATION_ID = \"66ff4ffc-ff17-417e-a2a9-45db8c5b0b5c\";\n+  public static final String NO_AGENT_PATH = \"NoAgentPath\";\n+\n+  @Override\n+  public void initialize(Configuration configuration, String accountName) throws IOException {\n+    String appID = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_ID);\n+    String appSecret = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SECRET);\n+    String sktid = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SERVICE_PRINCIPAL_TENANT_ID);\n+    String skoid = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SERVICE_PRINCIPAL_OBJECT_ID);\n+    String skt = SASGenerator.ISO_8601_FORMATTER.format(Instant.now().minus(SASGenerator.FIVE_MINUTES));\n+    String ske = SASGenerator.ISO_8601_FORMATTER.format(Instant.now().plus(SASGenerator.ONE_DAY));\n+    String skv = SASGenerator.AuthenticationVersion.July5.toString();\n+\n+    String skdutid = configuration.get(TestConfigurationKeys.FS_AZURE_END_USER_TENANT_ID);\n+    String sduoid = configuration.get(TestConfigurationKeys.FS_AZURE_END_USER_OBJECT_ID);\n+\n+    byte[] key = getUserDelegationKey(accountName, appID, appSecret, sktid, skt, ske, skv, skdutid);\n+\n+    generator = new DelegationSASGenerator(key, skoid, sktid, skt, ske, skv, skdutid, sduoid);\n+  }\n+\n+  // Invokes the AAD v2.0 authentication endpoint with a client credentials grant to get an\n+  // access token.  See https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow.\n+  private String getAuthorizationHeader(String accountName, String appID, String appSecret, String sktid) throws IOException {\n\nReview Comment:\n   include params in javadoc as well\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-31T13:01:32.292+0000", "updated": "2025-10-31T13:01:32.292+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13632383/comment/18034397", "id": "18034397", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "anmolanmol1234 commented on code in PR #8051:\nURL: https://github.com/apache/hadoop/pull/8051#discussion_r2481342577\n\n\n##########\nhadoop-tools/hadoop-azure/src/test/java/org/apache/hadoop/fs/azurebfs/extensions/MockUserBoundSASTokenProvider.java:\n##########\n@@ -0,0 +1,166 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.fs.azurebfs.extensions;\n+\n+import java.io.IOException;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.nio.charset.StandardCharsets;\n+import java.time.Duration;\n+import java.time.Instant;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants;\n+import org.apache.hadoop.fs.azurebfs.constants.TestConfigurationKeys;\n+import org.apache.hadoop.fs.azurebfs.constants.HttpHeaderConfigurations;\n+import org.apache.hadoop.fs.azurebfs.contracts.exceptions.InvalidUriException;\n+import org.apache.hadoop.fs.azurebfs.oauth2.ClientCredsTokenProvider;\n+import org.apache.hadoop.fs.azurebfs.services.AbfsHttpHeader;\n+import org.apache.hadoop.fs.azurebfs.services.AbfsJdkHttpOperation;\n+import org.apache.hadoop.fs.azurebfs.utils.Base64;\n+import org.apache.hadoop.fs.azurebfs.utils.DelegationSASGenerator;\n+import org.apache.hadoop.fs.azurebfs.utils.SASGenerator;\n+import org.apache.hadoop.security.AccessControlException;\n+\n+import static org.apache.hadoop.fs.azurebfs.constants.FileSystemConfigurations.DEFAULT_HTTP_CONNECTION_TIMEOUT;\n+import static org.apache.hadoop.fs.azurebfs.constants.FileSystemConfigurations.DEFAULT_HTTP_READ_TIMEOUT;\n+\n+/**\n+ * A mock user-bound SAS token provider implementation.\n+ */\n+\n+public class MockUserBoundSASTokenProvider implements SASTokenProvider {\n+\n+  private DelegationSASGenerator generator;\n+\n+  public static final String TEST_OWNER = \"325f1619-4205-432f-9fce-3fd594325ce5\";\n+  public static final String CORRELATION_ID = \"66ff4ffc-ff17-417e-a2a9-45db8c5b0b5c\";\n+  public static final String NO_AGENT_PATH = \"NoAgentPath\";\n+\n+  @Override\n+  public void initialize(Configuration configuration, String accountName) throws IOException {\n+    String appID = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_ID);\n+    String appSecret = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SECRET);\n+    String sktid = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SERVICE_PRINCIPAL_TENANT_ID);\n+    String skoid = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SERVICE_PRINCIPAL_OBJECT_ID);\n+    String skt = SASGenerator.ISO_8601_FORMATTER.format(Instant.now().minus(SASGenerator.FIVE_MINUTES));\n+    String ske = SASGenerator.ISO_8601_FORMATTER.format(Instant.now().plus(SASGenerator.ONE_DAY));\n+    String skv = SASGenerator.AuthenticationVersion.July5.toString();\n+\n+    String skdutid = configuration.get(TestConfigurationKeys.FS_AZURE_END_USER_TENANT_ID);\n+    String sduoid = configuration.get(TestConfigurationKeys.FS_AZURE_END_USER_OBJECT_ID);\n+\n+    byte[] key = getUserDelegationKey(accountName, appID, appSecret, sktid, skt, ske, skv, skdutid);\n+\n+    generator = new DelegationSASGenerator(key, skoid, sktid, skt, ske, skv, skdutid, sduoid);\n+  }\n+\n+  // Invokes the AAD v2.0 authentication endpoint with a client credentials grant to get an\n+  // access token.  See https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow.\n+  private String getAuthorizationHeader(String accountName, String appID, String appSecret, String sktid) throws IOException {\n+    String authEndPoint = String.format(\"https://login.microsoftonline.com/%s/oauth2/v2.0/token\", sktid);\n\nReview Comment:\n   Add a constant for the string\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-31T13:02:02.390+0000", "updated": "2025-10-31T13:02:02.390+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13632383/comment/18034398", "id": "18034398", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "anmolanmol1234 commented on code in PR #8051:\nURL: https://github.com/apache/hadoop/pull/8051#discussion_r2481343344\n\n\n##########\nhadoop-tools/hadoop-azure/src/test/java/org/apache/hadoop/fs/azurebfs/extensions/MockUserBoundSASTokenProvider.java:\n##########\n@@ -0,0 +1,166 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.fs.azurebfs.extensions;\n+\n+import java.io.IOException;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.nio.charset.StandardCharsets;\n+import java.time.Duration;\n+import java.time.Instant;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants;\n+import org.apache.hadoop.fs.azurebfs.constants.TestConfigurationKeys;\n+import org.apache.hadoop.fs.azurebfs.constants.HttpHeaderConfigurations;\n+import org.apache.hadoop.fs.azurebfs.contracts.exceptions.InvalidUriException;\n+import org.apache.hadoop.fs.azurebfs.oauth2.ClientCredsTokenProvider;\n+import org.apache.hadoop.fs.azurebfs.services.AbfsHttpHeader;\n+import org.apache.hadoop.fs.azurebfs.services.AbfsJdkHttpOperation;\n+import org.apache.hadoop.fs.azurebfs.utils.Base64;\n+import org.apache.hadoop.fs.azurebfs.utils.DelegationSASGenerator;\n+import org.apache.hadoop.fs.azurebfs.utils.SASGenerator;\n+import org.apache.hadoop.security.AccessControlException;\n+\n+import static org.apache.hadoop.fs.azurebfs.constants.FileSystemConfigurations.DEFAULT_HTTP_CONNECTION_TIMEOUT;\n+import static org.apache.hadoop.fs.azurebfs.constants.FileSystemConfigurations.DEFAULT_HTTP_READ_TIMEOUT;\n+\n+/**\n+ * A mock user-bound SAS token provider implementation.\n+ */\n+\n+public class MockUserBoundSASTokenProvider implements SASTokenProvider {\n+\n+  private DelegationSASGenerator generator;\n+\n+  public static final String TEST_OWNER = \"325f1619-4205-432f-9fce-3fd594325ce5\";\n+  public static final String CORRELATION_ID = \"66ff4ffc-ff17-417e-a2a9-45db8c5b0b5c\";\n+  public static final String NO_AGENT_PATH = \"NoAgentPath\";\n+\n+  @Override\n+  public void initialize(Configuration configuration, String accountName) throws IOException {\n+    String appID = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_ID);\n+    String appSecret = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SECRET);\n+    String sktid = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SERVICE_PRINCIPAL_TENANT_ID);\n+    String skoid = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SERVICE_PRINCIPAL_OBJECT_ID);\n+    String skt = SASGenerator.ISO_8601_FORMATTER.format(Instant.now().minus(SASGenerator.FIVE_MINUTES));\n+    String ske = SASGenerator.ISO_8601_FORMATTER.format(Instant.now().plus(SASGenerator.ONE_DAY));\n+    String skv = SASGenerator.AuthenticationVersion.July5.toString();\n+\n+    String skdutid = configuration.get(TestConfigurationKeys.FS_AZURE_END_USER_TENANT_ID);\n+    String sduoid = configuration.get(TestConfigurationKeys.FS_AZURE_END_USER_OBJECT_ID);\n+\n+    byte[] key = getUserDelegationKey(accountName, appID, appSecret, sktid, skt, ske, skv, skdutid);\n+\n+    generator = new DelegationSASGenerator(key, skoid, sktid, skt, ske, skv, skdutid, sduoid);\n+  }\n+\n+  // Invokes the AAD v2.0 authentication endpoint with a client credentials grant to get an\n+  // access token.  See https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow.\n+  private String getAuthorizationHeader(String accountName, String appID, String appSecret, String sktid) throws IOException {\n+    String authEndPoint = String.format(\"https://login.microsoftonline.com/%s/oauth2/v2.0/token\", sktid);\n+    ClientCredsTokenProvider provider = new ClientCredsTokenProvider(authEndPoint, appID, appSecret);\n+    return \"Bearer \" + provider.getToken().getAccessToken();\n+  }\n+\n+  private byte[] getUserDelegationKey(String accountName, String appID, String appSecret,\n\nReview Comment:\n   javadoc\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-31T13:02:27.168+0000", "updated": "2025-10-31T13:02:27.168+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13632383/comment/18034399", "id": "18034399", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "anmolanmol1234 commented on code in PR #8051:\nURL: https://github.com/apache/hadoop/pull/8051#discussion_r2481344728\n\n\n##########\nhadoop-tools/hadoop-azure/src/test/java/org/apache/hadoop/fs/azurebfs/extensions/MockUserBoundSASTokenProvider.java:\n##########\n@@ -0,0 +1,166 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.fs.azurebfs.extensions;\n+\n+import java.io.IOException;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.nio.charset.StandardCharsets;\n+import java.time.Duration;\n+import java.time.Instant;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants;\n+import org.apache.hadoop.fs.azurebfs.constants.TestConfigurationKeys;\n+import org.apache.hadoop.fs.azurebfs.constants.HttpHeaderConfigurations;\n+import org.apache.hadoop.fs.azurebfs.contracts.exceptions.InvalidUriException;\n+import org.apache.hadoop.fs.azurebfs.oauth2.ClientCredsTokenProvider;\n+import org.apache.hadoop.fs.azurebfs.services.AbfsHttpHeader;\n+import org.apache.hadoop.fs.azurebfs.services.AbfsJdkHttpOperation;\n+import org.apache.hadoop.fs.azurebfs.utils.Base64;\n+import org.apache.hadoop.fs.azurebfs.utils.DelegationSASGenerator;\n+import org.apache.hadoop.fs.azurebfs.utils.SASGenerator;\n+import org.apache.hadoop.security.AccessControlException;\n+\n+import static org.apache.hadoop.fs.azurebfs.constants.FileSystemConfigurations.DEFAULT_HTTP_CONNECTION_TIMEOUT;\n+import static org.apache.hadoop.fs.azurebfs.constants.FileSystemConfigurations.DEFAULT_HTTP_READ_TIMEOUT;\n+\n+/**\n+ * A mock user-bound SAS token provider implementation.\n+ */\n+\n+public class MockUserBoundSASTokenProvider implements SASTokenProvider {\n+\n+  private DelegationSASGenerator generator;\n+\n+  public static final String TEST_OWNER = \"325f1619-4205-432f-9fce-3fd594325ce5\";\n+  public static final String CORRELATION_ID = \"66ff4ffc-ff17-417e-a2a9-45db8c5b0b5c\";\n+  public static final String NO_AGENT_PATH = \"NoAgentPath\";\n+\n+  @Override\n+  public void initialize(Configuration configuration, String accountName) throws IOException {\n+    String appID = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_ID);\n+    String appSecret = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SECRET);\n+    String sktid = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SERVICE_PRINCIPAL_TENANT_ID);\n+    String skoid = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SERVICE_PRINCIPAL_OBJECT_ID);\n+    String skt = SASGenerator.ISO_8601_FORMATTER.format(Instant.now().minus(SASGenerator.FIVE_MINUTES));\n+    String ske = SASGenerator.ISO_8601_FORMATTER.format(Instant.now().plus(SASGenerator.ONE_DAY));\n+    String skv = SASGenerator.AuthenticationVersion.July5.toString();\n+\n+    String skdutid = configuration.get(TestConfigurationKeys.FS_AZURE_END_USER_TENANT_ID);\n+    String sduoid = configuration.get(TestConfigurationKeys.FS_AZURE_END_USER_OBJECT_ID);\n+\n+    byte[] key = getUserDelegationKey(accountName, appID, appSecret, sktid, skt, ske, skv, skdutid);\n+\n+    generator = new DelegationSASGenerator(key, skoid, sktid, skt, ske, skv, skdutid, sduoid);\n+  }\n+\n+  // Invokes the AAD v2.0 authentication endpoint with a client credentials grant to get an\n+  // access token.  See https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow.\n+  private String getAuthorizationHeader(String accountName, String appID, String appSecret, String sktid) throws IOException {\n+    String authEndPoint = String.format(\"https://login.microsoftonline.com/%s/oauth2/v2.0/token\", sktid);\n+    ClientCredsTokenProvider provider = new ClientCredsTokenProvider(authEndPoint, appID, appSecret);\n+    return \"Bearer \" + provider.getToken().getAccessToken();\n+  }\n+\n+  private byte[] getUserDelegationKey(String accountName, String appID, String appSecret,\n+      String sktid, String skt, String ske, String skv, String skdutid) throws IOException {\n+\n+    String method = \"POST\";\n\nReview Comment:\n   we have constants for HTTP methods, can be used here\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-31T13:03:02.216+0000", "updated": "2025-10-31T13:03:02.216+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13632383/comment/18034400", "id": "18034400", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "anmolanmol1234 commented on code in PR #8051:\nURL: https://github.com/apache/hadoop/pull/8051#discussion_r2481347800\n\n\n##########\nhadoop-tools/hadoop-azure/src/test/java/org/apache/hadoop/fs/azurebfs/extensions/MockUserBoundSASTokenProvider.java:\n##########\n@@ -0,0 +1,166 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.fs.azurebfs.extensions;\n+\n+import java.io.IOException;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.nio.charset.StandardCharsets;\n+import java.time.Duration;\n+import java.time.Instant;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants;\n+import org.apache.hadoop.fs.azurebfs.constants.TestConfigurationKeys;\n+import org.apache.hadoop.fs.azurebfs.constants.HttpHeaderConfigurations;\n+import org.apache.hadoop.fs.azurebfs.contracts.exceptions.InvalidUriException;\n+import org.apache.hadoop.fs.azurebfs.oauth2.ClientCredsTokenProvider;\n+import org.apache.hadoop.fs.azurebfs.services.AbfsHttpHeader;\n+import org.apache.hadoop.fs.azurebfs.services.AbfsJdkHttpOperation;\n+import org.apache.hadoop.fs.azurebfs.utils.Base64;\n+import org.apache.hadoop.fs.azurebfs.utils.DelegationSASGenerator;\n+import org.apache.hadoop.fs.azurebfs.utils.SASGenerator;\n+import org.apache.hadoop.security.AccessControlException;\n+\n+import static org.apache.hadoop.fs.azurebfs.constants.FileSystemConfigurations.DEFAULT_HTTP_CONNECTION_TIMEOUT;\n+import static org.apache.hadoop.fs.azurebfs.constants.FileSystemConfigurations.DEFAULT_HTTP_READ_TIMEOUT;\n+\n+/**\n+ * A mock user-bound SAS token provider implementation.\n+ */\n+\n+public class MockUserBoundSASTokenProvider implements SASTokenProvider {\n+\n+  private DelegationSASGenerator generator;\n+\n+  public static final String TEST_OWNER = \"325f1619-4205-432f-9fce-3fd594325ce5\";\n+  public static final String CORRELATION_ID = \"66ff4ffc-ff17-417e-a2a9-45db8c5b0b5c\";\n+  public static final String NO_AGENT_PATH = \"NoAgentPath\";\n+\n+  @Override\n+  public void initialize(Configuration configuration, String accountName) throws IOException {\n+    String appID = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_ID);\n+    String appSecret = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SECRET);\n+    String sktid = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SERVICE_PRINCIPAL_TENANT_ID);\n+    String skoid = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SERVICE_PRINCIPAL_OBJECT_ID);\n+    String skt = SASGenerator.ISO_8601_FORMATTER.format(Instant.now().minus(SASGenerator.FIVE_MINUTES));\n+    String ske = SASGenerator.ISO_8601_FORMATTER.format(Instant.now().plus(SASGenerator.ONE_DAY));\n+    String skv = SASGenerator.AuthenticationVersion.July5.toString();\n+\n+    String skdutid = configuration.get(TestConfigurationKeys.FS_AZURE_END_USER_TENANT_ID);\n+    String sduoid = configuration.get(TestConfigurationKeys.FS_AZURE_END_USER_OBJECT_ID);\n+\n+    byte[] key = getUserDelegationKey(accountName, appID, appSecret, sktid, skt, ske, skv, skdutid);\n+\n+    generator = new DelegationSASGenerator(key, skoid, sktid, skt, ske, skv, skdutid, sduoid);\n+  }\n+\n+  // Invokes the AAD v2.0 authentication endpoint with a client credentials grant to get an\n+  // access token.  See https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow.\n+  private String getAuthorizationHeader(String accountName, String appID, String appSecret, String sktid) throws IOException {\n+    String authEndPoint = String.format(\"https://login.microsoftonline.com/%s/oauth2/v2.0/token\", sktid);\n+    ClientCredsTokenProvider provider = new ClientCredsTokenProvider(authEndPoint, appID, appSecret);\n+    return \"Bearer \" + provider.getToken().getAccessToken();\n+  }\n+\n+  private byte[] getUserDelegationKey(String accountName, String appID, String appSecret,\n+      String sktid, String skt, String ske, String skv, String skdutid) throws IOException {\n+\n+    String method = \"POST\";\n+    String account = accountName.substring(0, accountName.indexOf(AbfsHttpConstants.DOT));\n+\n+    final StringBuilder sb = new StringBuilder(128);\n+    sb.append(\"https://\");\n+    sb.append(account);\n+    sb.append(\".blob.core.windows.net/?restype=service&comp=userdelegationkey\");\n\nReview Comment:\n   Try to use constants as much as possible\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-31T13:04:21.351+0000", "updated": "2025-10-31T13:04:21.351+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13632383/comment/18034401", "id": "18034401", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "anmolanmol1234 commented on code in PR #8051:\nURL: https://github.com/apache/hadoop/pull/8051#discussion_r2481350011\n\n\n##########\nhadoop-tools/hadoop-azure/src/test/java/org/apache/hadoop/fs/azurebfs/extensions/MockUserBoundSASTokenProvider.java:\n##########\n@@ -0,0 +1,166 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.fs.azurebfs.extensions;\n+\n+import java.io.IOException;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.nio.charset.StandardCharsets;\n+import java.time.Duration;\n+import java.time.Instant;\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.fs.azurebfs.constants.AbfsHttpConstants;\n+import org.apache.hadoop.fs.azurebfs.constants.TestConfigurationKeys;\n+import org.apache.hadoop.fs.azurebfs.constants.HttpHeaderConfigurations;\n+import org.apache.hadoop.fs.azurebfs.contracts.exceptions.InvalidUriException;\n+import org.apache.hadoop.fs.azurebfs.oauth2.ClientCredsTokenProvider;\n+import org.apache.hadoop.fs.azurebfs.services.AbfsHttpHeader;\n+import org.apache.hadoop.fs.azurebfs.services.AbfsJdkHttpOperation;\n+import org.apache.hadoop.fs.azurebfs.utils.Base64;\n+import org.apache.hadoop.fs.azurebfs.utils.DelegationSASGenerator;\n+import org.apache.hadoop.fs.azurebfs.utils.SASGenerator;\n+import org.apache.hadoop.security.AccessControlException;\n+\n+import static org.apache.hadoop.fs.azurebfs.constants.FileSystemConfigurations.DEFAULT_HTTP_CONNECTION_TIMEOUT;\n+import static org.apache.hadoop.fs.azurebfs.constants.FileSystemConfigurations.DEFAULT_HTTP_READ_TIMEOUT;\n+\n+/**\n+ * A mock user-bound SAS token provider implementation.\n+ */\n+\n+public class MockUserBoundSASTokenProvider implements SASTokenProvider {\n+\n+  private DelegationSASGenerator generator;\n+\n+  public static final String TEST_OWNER = \"325f1619-4205-432f-9fce-3fd594325ce5\";\n+  public static final String CORRELATION_ID = \"66ff4ffc-ff17-417e-a2a9-45db8c5b0b5c\";\n+  public static final String NO_AGENT_PATH = \"NoAgentPath\";\n+\n+  @Override\n+  public void initialize(Configuration configuration, String accountName) throws IOException {\n+    String appID = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_ID);\n+    String appSecret = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SECRET);\n+    String sktid = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SERVICE_PRINCIPAL_TENANT_ID);\n+    String skoid = configuration.get(TestConfigurationKeys.FS_AZURE_TEST_APP_SERVICE_PRINCIPAL_OBJECT_ID);\n+    String skt = SASGenerator.ISO_8601_FORMATTER.format(Instant.now().minus(SASGenerator.FIVE_MINUTES));\n+    String ske = SASGenerator.ISO_8601_FORMATTER.format(Instant.now().plus(SASGenerator.ONE_DAY));\n+    String skv = SASGenerator.AuthenticationVersion.July5.toString();\n+\n+    String skdutid = configuration.get(TestConfigurationKeys.FS_AZURE_END_USER_TENANT_ID);\n+    String sduoid = configuration.get(TestConfigurationKeys.FS_AZURE_END_USER_OBJECT_ID);\n+\n+    byte[] key = getUserDelegationKey(accountName, appID, appSecret, sktid, skt, ske, skv, skdutid);\n+\n+    generator = new DelegationSASGenerator(key, skoid, sktid, skt, ske, skv, skdutid, sduoid);\n+  }\n+\n+  // Invokes the AAD v2.0 authentication endpoint with a client credentials grant to get an\n+  // access token.  See https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow.\n+  private String getAuthorizationHeader(String accountName, String appID, String appSecret, String sktid) throws IOException {\n+    String authEndPoint = String.format(\"https://login.microsoftonline.com/%s/oauth2/v2.0/token\", sktid);\n+    ClientCredsTokenProvider provider = new ClientCredsTokenProvider(authEndPoint, appID, appSecret);\n+    return \"Bearer \" + provider.getToken().getAccessToken();\n+  }\n+\n+  private byte[] getUserDelegationKey(String accountName, String appID, String appSecret,\n+      String sktid, String skt, String ske, String skv, String skdutid) throws IOException {\n+\n+    String method = \"POST\";\n+    String account = accountName.substring(0, accountName.indexOf(AbfsHttpConstants.DOT));\n+\n+    final StringBuilder sb = new StringBuilder(128);\n+    sb.append(\"https://\");\n+    sb.append(account);\n+    sb.append(\".blob.core.windows.net/?restype=service&comp=userdelegationkey\");\n+\n+    URL url;\n+    try {\n+      url = new URL(sb.toString());\n+    } catch (MalformedURLException ex) {\n+      throw new InvalidUriException(sb.toString());\n+    }\n+\n+    List<AbfsHttpHeader> requestHeaders = new ArrayList<AbfsHttpHeader>();\n+    requestHeaders.add(new AbfsHttpHeader(HttpHeaderConfigurations.X_MS_VERSION, skv));\n+    requestHeaders.add(new AbfsHttpHeader(HttpHeaderConfigurations.CONTENT_TYPE, \"application/x-www-form-urlencoded\"));\n+    requestHeaders.add(new AbfsHttpHeader(HttpHeaderConfigurations.AUTHORIZATION, getAuthorizationHeader(account, appID, appSecret, sktid)));\n+\n+    final StringBuilder requestBody = new StringBuilder(512);\n+    requestBody.append(\"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?><KeyInfo><Start>\");\n+    requestBody.append(skt);\n+    requestBody.append(\"</Start><Expiry>\");\n+    requestBody.append(ske);\n+    requestBody.append(\"</Expiry><DelegatedUserTid>\");\n+    requestBody.append(skdutid);\n+    requestBody.append(\"</DelegatedUserTid></KeyInfo>\");\n+\n+//    requestBody.append(\"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?><KeyInfo><Start>\");\n\nReview Comment:\n   Remove comments\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-31T13:05:18.144+0000", "updated": "2025-10-31T13:05:18.144+0000"}], "maxResults": 16, "total": 16, "startAt": 0}, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/3", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg", "name": "Major", "id": "3"}, "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/1", "description": "The issue is open and ready for the assignee to start work on it.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png", "name": "Open", "id": "1", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2", "id": 2, "key": "new", "colorName": "blue-gray", "name": "To Do"}}}}