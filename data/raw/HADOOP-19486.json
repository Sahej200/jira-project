{"expand": "renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations", "id": "13610979", "self": "https://issues.apache.org/jira/rest/api/2/issue/13610979", "key": "HADOOP-19486", "fields": {"summary": "Fully Support Java 23, 24 and 25", "description": "Hadoop trunk today mostly supports JDK17, but doesn't work at all on JDK23. (and conversely on JDK24 to be released in less than two weeks)\r\n\r\nWhile there are many smaller issues, the major breaking change is the SecurityManager removal (JEP411/486), and its many consequences.\r\n\r\nThe obvious change is that Subjec.doAs() and Subject.current() no longer work by default, and the replacement APIs must be used.\r\n\r\nThe more insidius change is that when SecurityManager is disabled then JDK22+ does not propapage the Subject to new Threads, which is something that Hadoop absolutely relies on.\r\n\r\n\r\nNote that Hadoop is always built with with JDK 17  (if the JDK is 17 or newer), unless the target version is specifically overriden.\r\nThis is not a problem, JDK17 class files running on a JDK 24 JVM is the expected use case for binary distributions.\r\n\r\nWe may want to run some tests where Hadoop is also compiled for the lastest JVM later. (taget Java 24 + JVM 24)", "reporter": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=stoty", "name": "stoty", "key": "stoty", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=stoty&avatarId=42544", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stoty&avatarId=42544", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stoty&avatarId=42544", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stoty&avatarId=42544"}, "displayName": "Istvan Toth", "active": true, "timeZone": "Europe/Budapest"}, "comment": {"comments": [{"self": "https://issues.apache.org/jira/rest/api/2/issue/13610979/comment/17933195", "id": "17933195", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=slfan1989", "name": "slfan1989", "key": "slfan1989", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=slfan1989&avatarId=40935", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=slfan1989&avatarId=40935", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=slfan1989&avatarId=40935", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=slfan1989&avatarId=40935"}, "displayName": "Shilun Fan", "active": true, "timeZone": "America/Vancouver"}, "body": "[~stoty] I originally hoped to support JDK 21 after supporting JDK 17, so it would be really awesome if it could support even newer JDK versions.", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=slfan1989", "name": "slfan1989", "key": "slfan1989", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=slfan1989&avatarId=40935", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=slfan1989&avatarId=40935", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=slfan1989&avatarId=40935", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=slfan1989&avatarId=40935"}, "displayName": "Shilun Fan", "active": true, "timeZone": "America/Vancouver"}, "created": "2025-03-07T06:03:21.494+0000", "updated": "2025-03-07T06:03:21.494+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13610979/comment/17936242", "id": "17936242", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=stoty", "name": "stoty", "key": "stoty", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=stoty&avatarId=42544", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stoty&avatarId=42544", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stoty&avatarId=42544", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stoty&avatarId=42544"}, "displayName": "Istvan Toth", "active": true, "timeZone": "Europe/Budapest"}, "body": "Could you also check the rest of the subtasks and dependent tasks here [~slfan1989]\u00a0 ?\r\n\r\nThese are fixing varius test issues on JDK11-23 , and are a requirement for adding the big JEP411 related fixes.\r\nI've split them up into small easy-to-review patches.\r\n\r\nAs a side effect, with these fixes applied the test suite should also run cleanly with JDK17 and 21.", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=stoty", "name": "stoty", "key": "stoty", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=stoty&avatarId=42544", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stoty&avatarId=42544", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stoty&avatarId=42544", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stoty&avatarId=42544"}, "displayName": "Istvan Toth", "active": true, "timeZone": "Europe/Budapest"}, "created": "2025-03-17T16:41:30.674+0000", "updated": "2025-03-17T16:41:30.674+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13610979/comment/17938977", "id": "17938977", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=ggregory", "name": "ggregory", "key": "garydgregory", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=garydgregory&avatarId=16828", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=garydgregory&avatarId=16828", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=garydgregory&avatarId=16828", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=garydgregory&avatarId=16828"}, "displayName": "Gary D. Gregory", "active": true, "timeZone": "America/New_York"}, "body": "Hi All, would you please set expectations as to when we will be able to run on Java 24/25-ea without getting failures like:\r\n{noformat}\r\n[ERROR] org.apache.commons.vfs2.provider.hdfs.HdfsFileProviderTestCase$HdfsProviderTestSuite -- Time elapsed: 0.006 s <<< ERROR!\r\njava.lang.UnsupportedOperationException: getSubject is not supported\r\n        at java.base/javax.security.auth.Subject.getSubject(Subject.java:277)\r\n        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:588)\r\n        at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.<init>(FSNamesystem.java:887)\r\n        at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.<init>(FSNamesystem.java:851)\r\n        at org.apache.hadoop.hdfs.server.namenode.NameNode.format(NameNode.java:1396)\r\n        at org.apache.hadoop.hdfs.server.namenode.NameNode.format(NameNode.java:495)\r\n        at org.apache.hadoop.hdfs.DFSTestUtil.formatNameNode(DFSTestUtil.java:256)\r\n        at org.apache.hadoop.hdfs.MiniDFSCluster.configureNameService(MiniDFSCluster.java:1158)\r\n        at org.apache.hadoop.hdfs.MiniDFSCluster.createNameNodesAndSetConf(MiniDFSCluster.java:1042)\r\n        at org.apache.hadoop.hdfs.MiniDFSCluster.initMiniDFSCluster(MiniDFSCluster.java:974)\r\n        at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:888)\r\n        at org.apache.commons.vfs2.provider.hdfs.HdfsFileProviderTestCase$HdfsProviderTestSuite.setUp(HdfsFileProviderTestCase.java:113)\r\n        at org.apache.commons.vfs2.AbstractTestSuite.lambda$run$0(AbstractTestSuite.java:234)\r\n        at junit.framework.TestResult.runProtected(TestResult.java:142)\r\n        at org.apache.commons.vfs2.AbstractTestSuite.run(AbstractTestSuite.java:239)\r\n{noformat}\r\n\u00a0", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=ggregory", "name": "ggregory", "key": "garydgregory", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=garydgregory&avatarId=16828", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=garydgregory&avatarId=16828", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=garydgregory&avatarId=16828", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=garydgregory&avatarId=16828"}, "displayName": "Gary D. Gregory", "active": true, "timeZone": "America/New_York"}, "created": "2025-03-27T15:12:45.232+0000", "updated": "2025-03-27T15:12:45.232+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13610979/comment/18009256", "id": "18009256", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=paulrutter", "name": "paulrutter", "key": "JIRAUSER304433", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Paul R\u00fctter", "active": true, "timeZone": "Europe/Amsterdam"}, "body": "I'm also interested in the progress of this task, since i'm running into the same exception when trying to run Spark 4.x against Java 25.\r\nAny update on this one?", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=paulrutter", "name": "paulrutter", "key": "JIRAUSER304433", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Paul R\u00fctter", "active": true, "timeZone": "Europe/Amsterdam"}, "created": "2025-07-23T13:21:44.270+0000", "updated": "2025-07-23T13:21:44.270+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13610979/comment/18010380", "id": "18010380", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=stoty", "name": "stoty", "key": "stoty", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=stoty&avatarId=42544", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stoty&avatarId=42544", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stoty&avatarId=42544", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stoty&avatarId=42544"}, "displayName": "Istvan Toth", "active": true, "timeZone": "Europe/Budapest"}, "body": "Most of the small issued are fixed.\r\n\r\nThere are two major issues left, one is SecurityManager removal + getSubject() removal,\u00a0\r\nthe other is the change in the principal inheritance for new threads.\r\n\r\nI have a WIP patch that fixes both, but they need some more polish, and I haven't had the time to work on them lately.", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=stoty", "name": "stoty", "key": "stoty", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=stoty&avatarId=42544", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stoty&avatarId=42544", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stoty&avatarId=42544", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stoty&avatarId=42544"}, "displayName": "Istvan Toth", "active": true, "timeZone": "Europe/Budapest"}, "created": "2025-07-28T12:16:31.586+0000", "updated": "2025-07-28T12:16:31.586+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13610979/comment/18022464", "id": "18022464", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=hugocost", "name": "hugocost", "key": "JIRAUSER311050", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Hugo Costa", "active": true, "timeZone": "Europe/Amsterdam"}, "body": "Hello Istvan, have you had any more time to work on that patch? JDK25 went GA last week and this is blocking our adoption", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=hugocost", "name": "hugocost", "key": "JIRAUSER311050", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Hugo Costa", "active": true, "timeZone": "Europe/Amsterdam"}, "created": "2025-09-24T15:26:50.196+0000", "updated": "2025-09-24T15:26:50.196+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13610979/comment/18022478", "id": "18022478", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=stoty", "name": "stoty", "key": "stoty", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=stoty&avatarId=42544", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stoty&avatarId=42544", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stoty&avatarId=42544", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stoty&avatarId=42544"}, "displayName": "Istvan Toth", "active": true, "timeZone": "Europe/Budapest"}, "body": "You can follow the discussion at https://github.com/apache/hadoop/pull/7892", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=stoty", "name": "stoty", "key": "stoty", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=stoty&avatarId=42544", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stoty&avatarId=42544", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stoty&avatarId=42544", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stoty&avatarId=42544"}, "displayName": "Istvan Toth", "active": true, "timeZone": "Europe/Budapest"}, "created": "2025-09-24T16:13:24.646+0000", "updated": "2025-09-24T16:13:24.646+0000"}], "maxResults": 7, "total": 7, "startAt": 0}, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/3", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg", "name": "Major", "id": "3"}, "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/1", "description": "The issue is open and ready for the assignee to start work on it.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png", "name": "Open", "id": "1", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2", "id": 2, "key": "new", "colorName": "blue-gray", "name": "To Do"}}}}