{
  "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
  "id": "13632880",
  "self": "https://issues.apache.org/jira/rest/api/2/issue/13632880",
  "key": "KAFKA-19846",
  "fields": {
    "parent": {
      "id": "13563930",
      "key": "KAFKA-16092",
      "self": "https://issues.apache.org/jira/rest/api/2/issue/13563930",
      "fields": {
        "summary": "Queues for Kafka",
        "status": {
          "self": "https://issues.apache.org/jira/rest/api/2/status/4",
          "description": "This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.",
          "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/reopened.png",
          "name": "Reopened",
          "id": "4",
          "statusCategory": {
            "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
            "id": 2,
            "key": "new",
            "colorName": "blue-gray",
            "name": "To Do"
          }
        },
        "priority": {
          "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
          "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
          "name": "Major",
          "id": "3"
        },
        "issuetype": {
          "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
          "id": "2",
          "description": "A new feature of the product, which has yet to be developed.",
          "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
          "name": "New Feature",
          "subtask": false,
          "avatarId": 21141
        }
      }
    },
    "fixVersions": [],
    "resolution": null,
    "customfield_12312322": null,
    "customfield_12312323": null,
    "customfield_12312320": null,
    "customfield_12310420": "9223372036854775807",
    "customfield_12312321": null,
    "customfield_12312328": null,
    "customfield_12312329": null,
    "customfield_12312326": null,
    "customfield_12310300": null,
    "customfield_12312327": null,
    "customfield_12312324": null,
    "customfield_12312720": null,
    "customfield_12312325": null,
    "lastViewed": null,
    "priority": {
      "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
      "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
      "name": "Major",
      "id": "3"
    },
    "labels": [],
    "customfield_12312333": null,
    "customfield_12312334": null,
    "customfield_12313422": "false",
    "customfield_12310310": "0.0",
    "customfield_12312331": null,
    "customfield_12312332": null,
    "aggregatetimeoriginalestimate": null,
    "timeestimate": null,
    "customfield_12312330": null,
    "versions": [],
    "customfield_12311120": null,
    "customfield_12313826": null,
    "customfield_12312339": null,
    "issuelinks": [],
    "customfield_12313825": null,
    "assignee": {
      "self": "https://issues.apache.org/jira/rest/api/2/user?username=adixitconfluent",
      "name": "adixitconfluent",
      "key": "JIRAUSER303719",
      "avatarUrls": {
        "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=JIRAUSER303719&avatarId=53125",
        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=JIRAUSER303719&avatarId=53125",
        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=JIRAUSER303719&avatarId=53125",
        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=JIRAUSER303719&avatarId=53125"
      },
      "displayName": "Abhinav Dixit",
      "active": true,
      "timeZone": "Etc/UTC"
    },
    "customfield_12312337": null,
    "customfield_12313823": null,
    "customfield_12312338": null,
    "customfield_12311920": null,
    "customfield_12313822": null,
    "customfield_12312335": null,
    "customfield_12313821": null,
    "customfield_12312336": null,
    "customfield_12313820": null,
    "status": {
      "self": "https://issues.apache.org/jira/rest/api/2/status/1",
      "description": "The issue is open and ready for the assignee to start work on it.",
      "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
      "name": "Open",
      "id": "1",
      "statusCategory": {
        "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
        "id": 2,
        "key": "new",
        "colorName": "blue-gray",
        "name": "To Do"
      }
    },
    "components": [],
    "customfield_12312026": null,
    "customfield_12312023": null,
    "customfield_12312024": null,
    "aggregatetimeestimate": null,
    "customfield_12312022": null,
    "customfield_12310921": null,
    "customfield_12310920": "9223372036854775807",
    "customfield_12312823": null,
    "creator": {
      "self": "https://issues.apache.org/jira/rest/api/2/user?username=pranavrth",
      "name": "pranavrth",
      "key": "JIRAUSER311308",
      "avatarUrls": {
        "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
      },
      "displayName": "Pranav Rathi",
      "active": true,
      "timeZone": "Etc/UTC"
    },
    "subtasks": [],
    "reporter": {
      "self": "https://issues.apache.org/jira/rest/api/2/user?username=pranavrth",
      "name": "pranavrth",
      "key": "JIRAUSER311308",
      "avatarUrls": {
        "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
      },
      "displayName": "Pranav Rathi",
      "active": true,
      "timeZone": "Etc/UTC"
    },
    "aggregateprogress": {
      "progress": 0,
      "total": 0
    },
    "customfield_12313520": null,
    "customfield_12310250": null,
    "progress": {
      "progress": 0,
      "total": 0
    },
    "customfield_12313924": null,
    "votes": {
      "self": "https://issues.apache.org/jira/rest/api/2/issue/KAFKA-19846/votes",
      "votes": 0,
      "hasVoted": false
    },
    "customfield_12313920": null,
    "issuetype": {
      "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
      "id": "7",
      "description": "The sub-task of the issue",
      "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
      "name": "Sub-task",
      "subtask": true,
      "avatarId": 21146
    },
    "timespent": null,
    "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@7807dc16[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6ba5ca2a[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@20f024[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@45119e90[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4962006d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@4b2874c[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@314e62e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@4ab80dc2[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@13801d90[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@318604b[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2719c390[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@2dc51cac[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
    "customfield_12314141": null,
    "customfield_12314140": null,
    "project": {
      "self": "https://issues.apache.org/jira/rest/api/2/project/12311720",
      "id": "12311720",
      "key": "KAFKA",
      "name": "Kafka",
      "projectTypeKey": "software",
      "avatarUrls": {
        "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12311720&avatarId=35864",
        "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311720&avatarId=35864",
        "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311720&avatarId=35864",
        "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311720&avatarId=35864"
      },
      "projectCategory": {
        "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/10560",
        "id": "10560",
        "description": "Apache Kafka projects",
        "name": "Kafka"
      }
    },
    "aggregatetimespent": null,
    "customfield_12312520": null,
    "customfield_12312521": "2025-10-30 11:41:43.0",
    "customfield_12314422": null,
    "customfield_12314421": null,
    "customfield_12314146": null,
    "customfield_12314420": null,
    "customfield_12314145": null,
    "customfield_12314144": null,
    "customfield_12314143": null,
    "resolutiondate": null,
    "workratio": -1,
    "customfield_12312923": null,
    "customfield_12312920": null,
    "customfield_12312921": null,
    "watches": {
      "self": "https://issues.apache.org/jira/rest/api/2/issue/KAFKA-19846/watchers",
      "watchCount": 1,
      "isWatching": false
    },
    "created": "2025-10-30T11:41:43.000+0000",
    "customfield_10022": null,
    "updated": "2025-10-30T16:40:52.000+0000",
    "timeoriginalestimate": null,
    "description": "While working on QfK implementation in librdkafka, I found that {{memberId}} field doesn't accept {{/}} and {{{}+{}}}.\r\n\r\nI get following error on the {*}broker side{*}.\r\n{code:java}\r\n[2025-10-23 15:10:55,319] ERROR [KafkaApi-1] Unexpected error handling request RequestHeader(apiKey=SHARE_FETCH, apiVersion=1, clientId=rdkafka, correlationId=4, headerVersion=2) -- ShareFetchRequestData(groupId='share-group-1', memberId='/FvjN95PRhGaAuA8aQMuTw', shareSessionEpoch=0, maxWaitMs=500, minBytes=1, maxBytes=52428800, maxRecords=500, batchSize=500, topics=[FetchTopic(topicId=sgd0qCnHRL-t80afMzN9nA, partitions=[FetchPartition(partitionIndex=0, partitionMaxBytes=0, acknowledgementBatches=[])])], forgottenTopicsData=[]) with context RequestContext(header=RequestHeader(apiKey=SHARE_FETCH, apiVersion=1, clientId=rdkafka, correlationId=4, headerVersion=2), connectionId='127.0.0.1:9092-127.0.0.1:41442-0-4', clientAddress=/127.0.0.1, principal=User:ANONYMOUS, listenerName=ListenerName(PLAINTEXT), securityProtocol=PLAINTEXT, clientInformation=ClientInformation(softwareName=librdkafka, softwareVersion=2.12.0-RC1-13-g82dbc3-dirty-devel-O0), fromPrivilegedListener=true, principalSerde=Optional[org.apache.kafka.common.security.authenticator.DefaultKafkaPrincipalBuilder@1648925]) (kafka.server.KafkaApis) java.lang.IllegalArgumentException: Illegal base64 character 2f at java.base/java.util.Base64$Decoder.decode0(Base64.java:848) ~[?:?] at java.base/java.util.Base64$Decoder.decode(Base64.java:566) ~[?:?] at java.base/java.util.Base64$Decoder.decode(Base64.java:589) ~[?:?] at org.apache.kafka.common.Uuid.fromString(Uuid.java:136) ~[kafka-clients-4.1.0.jar:?] at kafka.server.KafkaApis.handleShareFetchRequest(KafkaApis.scala:3157) [kafka_2.13-4.1.0.jar:?] at kafka.server.KafkaApis.handle(KafkaApis.scala:236) [kafka_2.13-4.1.0.jar:?] at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:158) [kafka_2.13-4.1.0.jar:?] at java.base/java.lang.Thread.run(Thread.java:840) [?:?] {code}\r\n*Client* gets {{UNKNOWN_SERVER_ERROR}} as response from the broker.\r\n\r\n \r\n\r\nDigging deeper I found that Uuid *{{fromString()}}* uses Base64 Url decoding and similarly *{{toString()}}* uses Base64 Url encoding.\r\n{code:java}\r\npublic static Uuid fromString(String str) {\r\n        if (str.length() > 24) {\r\n            throw new IllegalArgumentException(\"Input string with prefix `\"\r\n                + str.substring(0, 24) + \"` is too long to be decoded as a base64 UUID\");\r\n        }\r\n\r\n        ByteBuffer uuidBytes = ByteBuffer.wrap(Base64.getUrlDecoder().decode(str));\r\n        if (uuidBytes.remaining() != 16) {\r\n            throw new IllegalArgumentException(\"Input string `\" + str + \"` decoded as \"\r\n                + uuidBytes.remaining() + \" bytes, which is not equal to the expected 16 bytes \"\r\n                + \"of a base64-encoded UUID\");\r\n        }\r\n\r\n        return new Uuid(uuidBytes.getLong(), uuidBytes.getLong());\r\n} {code}\r\n{code:java}\r\npublic String toString() {\r\n        return Base64.getUrlEncoder().withoutPadding().encodeToString(getBytesFromUuid());\r\n} {code}\r\n{{I feel that Uuid should use normal Base64 encoding or decoding instead of Url one. If we use Url encoding and decoding then the Uuid itself changes. Generated Uuid and Url Base64 encoding for the Uuid will be different. }}{{}}",
    "customfield_10010": null,
    "customfield_12314523": null,
    "customfield_12314127": null,
    "customfield_12314522": null,
    "customfield_12314126": null,
    "customfield_12314521": null,
    "customfield_12314125": null,
    "customfield_12314520": null,
    "customfield_12314124": null,
    "customfield_12312340": null,
    "customfield_12314123": null,
    "customfield_12312341": null,
    "customfield_12312220": null,
    "customfield_12314122": null,
    "customfield_12314121": null,
    "customfield_12314120": null,
    "customfield_12314129": null,
    "customfield_12314524": null,
    "customfield_12314128": null,
    "summary": "Fix ShareFetch RPC doesn't allow '/' and '+' in memberId field",
    "customfield_12314130": null,
    "customfield_12310291": null,
    "customfield_12310290": null,
    "customfield_12314138": null,
    "customfield_12314137": null,
    "environment": null,
    "customfield_12314136": null,
    "customfield_12314135": null,
    "customfield_12311020": null,
    "customfield_12314134": null,
    "duedate": null,
    "customfield_12314132": null,
    "customfield_12314131": null,
    "customfield_12311820": "0|z1ydg0:",
    "customfield_12314139": null
  }
}