{"expand": "renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations", "id": "13621316", "self": "https://issues.apache.org/jira/rest/api/2/issue/13621316", "key": "HADOOP-19589", "fields": {"summary": "Support atomic rename() for S3 express", "description": "S3 Express now supports atomic renames: [https://aws.amazon.com/about-aws/whats-new/2025/06/amazon-s3-express-one-zone-atomic-renaming-objects-api/]\r\n\r\n\u00a0\r\n\r\nRename API is available as of SDK version 2.31.66.\u00a0", "reporter": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=ahmar", "name": "ahmar", "key": "JIRAUSER283484", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34055", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"}, "displayName": "Ahmar Suhail", "active": true, "timeZone": "Etc/UTC"}, "comment": {"comments": [{"self": "https://issues.apache.org/jira/rest/api/2/issue/13621316/comment/17983676", "id": "17983676", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org", "name": "stevel@apache.org", "key": "stevel@apache.org", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"}, "displayName": "Steve Loughran", "active": true, "timeZone": "Europe/London"}, "body": "* we can bypass xfer manager and just issue rename commands to the thread pool, with some throttling\r\n* source etag should be passed in\r\n* auditing to attach referrer header\r\n\r\n\r\nI see the comment about idempotency and want to know what it means if the request works, but we get a network error on the response, so don't see the 200\r\n\r\ns3a will have to retry, and the source will have been copied. What then?\r\n\r\nIf the dest etag == source then s3 should be able to consider this a no-op. does it?\r\n\r\notherwise we repeat, catch whatever error comes back from missing source, probe dest for having etag and the interpret as success.\r\n\r\n* Lots of tests of failure and race conditions, with the fault injection stuff we've added for other tests.\r\n\r\n\r\nnote also the manifest committer could then run on s3, org.apache.hadoop.mapreduce.lib.output.committer.manifest.impl.ManifestStoreOperationsThroughFileSystem\r\nno tangible benefit over the magic committer, just an interesting fact. Not worth the effort to support.\r\n\r\nBe more relevant to hive commits, FWIW.\r\n\r\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=stevel%40apache.org", "name": "stevel@apache.org", "key": "stevel@apache.org", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=stevel%40apache.org&avatarId=16513", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stevel%40apache.org&avatarId=16513", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stevel%40apache.org&avatarId=16513", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stevel%40apache.org&avatarId=16513"}, "displayName": "Steve Loughran", "active": true, "timeZone": "Europe/London"}, "created": "2025-06-19T11:32:04.159+0000", "updated": "2025-06-19T11:32:04.159+0000"}], "maxResults": 1, "total": 1, "startAt": 0}, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/3", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg", "name": "Major", "id": "3"}, "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/1", "description": "The issue is open and ready for the assignee to start work on it.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png", "name": "Open", "id": "1", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2", "id": 2, "key": "new", "colorName": "blue-gray", "name": "To Do"}}}}