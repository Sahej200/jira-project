{"expand": "renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations", "id": "13618780", "self": "https://issues.apache.org/jira/rest/api/2/issue/13618780", "key": "HADOOP-19574", "fields": {"summary": "Restore Subject propagation semantics for Java 22+", "description": "Java 22 breaks Subject propagation for new Threads (when SecurityManager is not enabled).\r\n\r\nPreviously, the Subject set by Subject.doAs() / Subject.callAs() automatically propagated to any new Threads created (via new Thread(), not Executors).\r\n\r\nWith JDK22, this is no longer the case, new Threads do NOT inherit the Subject.\r\n\r\nAs Hadoop heavily relies on the original behavior, we somehow need to solve this problem.", "reporter": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=stoty", "name": "stoty", "key": "stoty", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=stoty&avatarId=42544", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=stoty&avatarId=42544", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=stoty&avatarId=42544", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=stoty&avatarId=42544"}, "displayName": "Istvan Toth", "active": true, "timeZone": "Europe/Budapest"}, "comment": {"comments": [{"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18015585", "id": "18015585", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty opened a new pull request, #7892:\nURL: https://github.com/apache/hadoop/pull/7892\n\n   ### Description of PR\r\n   \r\n   JDK 22 breaks subject propagation into new Threads.\r\n   This patch adds a new HadoopThread class which restores the pre JDK22 semantics, and replaces\r\n   most Thread objects in the code with HadoopThread.\r\n   \r\n   ### How was this patch tested?\r\n   \r\n   Testing still in progress\r\n   \r\n   ### For code changes:\r\n   \r\n   - [X] Does the title or this PR starts with the corresponding JIRA issue id (e.g. 'HADOOP-17799. Your PR title ...')?\r\n   - [ ] Object storage: have the integration tests been executed and the endpoint declared according to the connector-specific documentation?\r\n   - [ ] If adding new dependencies to the code, are these dependencies licensed in a way that is compatible for inclusion under [ASF 2.0](http://www.apache.org/legal/resolved.html#category-a)?\r\n   - [ ] If applicable, have you updated the `LICENSE`, `LICENSE-binary`, `NOTICE-binary` files?\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-22T06:37:39.731+0000", "updated": "2025-08-22T06:37:39.731+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18015586", "id": "18015586", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3213228211\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |   0m  0s |  |  Docker mode activated.  |\r\n   | -1 :x: |  patch  |   0m 21s |  |  https://github.com/apache/hadoop/pull/7892 does not apply to trunk. Rebase required? Wrong Branch? See https://cwiki.apache.org/confluence/display/HADOOP/How+To+Contribute for help.  |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/1/console |\r\n   | versions | git=2.34.1 |\r\n   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-22T06:40:27.797+0000", "updated": "2025-08-22T06:40:27.797+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18015588", "id": "18015588", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3213242905\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |   0m  0s |  |  Docker mode activated.  |\r\n   | -1 :x: |  patch  |   0m 22s |  |  https://github.com/apache/hadoop/pull/7892 does not apply to trunk. Rebase required? Wrong Branch? See https://cwiki.apache.org/confluence/display/HADOOP/How+To+Contribute for help.  |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/2/console |\r\n   | versions | git=2.34.1 |\r\n   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-22T06:47:06.744+0000", "updated": "2025-08-22T06:47:06.744+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18015604", "id": "18015604", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3213511403\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |   0m  0s |  |  Docker mode activated.  |\r\n   | -1 :x: |  patch  |   0m 21s |  |  https://github.com/apache/hadoop/pull/7892 does not apply to trunk. Rebase required? Wrong Branch? See https://cwiki.apache.org/confluence/display/HADOOP/How+To+Contribute for help.  |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/3/console |\r\n   | versions | git=2.34.1 |\r\n   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-22T08:19:36.338+0000", "updated": "2025-08-22T08:19:36.338+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18015607", "id": "18015607", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3213529762\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |   0m  0s |  |  Docker mode activated.  |\r\n   | -1 :x: |  patch  |   0m 21s |  |  https://github.com/apache/hadoop/pull/7892 does not apply to trunk. Rebase required? Wrong Branch? See https://cwiki.apache.org/confluence/display/HADOOP/How+To+Contribute for help.  |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/4/console |\r\n   | versions | git=2.34.1 |\r\n   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-22T08:26:44.510+0000", "updated": "2025-08-22T08:26:44.510+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016428", "id": "18016428", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3226802948\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |   0m  0s |  |  Docker mode activated.  |\r\n   | -1 :x: |  patch  |   0m 21s |  |  https://github.com/apache/hadoop/pull/7892 does not apply to trunk. Rebase required? Wrong Branch? See https://cwiki.apache.org/confluence/display/HADOOP/How+To+Contribute for help.  |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/5/console |\r\n   | versions | git=2.34.1 |\r\n   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-27T05:40:05.658+0000", "updated": "2025-08-27T05:40:05.658+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016429", "id": "18016429", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3226810521\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |   0m  0s |  |  Docker mode activated.  |\r\n   | -1 :x: |  patch  |   0m 21s |  |  https://github.com/apache/hadoop/pull/7892 does not apply to trunk. Rebase required? Wrong Branch? See https://cwiki.apache.org/confluence/display/HADOOP/How+To+Contribute for help.  |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/6/console |\r\n   | versions | git=2.34.1 |\r\n   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-27T05:44:39.809+0000", "updated": "2025-08-27T05:44:39.809+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016452", "id": "18016452", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3227074661\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |   0m  0s |  |  Docker mode activated.  |\r\n   | -1 :x: |  patch  |   0m 21s |  |  https://github.com/apache/hadoop/pull/7892 does not apply to trunk. Rebase required? Wrong Branch? See https://cwiki.apache.org/confluence/display/HADOOP/How+To+Contribute for help.  |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/7/console |\r\n   | versions | git=2.34.1 |\r\n   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-27T07:21:11.900+0000", "updated": "2025-08-27T07:21:11.900+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016457", "id": "18016457", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3227235031\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |   0m  0s |  |  Docker mode activated.  |\r\n   | -1 :x: |  patch  |   0m 32s |  |  https://github.com/apache/hadoop/pull/7892 does not apply to trunk. Rebase required? Wrong Branch? See https://cwiki.apache.org/confluence/display/HADOOP/How+To+Contribute for help.  |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/8/console |\r\n   | versions | git=2.34.1 |\r\n   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-27T08:13:19.681+0000", "updated": "2025-08-27T08:13:19.681+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016535", "id": "18016535", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3228078321\n\n   This is final piece for Java 24 / 25 support.\r\n   While the patch is huge, the actual changes are very simple.\r\n   HadoopThread was added and Daemon was modified, the rest is just simply replacement.\r\n   \r\n   Please take a look @pan3793 @slfan1989 @jojochuang @cnauroth @steveloughran \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-27T12:48:10.818+0000", "updated": "2025-08-27T12:48:10.818+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016540", "id": "18016540", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "slfan1989 commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3228107396\n\n   > This is final piece for Java 24 / 25 support. While the patch is huge, the actual changes are very simple. HadoopThread was added and Daemon was modified, the rest is just simply replacement.\r\n   > \r\n   > Please take a look @pan3793 @slfan1989 @jojochuang @cnauroth @steveloughran\r\n   \r\n   I have a few experienced members to recommend for the review. \r\n   \r\n   @Hexiaoqiao @ayushtkn @szetszwo I need your help to collaboratively review this PR. Thank you very much!\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-27T12:57:39.908+0000", "updated": "2025-08-27T12:57:39.908+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016603", "id": "18016603", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3229172284\n\n   Unfortunately Yetus cannot handle patches this big, I don't think we can get CI run via GitHub.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-27T17:51:36.243+0000", "updated": "2025-08-27T17:51:36.243+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016604", "id": "18016604", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3229188836\n\n   Rebased on top of trunk and updated test instructions.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-27T17:56:42.628+0000", "updated": "2025-08-27T17:56:42.628+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016605", "id": "18016605", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3229194641\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |   0m  0s |  |  Docker mode activated.  |\r\n   | -1 :x: |  patch  |   0m 23s |  |  https://github.com/apache/hadoop/pull/7892 does not apply to trunk. Rebase required? Wrong Branch? See https://cwiki.apache.org/confluence/display/HADOOP/How+To+Contribute for help.  |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/9/console |\r\n   | versions | git=2.34.1 |\r\n   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-27T17:58:48.496+0000", "updated": "2025-08-27T17:58:48.496+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016606", "id": "18016606", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3229205126\n\n   BTW I tested this by running the full test suite overnight on three VMs: \r\n   - one with this patch + JDK 24\r\n   - one with this patch + JDK 1.8 \r\n   - and one trunk + JDK 1.8 to get a baseline.\r\n   \r\n   I was able to get to the point where all the failing tests on the JDK24 were also either broken or flakey on trunk.\r\n   \r\n   I of course encourage everyone to run similar tests, and perhaps catch anything I missed.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-27T18:02:16.481+0000", "updated": "2025-08-27T18:02:16.481+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016609", "id": "18016609", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "szetszwo commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3229269718\n\n   > Unfortunately Yetus cannot handle patches this big, I don't think we can get CI run via GitHub.\r\n   \r\n   @stoty , we usually break such a large change into several JIRAs.  In this case, we may\r\n   1. add HadoopThread and change hadoop-common to use it;\r\n   2. change HDFS to use HadoopThread;\r\n   3. change Mapreduce/YARN to use HadoopThread; and\r\n   4. change all the remaining components to use it.\r\n   \r\n   Alternatively, we may work on it in a dev branch.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-27T18:24:24.423+0000", "updated": "2025-08-27T18:24:24.423+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016676", "id": "18016676", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "slfan1989 commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3231655872\n\n   @cnauroth @szetszwo Thank you for your responses! Regarding the issue with Yetus failing to compile, @ayushtkn  proposed a solution to handle large PRs. I suggest we first run this PR to test it, and if it\u2019s suitable for splitting, we can submit it in parts.\r\n   \r\n   @stoty Thank you for your contribution! Please review the details of this commit. During development, we need to replace Yetus with Ayush's branch. If this PR is merged, we should revert this commit.\r\n   \r\n   https://github.com/apache/hadoop/pull/7019/commits/8d636ce31911936d8459b1ef134b1704d55a948e\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T03:17:37.062+0000", "updated": "2025-08-28T03:17:37.062+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016677", "id": "18016677", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3231659011\n\n   > > Unfortunately Yetus cannot handle patches this big, I don't think we can get CI run via GitHub.\r\n   > \r\n   > @stoty , we usually break such a large change into several JIRAs. In this case, we may\r\n   > \r\n   > 1. add HadoopThread and change hadoop-common to use it;\r\n   > 2. change HDFS to use HadoopThread;\r\n   > 3. change Mapreduce/YARN to use HadoopThread; and\r\n   > 4. change all the remaining components to use it.\r\n   \r\n   The problem with this is that it would make it impossible to get a clean JDK24/25 test run until all the changes are committed, hence all but the last commit would be flying blind WRT testing. \r\n   (It also wouldn't make a lot of sense, as the changes are exactly the same for all subprojects)\r\n   \r\n   > \r\n   > Alternatively, we may work on it in a dev branch.\r\n   \r\n   That sounds better, but I personally don't have the permissions for that.\r\n   Could you (or someone else ) open a feature branch and add this commit ?\r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T03:18:43.240+0000", "updated": "2025-08-28T03:18:43.240+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016679", "id": "18016679", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3231676343\n\n   Thanks, I've changed the Yetus version.\r\n   Let's hope it works.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T03:24:19.540+0000", "updated": "2025-08-28T03:24:19.540+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016680", "id": "18016680", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "slfan1989 commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3231677191\n\n   > > > Unfortunately Yetus cannot handle patches this big, I don't think we can get CI run via GitHub.\r\n   > > \r\n   > > \r\n   > > @stoty , we usually break such a large change into several JIRAs. In this case, we may\r\n   > > \r\n   > > 1. add HadoopThread and change hadoop-common to use it;\r\n   > > 2. change HDFS to use HadoopThread;\r\n   > > 3. change Mapreduce/YARN to use HadoopThread; and\r\n   > > 4. change all the remaining components to use it.\r\n   > \r\n   > The problem with this is that it would make it impossible to get a clean JDK24/25 test run until all the changes are committed, hence all but the last commit would be flying blind WRT testing. (It also wouldn't make a lot of sense, as the changes are exactly the same for all subprojects)\r\n   > \r\n   > > Alternatively, we may work on it in a dev branch.\r\n   > \r\n   > That sounds better, but I personally don't have the permissions for that. Could you (or someone else ) open a feature branch and add this commit ?\r\n   \r\n   @stoty I support creating a separate dev branch, +1, and I'm willing to help follow up and create the new branch.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T03:24:37.189+0000", "updated": "2025-08-28T03:24:37.189+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016681", "id": "18016681", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3231684820\n\n   Thanks @slfan1989 . If the purpose of the new branch would be only getting Yetus work, and the new Yetus branch fixes the issue, then the feature branch may not be necessary.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T03:27:04.171+0000", "updated": "2025-08-28T03:27:04.171+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016682", "id": "18016682", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "slfan1989 commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3231689764\n\n   > Thanks @slfan1989 . If the purpose of the new branch would be only getting Yetus work, and the new Yetus branch fixes the issue, then the feature branch may not be necessary.\r\n   \r\n   Thank you for your feedback. Let's wait for Yetus's results.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T03:28:42.871+0000", "updated": "2025-08-28T03:28:42.871+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016685", "id": "18016685", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3231718289\n\n   For reference, here are my notes on the problematic tests:\r\n   \r\n   <google-sheets-html-origin><style type=\"text/css\"><!--td {border: 1px solid #cccccc;}br {mso-data-placement:same-cell;}--></style>\r\n   TestAMSimulator | FLAKEY ON TRUNK\r\n   ", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T03:39:04.591+0000", "updated": "2025-08-28T03:39:04.591+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016703", "id": "18016703", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "Hexiaoqiao commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3232137231\n\n   Thanks @stoty and @slfan1989 for your work. LGTM (with checked in PR https://github.com/apache/hadoop/pull/7886). One concerns, Yetus is saying not good to check in. Agree to work on dev branch, then merge to trunk when it is ready. Thanks all again.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T06:35:36.562+0000", "updated": "2025-08-28T06:35:36.562+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016707", "id": "18016707", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "ayushtkn commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3232195313\n\n   @stoty Yetus does have some issue applying changes when the changes are beyond a certain point. I reported it some time back:\r\n   https://issues.apache.org/jira/browse/YETUS-719?focusedCommentId=17874835&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-17874835\r\n   \r\n   You can temporarily hack it by c-picking this commit & revert it once you get the result from Yetus:\r\n   https://github.com/ayushtkn/hadoop/commit/bee603ed278eb0978af5822d19bf3c1c5704ba13\r\n   \r\n   See, if it helps :-) \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T06:59:18.510+0000", "updated": "2025-08-28T06:59:18.510+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016713", "id": "18016713", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "pan3793 commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3232236004\n\n   @stoty Most tests can pass in Java 25 even without this PR. Is it possible to have a PR only include changes that fix affected tests?\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T07:14:31.363+0000", "updated": "2025-08-28T07:14:31.363+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016735", "id": "18016735", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3232729888\n\n   That would take some time @pan3793 .\r\n   \r\n   The problem is that very few of the tests are using Kerberos, and the subject issue mostly breaks Kerberized clusters.\r\n   \r\n   Making only enough changes to fix the tests would probably lead to a lot of real work breakages.\r\n   \r\n   We could remove the \"unneccessary\" changes from the test code.\r\n   \r\n   I'm not sure if Hadoop has a mechanism to run tests on a real cluster instead of miniclusters. If it does, then many of those changes will be needed for running tests on kerberized real clusters.\r\n   \r\n   I'm going to run the test sute on JDK24 without the patch, and report the breakages here.\r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T09:34:32.386+0000", "updated": "2025-08-28T09:34:32.386+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016766", "id": "18016766", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3233272202\n\n   I general, I think for robustness reasons Hadoop should stop directly using Thread.\r\n   I would go as far as adding maven enforcer rules to prohibit code from directly using Thread.\r\n   \r\n   Using a naked Thread by mistake in the code can lead to hard to debug bugs which only manifest in kerberized (i.e real production) clusters.\r\n   \r\n   It is much safer to use HadoopThread everywhere, the overhead is negligible compared to the cost of starting a new thread. (basically reading then setting a ThreadLocal or equivalent structure)\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T12:18:09.584+0000", "updated": "2025-08-28T12:18:09.584+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016775", "id": "18016775", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "pan3793 commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2307314275\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/HadoopThread.java:\n##########\n@@ -0,0 +1,105 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior after the JEP411/JEP486\n+ * changes\n+ * \n+ * Runnables can be specified normally, but the work() method has to be\n+ * overridden instead of run() when subclassing.\n+ */\n+public class HadoopThread extends Thread {\n\nReview Comment:\n   Hadoop has MiniKDC in the test infrastructure, is it possible to have a dedicated UT for `HadoopThread`, so that we can test against different JDK versions to ensure the consistent semantics of Subject propagation?\r\n   \r\n   and downstream projects that require Subject propagation also need to change their code, right?\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T12:48:38.726+0000", "updated": "2025-08-28T12:48:38.726+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016778", "id": "18016778", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2307335006\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/HadoopThread.java:\n##########\n@@ -0,0 +1,105 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior after the JEP411/JEP486\n+ * changes\n+ * \n+ * Runnables can be specified normally, but the work() method has to be\n+ * overridden instead of run() when subclassing.\n+ */\n+public class HadoopThread extends Thread {\n\nReview Comment:\n   We don't need miniKDC for that, testing for the Subject propagation is trivial. Kerberos need Subject propagation, but we don't Kerberos to test that.\r\n   \r\n   Yes, downstream projects that depend on the original Subject propagation semantics will need also to deal with the changes separately.\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T12:56:39.187+0000", "updated": "2025-08-28T12:56:39.187+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016779", "id": "18016779", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3233402733\n\n   > I'm not sure if Hadoop has a mechanism to run tests on a real cluster instead of miniclusters. If it does, then many of those changes will be needed for running tests on kerberized real clusters.\r\n   \r\n   I got confirmation that Hadoop cannot run the test suite on external cluters, so in theory we don't need to replace Thread everywhere in the tests.\r\n   \r\n   I still think that it's more robust to replace every Thread instance.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T12:58:26.358+0000", "updated": "2025-08-28T12:58:26.358+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016781", "id": "18016781", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "pan3793 commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2307357331\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/HadoopThread.java:\n##########\n@@ -0,0 +1,105 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior after the JEP411/JEP486\n+ * changes\n+ * \n+ * Runnables can be specified normally, but the work() method has to be\n+ * overridden instead of run() when subclassing.\n+ */\n+public class HadoopThread extends Thread {\n\nReview Comment:\n   So `HadoopThread` will be a public API used widely by downstream projects, then it needs more detailed javadocs (better to include examples), and a dedicated UT will also be a good example for developers to learn and understand what it does.\r\n   \r\n   I think it's worth a dedicated PR.\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T13:05:14.764+0000", "updated": "2025-08-28T13:05:14.764+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016793", "id": "18016793", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2307456822\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/HadoopThread.java:\n##########\n@@ -0,0 +1,105 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior after the JEP411/JEP486\n+ * changes\n+ * \n+ * Runnables can be specified normally, but the work() method has to be\n+ * overridden instead of run() when subclassing.\n+ */\n+public class HadoopThread extends Thread {\n\nReview Comment:\n   I have added a unit test.\r\n   \r\n   It's really up to downstream projects.\r\n   \r\n   For example, in HBase we support multiple Hadoop versions, so we will have to clone HadoopThread, otherwise we'd have to drop support for all earlier Hadoop versions. \r\n   \r\n   Downstream users who are fine with supporting only the latest Hadoop release can use it directly.\r\n   \r\n   If we consider this a public API, then maybe we could try to find a better name for it, as HadoopThread is not very descriptive, I just haven't been able to find one that is not super long or awkward.\r\n   \r\n   _SubjectInheritingThread_ would be a candidate, but it's too long IMO.\r\n   \r\n   \r\n   \n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T13:40:43.791+0000", "updated": "2025-08-28T13:40:43.791+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016802", "id": "18016802", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "pan3793 commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2307623649\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/HadoopThread.java:\n##########\n@@ -0,0 +1,105 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior after the JEP411/JEP486\n+ * changes\n+ * \n+ * Runnables can be specified normally, but the work() method has to be\n+ * overridden instead of run() when subclassing.\n+ */\n+public class HadoopThread extends Thread {\n\nReview Comment:\n   I support naming it `SubjectInheritingThread`\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T14:38:40.007+0000", "updated": "2025-08-28T14:38:40.007+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016804", "id": "18016804", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "pan3793 commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2307651230\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/Daemon.java:\n##########\n@@ -18,16 +18,59 @@\n \n package org.apache.hadoop.util;\n \n+import java.security.PrivilegedAction;\n import java.util.concurrent.ThreadFactory;\n \n+import javax.security.auth.Subject;\n+\n import org.apache.hadoop.classification.InterfaceAudience;\n import org.apache.hadoop.classification.InterfaceStability;\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n \n-/** A thread that has called {@link Thread#setDaemon(boolean) } with true.*/\n+/** A thread that has called {@link Thread#setDaemon(boolean) } with true.\n+ * \n+ * The runnable code must either be specified in the runnable parameter or\n+ * in the override work() method. \n+ * \n+ * The subject propagation is already added in either case. \n+ * \n+ * */\n @InterfaceAudience.LimitedPrivate({\"HDFS\", \"MapReduce\"})\n @InterfaceStability.Unstable\n public class Daemon extends Thread {\n \n+  Subject startSubject;\n+  \n+ @Override\n+ public final void start() {\n+   startSubject = SubjectUtil.current();\n+   super.start();\n+ }\n+  \n+  /**\n+   * Override this instead of run()\n+   */\n+  public void work() {\n+    throw new IllegalArgumentException(\"\");\n\nReview Comment:\n   have a meaningful message?\n\n\n\n##########\nhadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/util/concurrent/TestSubjectPropagation.java:\n##########\n@@ -0,0 +1,125 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ * <p>\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ * <p>\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+import java.util.concurrent.Callable;\n+\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+import org.apache.hadoop.util.Daemon;\n+import org.junit.jupiter.api.Test;\n+\n+public class TestSubjectPropagation {\n+\n+  private Subject childSubject = null;\n+\n+  @Test\n+  public void testWork() {\n+    Subject parentSubject = new Subject();\n+    childSubject = null;\n+\n+    SubjectUtil.callAs(parentSubject, new Callable<Void>() {\n+      public Void call() throws InterruptedException {\n+        HadoopThread t = new HadoopThread() {\n+          public void work() {\n+            childSubject = SubjectUtil.current();\n+          }\n+        };\n+        t.start();\n+        t.join(1000);\n+        return (Void) null;\n+      }\n+    });\n+\n+    assertEquals(parentSubject, childSubject);\n+  }\n+\n+  @Test\n+  public void testRunnable() {\n+    Subject parentSubject = new Subject();\n+    childSubject = null;\n+\n+    SubjectUtil.callAs(parentSubject, new Callable<Void>() {\n+      public Void call() throws InterruptedException {\n+        Runnable r = new Runnable() {\n+          @Override\n+          public void run() {\n+            childSubject = SubjectUtil.current();\n+          }\n+        };\n+\n+        HadoopThread t = new HadoopThread(r);\n\nReview Comment:\n   Could you add another case that uses `Thread`? and it should have different behaviors on different JDK versions.\n\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/HadoopThread.java:\n##########\n@@ -0,0 +1,105 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior after the JEP411/JEP486\n+ * changes\n+ * \n+ * Runnables can be specified normally, but the work() method has to be\n+ * overridden instead of run() when subclassing.\n+ */\n+public class HadoopThread extends Thread {\n+\n+  Subject startSubject;\n+  Runnable hadoopTarget;\n+\n+  public HadoopThread() {\n+    super();\n+  }\n+\n+  public HadoopThread(Runnable target) {\n+    super();\n+    this.hadoopTarget = target;\n+  }\n+\n+  public HadoopThread(ThreadGroup group, Runnable target) {\n+    // The target passed to Thread has no effect, we only pass it\n+    // because there is no super(group) constructor.\n+    super(group, target);\n+    this.hadoopTarget = target;\n+  }\n+\n+  public HadoopThread(Runnable target, String name) {\n+    super(name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  public HadoopThread(String name) {\n+    super(name);\n+  }\n+\n+  public HadoopThread(ThreadGroup group, String name) {\n+    super(group, name);\n+  }\n+\n+  public HadoopThread(ThreadGroup group, Runnable target, String name) {\n+    super(group, name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  @Override\n+  public final void start() {\n+    startSubject = SubjectUtil.current();\n+    super.start();\n+  }\n+\n+  /**\n+   * Override this instead of run()\n+   * \n+   * It is really unfortunate that we have to introduce a new method and cannot reuse run(),\n+   * but since run() is designed to be overridden, I couldn't find any other way to make this work.\n+   *  \n+   */\n+  public void work() {\n+    throw new IllegalArgumentException(\"No Runnable was specified and work() is not overriden\");\n+  }\n+\n+  @Override\n+  public final void run() {\n+      SubjectUtil.doAs(startSubject, new PrivilegedAction<Void>() {\n\nReview Comment:\n   indention\n\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/Daemon.java:\n##########\n@@ -18,16 +18,59 @@\n \n package org.apache.hadoop.util;\n \n+import java.security.PrivilegedAction;\n import java.util.concurrent.ThreadFactory;\n \n+import javax.security.auth.Subject;\n+\n import org.apache.hadoop.classification.InterfaceAudience;\n import org.apache.hadoop.classification.InterfaceStability;\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n \n-/** A thread that has called {@link Thread#setDaemon(boolean) } with true.*/\n+/** A thread that has called {@link Thread#setDaemon(boolean) } with true.\n+ * \n+ * The runnable code must either be specified in the runnable parameter or\n+ * in the override work() method. \n+ * \n+ * The subject propagation is already added in either case. \n+ * \n+ * */\n @InterfaceAudience.LimitedPrivate({\"HDFS\", \"MapReduce\"})\n @InterfaceStability.Unstable\n public class Daemon extends Thread {\n \n+  Subject startSubject;\n+  \n+ @Override\n+ public final void start() {\n\nReview Comment:\n   indention\n\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/Daemon.java:\n##########\n@@ -18,16 +18,59 @@\n \n package org.apache.hadoop.util;\n \n+import java.security.PrivilegedAction;\n import java.util.concurrent.ThreadFactory;\n \n+import javax.security.auth.Subject;\n+\n import org.apache.hadoop.classification.InterfaceAudience;\n import org.apache.hadoop.classification.InterfaceStability;\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n \n-/** A thread that has called {@link Thread#setDaemon(boolean) } with true.*/\n+/** A thread that has called {@link Thread#setDaemon(boolean) } with true.\n+ * \n+ * The runnable code must either be specified in the runnable parameter or\n+ * in the override work() method. \n+ * \n+ * The subject propagation is already added in either case. \n+ * \n+ * */\n @InterfaceAudience.LimitedPrivate({\"HDFS\", \"MapReduce\"})\n @InterfaceStability.Unstable\n public class Daemon extends Thread {\n \n+  Subject startSubject;\n+  \n+ @Override\n+ public final void start() {\n+   startSubject = SubjectUtil.current();\n+   super.start();\n+ }\n+  \n+  /**\n+   * Override this instead of run()\n+   */\n+  public void work() {\n+    throw new IllegalArgumentException(\"\");\n+  }\n+  \n+  @Override\n+  public final void run() {\n+      SubjectUtil.doAs(startSubject, new PrivilegedAction<Void>() {\n\nReview Comment:\n   nit: indention is incorrect here\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T14:57:25.883+0000", "updated": "2025-08-28T14:57:25.883+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016850", "id": "18016850", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2308192881\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/Daemon.java:\n##########\n@@ -18,16 +18,59 @@\n \n package org.apache.hadoop.util;\n \n+import java.security.PrivilegedAction;\n import java.util.concurrent.ThreadFactory;\n \n+import javax.security.auth.Subject;\n+\n import org.apache.hadoop.classification.InterfaceAudience;\n import org.apache.hadoop.classification.InterfaceStability;\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n \n-/** A thread that has called {@link Thread#setDaemon(boolean) } with true.*/\n+/** A thread that has called {@link Thread#setDaemon(boolean) } with true.\n+ * \n+ * The runnable code must either be specified in the runnable parameter or\n+ * in the override work() method. \n+ * \n+ * The subject propagation is already added in either case. \n+ * \n+ * */\n @InterfaceAudience.LimitedPrivate({\"HDFS\", \"MapReduce\"})\n @InterfaceStability.Unstable\n public class Daemon extends Thread {\n \n+  Subject startSubject;\n+  \n+ @Override\n+ public final void start() {\n+   startSubject = SubjectUtil.current();\n+   super.start();\n+ }\n+  \n+  /**\n+   * Override this instead of run()\n+   */\n+  public void work() {\n+    throw new IllegalArgumentException(\"\");\n\nReview Comment:\n   I changed the logic to match the the one in Thread.\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T18:15:15.072+0000", "updated": "2025-08-28T18:15:15.072+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016852", "id": "18016852", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2308195101\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/Daemon.java:\n##########\n@@ -18,16 +18,59 @@\n \n package org.apache.hadoop.util;\n \n+import java.security.PrivilegedAction;\n import java.util.concurrent.ThreadFactory;\n \n+import javax.security.auth.Subject;\n+\n import org.apache.hadoop.classification.InterfaceAudience;\n import org.apache.hadoop.classification.InterfaceStability;\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n \n-/** A thread that has called {@link Thread#setDaemon(boolean) } with true.*/\n+/** A thread that has called {@link Thread#setDaemon(boolean) } with true.\n+ * \n+ * The runnable code must either be specified in the runnable parameter or\n+ * in the override work() method. \n+ * \n+ * The subject propagation is already added in either case. \n+ * \n+ * */\n @InterfaceAudience.LimitedPrivate({\"HDFS\", \"MapReduce\"})\n @InterfaceStability.Unstable\n public class Daemon extends Thread {\n \n+  Subject startSubject;\n+  \n+ @Override\n+ public final void start() {\n+   startSubject = SubjectUtil.current();\n+   super.start();\n+ }\n+  \n+  /**\n+   * Override this instead of run()\n+   */\n+  public void work() {\n+    throw new IllegalArgumentException(\"\");\n+  }\n+  \n+  @Override\n+  public final void run() {\n+      SubjectUtil.doAs(startSubject, new PrivilegedAction<Void>() {\n\nReview Comment:\n   Reformatted the class\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T18:16:15.066+0000", "updated": "2025-08-28T18:16:15.066+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016854", "id": "18016854", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2308197503\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/HadoopThread.java:\n##########\n@@ -0,0 +1,105 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior after the JEP411/JEP486\n+ * changes\n+ * \n+ * Runnables can be specified normally, but the work() method has to be\n+ * overridden instead of run() when subclassing.\n+ */\n+public class HadoopThread extends Thread {\n\nReview Comment:\n   Renamed\r\n   \n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T18:17:15.112+0000", "updated": "2025-08-28T18:17:15.112+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016855", "id": "18016855", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2308198971\n\n\n##########\nhadoop-common-project/hadoop-common/src/test/java/org/apache/hadoop/util/concurrent/TestSubjectPropagation.java:\n##########\n@@ -0,0 +1,125 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ * <p>\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ * <p>\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+import java.util.concurrent.Callable;\n+\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+import org.apache.hadoop.util.Daemon;\n+import org.junit.jupiter.api.Test;\n+\n+public class TestSubjectPropagation {\n+\n+  private Subject childSubject = null;\n+\n+  @Test\n+  public void testWork() {\n+    Subject parentSubject = new Subject();\n+    childSubject = null;\n+\n+    SubjectUtil.callAs(parentSubject, new Callable<Void>() {\n+      public Void call() throws InterruptedException {\n+        HadoopThread t = new HadoopThread() {\n+          public void work() {\n+            childSubject = SubjectUtil.current();\n+          }\n+        };\n+        t.start();\n+        t.join(1000);\n+        return (Void) null;\n+      }\n+    });\n+\n+    assertEquals(parentSubject, childSubject);\n+  }\n+\n+  @Test\n+  public void testRunnable() {\n+    Subject parentSubject = new Subject();\n+    childSubject = null;\n+\n+    SubjectUtil.callAs(parentSubject, new Callable<Void>() {\n+      public Void call() throws InterruptedException {\n+        Runnable r = new Runnable() {\n+          @Override\n+          public void run() {\n+            childSubject = SubjectUtil.current();\n+          }\n+        };\n+\n+        HadoopThread t = new HadoopThread(r);\n\nReview Comment:\n   Done\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T18:17:50.131+0000", "updated": "2025-08-28T18:17:50.131+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016859", "id": "18016859", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "szetszwo commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2308244987\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/HadoopThread.java:\n##########\n@@ -0,0 +1,105 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior after the JEP411/JEP486\n+ * changes\n+ * \n+ * Runnables can be specified normally, but the work() method has to be\n+ * overridden instead of run() when subclassing.\n+ */\n+public class HadoopThread extends Thread {\n+\n+  Subject startSubject;\n+  Runnable hadoopTarget;\n+\n+  public HadoopThread() {\n+    super();\n+  }\n+\n+  public HadoopThread(Runnable target) {\n+    super();\n+    this.hadoopTarget = target;\n+  }\n+\n+  public HadoopThread(ThreadGroup group, Runnable target) {\n+    // The target passed to Thread has no effect, we only pass it\n+    // because there is no super(group) constructor.\n+    super(group, target);\n+    this.hadoopTarget = target;\n+  }\n+\n+  public HadoopThread(Runnable target, String name) {\n+    super(name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  public HadoopThread(String name) {\n+    super(name);\n+  }\n+\n+  public HadoopThread(ThreadGroup group, String name) {\n+    super(group, name);\n+  }\n+\n+  public HadoopThread(ThreadGroup group, Runnable target, String name) {\n+    super(group, name);\n+    this.hadoopTarget = target;\n+  }\n\nReview Comment:\n   It should add a Builder class instead of having  public constructor.  Then, we can make it configurable to return `Thread` or `HadoopThread` or something else in the future.\r\n   ```diff\r\n   diff --git a/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/HadoopThread.java b/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/HadoopThread.java\r\n   index 5ce2c75f4f4..fedd4e3a107 100644\r\n   -", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-28T18:55:07.576+0000", "updated": "2025-08-28T18:55:07.576+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016923", "id": "18016923", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2309104177\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/HadoopThread.java:\n##########\n@@ -0,0 +1,105 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior after the JEP411/JEP486\n+ * changes\n+ * \n+ * Runnables can be specified normally, but the work() method has to be\n+ * overridden instead of run() when subclassing.\n+ */\n+public class HadoopThread extends Thread {\n+\n+  Subject startSubject;\n+  Runnable hadoopTarget;\n+\n+  public HadoopThread() {\n+    super();\n+  }\n+\n+  public HadoopThread(Runnable target) {\n+    super();\n+    this.hadoopTarget = target;\n+  }\n+\n+  public HadoopThread(ThreadGroup group, Runnable target) {\n+    // The target passed to Thread has no effect, we only pass it\n+    // because there is no super(group) constructor.\n+    super(group, target);\n+    this.hadoopTarget = target;\n+  }\n+\n+  public HadoopThread(Runnable target, String name) {\n+    super(name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  public HadoopThread(String name) {\n+    super(name);\n+  }\n+\n+  public HadoopThread(ThreadGroup group, String name) {\n+    super(group, name);\n+  }\n+\n+  public HadoopThread(ThreadGroup group, Runnable target, String name) {\n+    super(group, name);\n+    this.hadoopTarget = target;\n+  }\n\nReview Comment:\n   IMO that's out of scope for this ticket, @szetszwo .\r\n   \r\n   The current HadoopThread (now renamed to SubjectInheritingThread) intentionally follows the Thread syntax as close as possible for minimum changes in the callers.\r\n   \r\n   Adding a Builder and rewriting everything to use that in this patch would increase the patch size and would be error-prone IMO, while it wouldn't add anything to the Java 25 compatibility.\r\n   \r\n   I think that both a ThreadBuilder (in a separate class to avoid conflicts with the JDK21 native Thread.Builder) and rewriting the run()/work() overriding threads to use Runnables are good improvments, they should handled in a separate JIRA (or maybe even two separate JIRAs).\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-29T04:31:17.781+0000", "updated": "2025-08-29T04:31:17.781+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016924", "id": "18016924", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2309104177\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/HadoopThread.java:\n##########\n@@ -0,0 +1,105 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior after the JEP411/JEP486\n+ * changes\n+ * \n+ * Runnables can be specified normally, but the work() method has to be\n+ * overridden instead of run() when subclassing.\n+ */\n+public class HadoopThread extends Thread {\n+\n+  Subject startSubject;\n+  Runnable hadoopTarget;\n+\n+  public HadoopThread() {\n+    super();\n+  }\n+\n+  public HadoopThread(Runnable target) {\n+    super();\n+    this.hadoopTarget = target;\n+  }\n+\n+  public HadoopThread(ThreadGroup group, Runnable target) {\n+    // The target passed to Thread has no effect, we only pass it\n+    // because there is no super(group) constructor.\n+    super(group, target);\n+    this.hadoopTarget = target;\n+  }\n+\n+  public HadoopThread(Runnable target, String name) {\n+    super(name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  public HadoopThread(String name) {\n+    super(name);\n+  }\n+\n+  public HadoopThread(ThreadGroup group, String name) {\n+    super(group, name);\n+  }\n+\n+  public HadoopThread(ThreadGroup group, Runnable target, String name) {\n+    super(group, name);\n+    this.hadoopTarget = target;\n+  }\n\nReview Comment:\n   IMO that's out of scope for this ticket, @szetszwo .\r\n   \r\n   The current HadoopThread (now renamed to SubjectInheritingThread) intentionally follows the Thread syntax as close as possible for minimum changes in the callers.\r\n   \r\n   Adding a Builder and rewriting everything to use that in this patch would increase the patch size and would be error-prone IMO, while it wouldn't add anything to the Java 25 compatibility.\r\n   \r\n   I think that both a ThreadBuilder (in a separate class to avoid conflicts with the JDK21 native Thread.Builder) and rewriting the run()/work() overriding threads to use Runnables are good improvments, but they should be handled in a separate JIRA (or maybe even two separate JIRAs).\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-29T04:32:36.687+0000", "updated": "2025-08-29T04:32:36.687+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016925", "id": "18016925", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "pan3793 commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3235716054\n\n   The change LGTM. @stoty thank you for such great works!\r\n   \r\n   The current diff is huge, my only suggestion is to extract the `SubjectInheritingThread`, `Daemon`, and related test suites to a dedicated PR after you complete the integration tests. This also benefits future explorers of the Hadoop codebase, I have had many bad experiences in finding the essential changes in a large patch.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-29T04:51:00.675+0000", "updated": "2025-08-29T04:51:00.675+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016973", "id": "18016973", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3236209899\n\n   #7919 is the split PR @pan3793 \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-29T08:34:50.674+0000", "updated": "2025-08-29T08:34:50.674+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016977", "id": "18016977", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "pjfanning commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2309614385\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/SubjectInheritingThread.java:\n##########\n@@ -0,0 +1,148 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior of threads after the\n+ * JEP411/JEP486 changes.\n+ * <p>\n+ * Java propagates the current Subject to any new Threads in all version up to\n+ * Java 21. In Java 22-23 the Subject is only propagated if the SecurityManager\n+ * is enabled, while in Java 24+ it is never propagated.\n+ * <p>\n+ * Hadoop security heavily relies on the original behavior, as Subject is at the\n+ * core of JAAS. This class wraps thread. It overrides start() and saves the\n+ * Subject of the current thread, and wraps the payload in a\n+ * Subject.doAs()/callAs() call to restorere it in the newly created Thread.\n+ * <p>\n+ * When specifying a Runnable, this class is used in exactly the same way as\n+ * Thread.\n+ * <p>\n+ * {@link #run()} cannot be directly overridden, as that would also override the\n+ * subject restoration logic. SubjectInheritingThread provides a {@link work()}\n+ * method instead, which is wrapped and invoked by its own final {@link run()}\n+ * method.\n+ */\n+public class SubjectInheritingThread extends Thread {\n+\n+  private Subject startSubject;\n+  // {@link Thread#target} is private, so we need our own\n+  private Runnable hadoopTarget;\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread()} constructor, but the code to run\n+   * must be specified by overriding the {@link #work()} instead of the {link\n+   * #run()} method.\n+   */\n+  public SubjectInheritingThread() {\n+    super();\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(Runnable)} constructor.\n+   */\n+  public SubjectInheritingThread(Runnable target) {\n+    super();\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(ThreadGroup, Runnable)} constructor.\n\nReview Comment:\n   nit: I think 'Behaves similarly' might be more correct. https://english.stackexchange.com/questions/189825/behaves-similar-to-or-behaves-similarly-to\n\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/SubjectInheritingThread.java:\n##########\n@@ -0,0 +1,148 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior of threads after the\n+ * JEP411/JEP486 changes.\n+ * <p>\n+ * Java propagates the current Subject to any new Threads in all version up to\n+ * Java 21. In Java 22-23 the Subject is only propagated if the SecurityManager\n+ * is enabled, while in Java 24+ it is never propagated.\n+ * <p>\n+ * Hadoop security heavily relies on the original behavior, as Subject is at the\n+ * core of JAAS. This class wraps thread. It overrides start() and saves the\n+ * Subject of the current thread, and wraps the payload in a\n+ * Subject.doAs()/callAs() call to restorere it in the newly created Thread.\n\nReview Comment:\n   typo: should be 'restore'\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-29T09:09:29.757+0000", "updated": "2025-08-29T09:09:29.757+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18016989", "id": "18016989", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3236542982\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |   0m 35s |  |  Docker mode activated.  |\r\n   |||| _ Prechecks _ |\r\n   | +1 :green_heart: |  dupname  |   0m  6s |  |  No case conflicting files found.  |\r\n   | +0 :ok: |  codespell  |   0m  6s |  |  codespell was not available.  |\r\n   | +0 :ok: |  detsecrets  |   0m  6s |  |  detect-secrets was not available.  |\r\n   | +0 :ok: |  shelldocs  |   0m  6s |  |  Shelldocs was not available.  |\r\n   | +1 :green_heart: |  @author  |   0m  0s |  |  The patch does not contain any @author tags.  |\r\n   | +1 :green_heart: |  test4tests  |   0m  0s |  |  The patch appears to include 191 new or modified test files.  |\r\n   |||| _ trunk Compile Tests _ |\r\n   | +0 :ok: |  mvndep  |   9m 35s |  |  Maven dependency ordering for branch  |\r\n   | +1 :green_heart: |  mvninstall  |  32m 44s |  |  trunk passed  |\r\n   | +1 :green_heart: |  compile  |  15m 45s |  |  trunk passed with JDK Ubuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04  |\r\n   | +1 :green_heart: |  compile  |  13m 51s |  |  trunk passed with JDK Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09  |\r\n   | +1 :green_heart: |  checkstyle  |   5m  6s |  |  trunk passed  |\r\n   | +1 :green_heart: |  mvnsite  |  33m 15s |  |  trunk passed  |\r\n   | +1 :green_heart: |  javadoc  |  28m  8s |  |  trunk passed with JDK Ubuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04  |\r\n   | +1 :green_heart: |  javadoc  |  28m 18s |  |  trunk passed with JDK Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09  |\r\n   | +1 :green_heart: |  spotbugs  |  47m 20s |  |  trunk passed  |\r\n   | +1 :green_heart: |  shadedclient  |  37m 50s |  |  branch has no errors when building and testing our client artifacts.  |\r\n   |||| _ Patch Compile Tests _ |\r\n   | +0 :ok: |  mvndep  |   0m 34s |  |  Maven dependency ordering for patch  |\r\n   | +1 :green_heart: |  mvninstall  |  18m 40s |  |  the patch passed  |\r\n   | +1 :green_heart: |  compile  |  15m 10s |  |  the patch passed with JDK Ubuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04  |\r\n   | +1 :green_heart: |  javac  |  15m 10s |  |  the patch passed  |\r\n   | +1 :green_heart: |  compile  |  13m 55s |  |  the patch passed with JDK Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09  |\r\n   | +1 :green_heart: |  javac  |  13m 55s |  |  the patch passed  |\r\n   | -1 :x: |  blanks  |   0m  0s | [/blanks-eol.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/11/artifact/out/blanks-eol.txt) |  The patch has 17 line(s) that end in blanks. Use git apply --whitespace=fix <<patch_file>>. Refer https://git-scm.com/docs/git-apply  |\r\n   | -0 :warning: |  checkstyle  |   5m  1s | [/results-checkstyle-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/11/artifact/out/results-checkstyle-root.txt) |  root: The patch generated 27 new + 6335 unchanged - 17 fixed = 6362 total (was 6352)  |\r\n   | +1 :green_heart: |  mvnsite  |  33m  0s |  |  the patch passed  |\r\n   | +1 :green_heart: |  shellcheck  |   0m  1s |  |  No new issues.  |\r\n   | +1 :green_heart: |  javadoc  |  30m  3s |  |  the patch passed with JDK Ubuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04  |\r\n   | +1 :green_heart: |  javadoc  |  28m 35s |  |  the patch passed with JDK Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09  |\r\n   | +1 :green_heart: |  spotbugs  |  55m  2s |  |  the patch passed  |\r\n   | +1 :green_heart: |  shadedclient  |  36m 17s |  |  patch has no errors when building and testing our client artifacts.  |\r\n   |||| _ Other Tests _ |\r\n   | +1 :green_heart: |  unit  |  23m 35s |  |  hadoop-common in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   3m 57s |  |  hadoop-kms in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   1m 37s |  |  hadoop-registry in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   3m  2s |  |  hadoop-hdfs-client in the patch passed.  |\r\n   | +1 :green_heart: |  unit  | 178m 14s |  |  hadoop-hdfs in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   3m 59s |  |  hadoop-hdfs-nfs in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   6m 15s |  |  hadoop-yarn-common in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   5m  0s |  |  hadoop-yarn-server-common in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   4m 29s |  |  hadoop-yarn-server-applicationhistoryservice in the patch passed.  |\r\n   | -1 :x: |  unit  | 115m  7s | [/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-resourcemanager.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/11/artifact/out/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-resourcemanager.txt) |  hadoop-yarn-server-resourcemanager in the patch failed.  |\r\n   | +1 :green_heart: |  unit  |  27m 31s |  |  hadoop-yarn-server-nodemanager in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |  29m 33s |  |  hadoop-yarn-client in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   9m 40s |  |  hadoop-mapreduce-client-core in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   1m 40s |  |  hadoop-mapreduce-client-common in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   9m 26s |  |  hadoop-mapreduce-client-app in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   4m 45s |  |  hadoop-mapreduce-client-hs in the patch passed.  |\r\n   | -1 :x: |  unit  | 105m 56s | [/patch-unit-hadoop-mapreduce-project_hadoop-mapreduce-client_hadoop-mapreduce-client-jobclient.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/11/artifact/out/patch-unit-hadoop-mapreduce-project_hadoop-mapreduce-client_hadoop-mapreduce-client-jobclient.txt) |  hadoop-mapreduce-client-jobclient in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |  38m 39s |  |  hadoop-distcp in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   2m 55s |  |  hadoop-federation-balance in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |  47m 45s |  |  hadoop-hdfs-rbf in the patch passed.  |\r\n   | -1 :x: |  unit  |  15m 30s | [/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-router.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/11/artifact/out/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-router.txt) |  hadoop-yarn-server-router in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   1m 16s |  |  hadoop-yarn-server-timelineservice-documentstore in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |  22m 50s |  |  hadoop-yarn-applications-distributedshell in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   1m 19s |  |  hadoop-yarn-applications-unmanaged-am-launcher in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |  21m  7s |  |  hadoop-yarn-services-core in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   2m 43s |  |  hadoop-yarn-services-api in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |  11m  2s |  |  hadoop-mapreduce-client-nativetask in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   1m 23s |  |  hadoop-mapreduce-examples in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   7m 33s |  |  hadoop-streaming in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   1m 37s |  |  hadoop-dynamometer-workload in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   1m  4s |  |  hadoop-dynamometer-infra in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |  16m 17s |  |  hadoop-gridmix in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   4m  1s |  |  hadoop-aws in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   3m 36s |  |  hadoop-azure in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   1m 20s |  |  hadoop-resourceestimator in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   5m 44s |  |  hadoop-compat-bench in the patch passed.  |\r\n   | +1 :green_heart: |  asflicense  |   1m 25s |  |  The patch does not generate ASF License warnings.  |\r\n   |  |   | 1244m 47s |  |  |\r\n   \r\n   \r\n   | Reason | Tests |\r\n   |-------:|:------|\r\n   | Failed junit tests | hadoop.mapreduce.v2.TestUberAM |\r\n   |   | hadoop.yarn.server.router.webapp.TestFederationWebApp |\r\n   |   | hadoop.yarn.server.router.subcluster.fair.TestYarnFederationWithFairScheduler |\r\n   |   | hadoop.yarn.server.router.webapp.TestRouterWebServicesREST |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | Docker | ClientAPI=1.51 ServerAPI=1.51 base: https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/11/artifact/out/Dockerfile |\r\n   | GITHUB PR | https://github.com/apache/hadoop/pull/7892 |\r\n   | Optional Tests | dupname asflicense codespell detsecrets shellcheck shelldocs compile javac javadoc mvninstall mvnsite unit shadedclient spotbugs checkstyle |\r\n   | uname | Linux a4ee96e34014 5.15.0-143-generic #153-Ubuntu SMP Fri Jun 13 19:10:45 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux |\r\n   | Build tool | maven |\r\n   | Personality | dev-support/bin/hadoop.sh |\r\n   | git revision | trunk / f6343ab5a51aaf9c6dee5f0d8a17f8b499b960e2 |\r\n   | Default Java | Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09 |\r\n   | Multi-JDK versions | /usr/lib/jvm/java-11-openjdk-amd64:Ubuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04 /usr/lib/jvm/java-8-openjdk-amd64:Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09 |\r\n   |  Test Results | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/11/testReport/ |\r\n   | Max. process+thread count | 3807 (vs. ulimit of 5500) |\r\n   | modules | C: hadoop-common-project/hadoop-common hadoop-common-project/hadoop-kms hadoop-common-project/hadoop-registry hadoop-hdfs-project/hadoop-hdfs-client hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-nfs hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-applicationhistoryservice hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient hadoop-tools/hadoop-distcp hadoop-tools/hadoop-federation-balance hadoop-hdfs-project/hadoop-hdfs-rbf hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-router hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-timelineservice-documentstore hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-unmanaged-am-launcher hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-services/hadoop-yarn-services-core hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-services/hadoop-yarn-services-api hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-nativetask hadoop-mapreduce-project/hadoop-mapreduce-examples hadoop-tools/hadoop-streaming hadoop-tools/hadoop-dynamometer/hadoop-dynamometer-workload hadoop-tools/hadoop-dynamometer/hadoop-dynamometer-infra hadoop-tools/hadoop-gridmix hadoop-tools/hadoop-aws hadoop-tools/hadoop-azure hadoop-tools/hadoop-resourceestimator hadoop-tools/hadoop-compat-bench U: . |\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/11/console |\r\n   | versions | git=2.25.1 maven=3.6.3 spotbugs=4.2.2 shellcheck=0.7.0 |\r\n   | Powered by | Apache Yetus 0.14.1 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-29T10:24:36.030+0000", "updated": "2025-08-29T10:24:36.030+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18017052", "id": "18017052", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2310495424\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/SubjectInheritingThread.java:\n##########\n@@ -0,0 +1,148 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior of threads after the\n+ * JEP411/JEP486 changes.\n+ * <p>\n+ * Java propagates the current Subject to any new Threads in all version up to\n+ * Java 21. In Java 22-23 the Subject is only propagated if the SecurityManager\n+ * is enabled, while in Java 24+ it is never propagated.\n+ * <p>\n+ * Hadoop security heavily relies on the original behavior, as Subject is at the\n+ * core of JAAS. This class wraps thread. It overrides start() and saves the\n+ * Subject of the current thread, and wraps the payload in a\n+ * Subject.doAs()/callAs() call to restorere it in the newly created Thread.\n+ * <p>\n+ * When specifying a Runnable, this class is used in exactly the same way as\n+ * Thread.\n+ * <p>\n+ * {@link #run()} cannot be directly overridden, as that would also override the\n+ * subject restoration logic. SubjectInheritingThread provides a {@link work()}\n+ * method instead, which is wrapped and invoked by its own final {@link run()}\n+ * method.\n+ */\n+public class SubjectInheritingThread extends Thread {\n+\n+  private Subject startSubject;\n+  // {@link Thread#target} is private, so we need our own\n+  private Runnable hadoopTarget;\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread()} constructor, but the code to run\n+   * must be specified by overriding the {@link #work()} instead of the {link\n+   * #run()} method.\n+   */\n+  public SubjectInheritingThread() {\n+    super();\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(Runnable)} constructor.\n+   */\n+  public SubjectInheritingThread(Runnable target) {\n+    super();\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(ThreadGroup, Runnable)} constructor.\n\nReview Comment:\n   Thanks.\r\n   \r\n   Fixed both on #7919 \r\n   \r\n   Let's continue reviewing there.\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-29T15:38:57.956+0000", "updated": "2025-08-29T15:38:57.956+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18017057", "id": "18017057", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3237504090\n\n   Conflict fixed on #7919\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-29T15:53:59.470+0000", "updated": "2025-08-29T15:53:59.470+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18017058", "id": "18017058", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3237513176\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |   0m 57s |  |  Docker mode activated.  |\r\n   |||| _ Prechecks _ |\r\n   | +1 :green_heart: |  dupname  |   0m  6s |  |  No case conflicting files found.  |\r\n   | +0 :ok: |  codespell  |   0m  6s |  |  codespell was not available.  |\r\n   | +0 :ok: |  detsecrets  |   0m  6s |  |  detect-secrets was not available.  |\r\n   | +0 :ok: |  shelldocs  |   0m  6s |  |  Shelldocs was not available.  |\r\n   | +1 :green_heart: |  @author  |   0m  0s |  |  The patch does not contain any @author tags.  |\r\n   | +1 :green_heart: |  test4tests  |   0m  0s |  |  The patch appears to include 191 new or modified test files.  |\r\n   |||| _ trunk Compile Tests _ |\r\n   | +0 :ok: |  mvndep  |   9m 45s |  |  Maven dependency ordering for branch  |\r\n   | +1 :green_heart: |  mvninstall  |  38m 59s |  |  trunk passed  |\r\n   | +1 :green_heart: |  compile  |  18m 26s |  |  trunk passed with JDK Ubuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04  |\r\n   | +1 :green_heart: |  compile  |  16m 20s |  |  trunk passed with JDK Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09  |\r\n   | +1 :green_heart: |  checkstyle  |   6m 37s |  |  trunk passed  |\r\n   | +1 :green_heart: |  mvnsite  |  31m  8s |  |  trunk passed  |\r\n   | +1 :green_heart: |  javadoc  |  27m 26s |  |  trunk passed with JDK Ubuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04  |\r\n   | +1 :green_heart: |  javadoc  |  25m 53s |  |  trunk passed with JDK Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09  |\r\n   | +1 :green_heart: |  spotbugs  |  47m 56s |  |  trunk passed  |\r\n   | +1 :green_heart: |  shadedclient  |  44m  8s |  |  branch has no errors when building and testing our client artifacts.  |\r\n   |||| _ Patch Compile Tests _ |\r\n   | +0 :ok: |  mvndep  |   0m 32s |  |  Maven dependency ordering for patch  |\r\n   | +1 :green_heart: |  mvninstall  |  17m 37s |  |  the patch passed  |\r\n   | +1 :green_heart: |  compile  |  18m 18s |  |  the patch passed with JDK Ubuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04  |\r\n   | +1 :green_heart: |  javac  |  18m 18s |  |  the patch passed  |\r\n   | +1 :green_heart: |  compile  |  17m  9s |  |  the patch passed with JDK Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09  |\r\n   | +1 :green_heart: |  javac  |  17m  9s |  |  the patch passed  |\r\n   | -1 :x: |  blanks  |   0m  0s | [/blanks-eol.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/12/artifact/out/blanks-eol.txt) |  The patch has 11 line(s) that end in blanks. Use git apply --whitespace=fix <<patch_file>>. Refer https://git-scm.com/docs/git-apply  |\r\n   | -0 :warning: |  checkstyle  |   6m 11s | [/results-checkstyle-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/12/artifact/out/results-checkstyle-root.txt) |  root: The patch generated 25 new + 6333 unchanged - 17 fixed = 6358 total (was 6350)  |\r\n   | +1 :green_heart: |  mvnsite  |  31m  1s |  |  the patch passed  |\r\n   | +1 :green_heart: |  shellcheck  |   0m  0s |  |  No new issues.  |\r\n   | -1 :x: |  javadoc  |   1m 14s | [/results-javadoc-javadoc-hadoop-common-project_hadoop-common-jdkUbuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/12/artifact/out/results-javadoc-javadoc-hadoop-common-project_hadoop-common-jdkUbuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04.txt) |  hadoop-common-project_hadoop-common-jdkUbuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04 with JDK Ubuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04 generated 11 new + 0 unchanged - 0 fixed = 11 total (was 0)  |\r\n   | +1 :green_heart: |  javadoc  |  25m 21s |  |  the patch passed with JDK Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09  |\r\n   | +1 :green_heart: |  spotbugs  |  56m 12s |  |  the patch passed  |\r\n   | +1 :green_heart: |  shadedclient  |  43m 38s |  |  patch has no errors when building and testing our client artifacts.  |\r\n   |||| _ Other Tests _ |\r\n   | +1 :green_heart: |  unit  |  23m 17s |  |  hadoop-common in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   3m 50s |  |  hadoop-kms in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   1m 36s |  |  hadoop-registry in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   2m 56s |  |  hadoop-hdfs-client in the patch passed.  |\r\n   | +1 :green_heart: |  unit  | 221m 10s |  |  hadoop-hdfs in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   4m 28s |  |  hadoop-hdfs-nfs in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   6m 23s |  |  hadoop-yarn-common in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   5m 23s |  |  hadoop-yarn-server-common in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   4m 57s |  |  hadoop-yarn-server-applicationhistoryservice in the patch passed.  |\r\n   | -1 :x: |  unit  | 120m 39s | [/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-resourcemanager.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/12/artifact/out/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-resourcemanager.txt) |  hadoop-yarn-server-resourcemanager in the patch failed.  |\r\n   | +1 :green_heart: |  unit  |  28m 11s |  |  hadoop-yarn-server-nodemanager in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |  29m 50s |  |  hadoop-yarn-client in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   9m 28s |  |  hadoop-mapreduce-client-core in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   1m 31s |  |  hadoop-mapreduce-client-common in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   9m 11s |  |  hadoop-mapreduce-client-app in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   4m 35s |  |  hadoop-mapreduce-client-hs in the patch passed.  |\r\n   | -1 :x: |  unit  | 105m 14s | [/patch-unit-hadoop-mapreduce-project_hadoop-mapreduce-client_hadoop-mapreduce-client-jobclient.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/12/artifact/out/patch-unit-hadoop-mapreduce-project_hadoop-mapreduce-client_hadoop-mapreduce-client-jobclient.txt) |  hadoop-mapreduce-client-jobclient in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |  37m 14s |  |  hadoop-distcp in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   3m 15s |  |  hadoop-federation-balance in the patch passed.  |\r\n   | -1 :x: |  unit  |  51m  8s | [/patch-unit-hadoop-hdfs-project_hadoop-hdfs-rbf.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/12/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs-rbf.txt) |  hadoop-hdfs-rbf in the patch passed.  |\r\n   | -1 :x: |  unit  |  15m 37s | [/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-router.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/12/artifact/out/patch-unit-hadoop-yarn-project_hadoop-yarn_hadoop-yarn-server_hadoop-yarn-server-router.txt) |  hadoop-yarn-server-router in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   1m 27s |  |  hadoop-yarn-server-timelineservice-documentstore in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |  22m 50s |  |  hadoop-yarn-applications-distributedshell in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   1m 30s |  |  hadoop-yarn-applications-unmanaged-am-launcher in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |  21m 32s |  |  hadoop-yarn-services-core in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   2m 48s |  |  hadoop-yarn-services-api in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |  11m 35s |  |  hadoop-mapreduce-client-nativetask in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   1m 27s |  |  hadoop-mapreduce-examples in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   7m 43s |  |  hadoop-streaming in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   1m 43s |  |  hadoop-dynamometer-workload in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   1m  8s |  |  hadoop-dynamometer-infra in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |  16m 54s |  |  hadoop-gridmix in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   4m  2s |  |  hadoop-aws in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   3m 48s |  |  hadoop-azure in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   1m 25s |  |  hadoop-resourceestimator in the patch passed.  |\r\n   | +1 :green_heart: |  unit  |   5m 40s |  |  hadoop-compat-bench in the patch passed.  |\r\n   | +1 :green_heart: |  asflicense  |   1m 43s |  |  The patch does not generate ASF License warnings.  |\r\n   |  |   | 1322m 29s |  |  |\r\n   \r\n   \r\n   | Reason | Tests |\r\n   |-------:|:------|\r\n   | Failed junit tests | hadoop.mapreduce.v2.TestUberAM |\r\n   |   | hadoop.hdfs.server.federation.router.TestRouterRpc |\r\n   |   | hadoop.yarn.server.router.subcluster.fair.TestYarnFederationWithFairScheduler |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | Docker | ClientAPI=1.51 ServerAPI=1.51 base: https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/12/artifact/out/Dockerfile |\r\n   | GITHUB PR | https://github.com/apache/hadoop/pull/7892 |\r\n   | Optional Tests | dupname asflicense codespell detsecrets shellcheck shelldocs compile javac javadoc mvninstall mvnsite unit shadedclient spotbugs checkstyle |\r\n   | uname | Linux 9ccc38155578 5.15.0-143-generic #153-Ubuntu SMP Fri Jun 13 19:10:45 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux |\r\n   | Build tool | maven |\r\n   | Personality | dev-support/bin/hadoop.sh |\r\n   | git revision | trunk / 24aefca55cd6ba1d0ad3f16818c88a990268e786 |\r\n   | Default Java | Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09 |\r\n   | Multi-JDK versions | /usr/lib/jvm/java-11-openjdk-amd64:Ubuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04 /usr/lib/jvm/java-8-openjdk-amd64:Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09 |\r\n   |  Test Results | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/12/testReport/ |\r\n   | Max. process+thread count | 3970 (vs. ulimit of 5500) |\r\n   | modules | C: hadoop-common-project/hadoop-common hadoop-common-project/hadoop-kms hadoop-common-project/hadoop-registry hadoop-hdfs-project/hadoop-hdfs-client hadoop-hdfs-project/hadoop-hdfs hadoop-hdfs-project/hadoop-hdfs-nfs hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-common hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-applicationhistoryservice hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-core hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-common hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-hs hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-jobclient hadoop-tools/hadoop-distcp hadoop-tools/hadoop-federation-balance hadoop-hdfs-project/hadoop-hdfs-rbf hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-router hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-timelineservice-documentstore hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-unmanaged-am-launcher hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-services/hadoop-yarn-services-core hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-services/hadoop-yarn-services-api hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-nativetask hadoop-mapreduce-project/hadoop-mapreduce-examples hadoop-tools/hadoop-streaming hadoop-tools/hadoop-dynamometer/hadoop-dynamometer-workload hadoop-tools/hadoop-dynamometer/hadoop-dynamometer-infra hadoop-tools/hadoop-gridmix hadoop-tools/hadoop-aws hadoop-tools/hadoop-azure hadoop-tools/hadoop-resourceestimator hadoop-tools/hadoop-compat-bench U: . |\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/12/console |\r\n   | versions | git=2.25.1 maven=3.6.3 spotbugs=4.2.2 shellcheck=0.7.0 |\r\n   | Powered by | Apache Yetus 0.14.1 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-29T15:57:23.328+0000", "updated": "2025-08-29T15:57:23.328+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18017194", "id": "18017194", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "szetszwo commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2312023633\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/SubjectInheritingThread.java:\n##########\n@@ -0,0 +1,148 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior of threads after the\n+ * JEP411/JEP486 changes.\n+ * <p>\n+ * Java propagates the current Subject to any new Threads in all version up to\n+ * Java 21. In Java 22-23 the Subject is only propagated if the SecurityManager\n+ * is enabled, while in Java 24+ it is never propagated.\n+ * <p>\n+ * Hadoop security heavily relies on the original behavior, as Subject is at the\n+ * core of JAAS. This class wraps thread. It overrides start() and saves the\n+ * Subject of the current thread, and wraps the payload in a\n+ * Subject.doAs()/callAs() call to restorere it in the newly created Thread.\n+ * <p>\n+ * When specifying a Runnable, this class is used in exactly the same way as\n+ * Thread.\n+ * <p>\n+ * {@link #run()} cannot be directly overridden, as that would also override the\n+ * subject restoration logic. SubjectInheritingThread provides a {@link work()}\n+ * method instead, which is wrapped and invoked by its own final {@link run()}\n+ * method.\n+ */\n+public class SubjectInheritingThread extends Thread {\n+\n+  private Subject startSubject;\n+  // {@link Thread#target} is private, so we need our own\n+  private Runnable hadoopTarget;\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread()} constructor, but the code to run\n+   * must be specified by overriding the {@link #work()} instead of the {link\n+   * #run()} method.\n+   */\n+  public SubjectInheritingThread() {\n+    super();\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(Runnable)} constructor.\n+   */\n+  public SubjectInheritingThread(Runnable target) {\n+    super();\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(ThreadGroup, Runnable)} constructor.\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, Runnable target) {\n+    // The target passed to Thread has no effect, we only pass it\n+    // because there is no super(group) constructor.\n+    super(group, target);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(Runnable, String)} constructor.\n+   */\n+  public SubjectInheritingThread(Runnable target, String name) {\n+    super(name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(String)} constructor.\n+   */\n+  public SubjectInheritingThread(String name) {\n+    super(name);\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(ThreadGroup, String)} constructor.\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, String name) {\n+    super(group, name);\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(ThreadGroup, Runnable, String)}\n+   * constructor.\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, Runnable target, String name) {\n+    super(group, name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to pre-Java 22 {@link Thread#start()}. It saves the current\n+   * Subject before starting the new thread, which is then used as the Subject for\n+   * the Runnable or the overridden work() method.\n+   */\n+  @Override\n+  public final void start() {\n+    startSubject = SubjectUtil.current();\n+    super.start();\n+  }\n+\n+  /**\n+   * This is the equivalent of {@link Thread#run()}. Override this instead of\n+   * {@link #run()} Subject will be propagated like in pre-Java 22 Thread.\n+   */\n+  public void work() {\n+    if (hadoopTarget != null) {\n+      hadoopTarget.run();\n+    }\n+  }\n+\n+  /**\n+   * This cannot be overridden in this class. Override the {@link #work()} method\n+   * instead which behaves like pre-Java 22 {@link Thread#run()}\n+   */\n+  @Override\n+  public final void run() {\n+    SubjectUtil.doAs(startSubject, new PrivilegedAction<Void>() {\n\nReview Comment:\n   There is a performance problem in this PR since it makes all the threads calling `doAs`.  For pre-Java 22, it will hurt the performance.\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-08-30T16:59:01.025+0000", "updated": "2025-08-30T16:59:01.025+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18017449", "id": "18017449", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2313987803\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/SubjectInheritingThread.java:\n##########\n@@ -0,0 +1,148 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior of threads after the\n+ * JEP411/JEP486 changes.\n+ * <p>\n+ * Java propagates the current Subject to any new Threads in all version up to\n+ * Java 21. In Java 22-23 the Subject is only propagated if the SecurityManager\n+ * is enabled, while in Java 24+ it is never propagated.\n+ * <p>\n+ * Hadoop security heavily relies on the original behavior, as Subject is at the\n+ * core of JAAS. This class wraps thread. It overrides start() and saves the\n+ * Subject of the current thread, and wraps the payload in a\n+ * Subject.doAs()/callAs() call to restorere it in the newly created Thread.\n+ * <p>\n+ * When specifying a Runnable, this class is used in exactly the same way as\n+ * Thread.\n+ * <p>\n+ * {@link #run()} cannot be directly overridden, as that would also override the\n+ * subject restoration logic. SubjectInheritingThread provides a {@link work()}\n+ * method instead, which is wrapped and invoked by its own final {@link run()}\n+ * method.\n+ */\n+public class SubjectInheritingThread extends Thread {\n+\n+  private Subject startSubject;\n+  // {@link Thread#target} is private, so we need our own\n+  private Runnable hadoopTarget;\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread()} constructor, but the code to run\n+   * must be specified by overriding the {@link #work()} instead of the {link\n+   * #run()} method.\n+   */\n+  public SubjectInheritingThread() {\n+    super();\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(Runnable)} constructor.\n+   */\n+  public SubjectInheritingThread(Runnable target) {\n+    super();\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(ThreadGroup, Runnable)} constructor.\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, Runnable target) {\n+    // The target passed to Thread has no effect, we only pass it\n+    // because there is no super(group) constructor.\n+    super(group, target);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(Runnable, String)} constructor.\n+   */\n+  public SubjectInheritingThread(Runnable target, String name) {\n+    super(name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(String)} constructor.\n+   */\n+  public SubjectInheritingThread(String name) {\n+    super(name);\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(ThreadGroup, String)} constructor.\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, String name) {\n+    super(group, name);\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(ThreadGroup, Runnable, String)}\n+   * constructor.\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, Runnable target, String name) {\n+    super(group, name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to pre-Java 22 {@link Thread#start()}. It saves the current\n+   * Subject before starting the new thread, which is then used as the Subject for\n+   * the Runnable or the overridden work() method.\n+   */\n+  @Override\n+  public final void start() {\n+    startSubject = SubjectUtil.current();\n+    super.start();\n+  }\n+\n+  /**\n+   * This is the equivalent of {@link Thread#run()}. Override this instead of\n+   * {@link #run()} Subject will be propagated like in pre-Java 22 Thread.\n+   */\n+  public void work() {\n+    if (hadoopTarget != null) {\n+      hadoopTarget.run();\n+    }\n+  }\n+\n+  /**\n+   * This cannot be overridden in this class. Override the {@link #work()} method\n+   * instead which behaves like pre-Java 22 {@link Thread#run()}\n+   */\n+  @Override\n+  public final void run() {\n+    SubjectUtil.doAs(startSubject, new PrivilegedAction<Void>() {\n\nReview Comment:\n   I think that's neglible compared to the cost of creating a new thread, but I added a new commit to avoid it if possible, @szetszwo .\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-01T13:37:11.198+0000", "updated": "2025-09-01T13:37:11.198+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18017452", "id": "18017452", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2313987803\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/SubjectInheritingThread.java:\n##########\n@@ -0,0 +1,148 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior of threads after the\n+ * JEP411/JEP486 changes.\n+ * <p>\n+ * Java propagates the current Subject to any new Threads in all version up to\n+ * Java 21. In Java 22-23 the Subject is only propagated if the SecurityManager\n+ * is enabled, while in Java 24+ it is never propagated.\n+ * <p>\n+ * Hadoop security heavily relies on the original behavior, as Subject is at the\n+ * core of JAAS. This class wraps thread. It overrides start() and saves the\n+ * Subject of the current thread, and wraps the payload in a\n+ * Subject.doAs()/callAs() call to restorere it in the newly created Thread.\n+ * <p>\n+ * When specifying a Runnable, this class is used in exactly the same way as\n+ * Thread.\n+ * <p>\n+ * {@link #run()} cannot be directly overridden, as that would also override the\n+ * subject restoration logic. SubjectInheritingThread provides a {@link work()}\n+ * method instead, which is wrapped and invoked by its own final {@link run()}\n+ * method.\n+ */\n+public class SubjectInheritingThread extends Thread {\n+\n+  private Subject startSubject;\n+  // {@link Thread#target} is private, so we need our own\n+  private Runnable hadoopTarget;\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread()} constructor, but the code to run\n+   * must be specified by overriding the {@link #work()} instead of the {link\n+   * #run()} method.\n+   */\n+  public SubjectInheritingThread() {\n+    super();\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(Runnable)} constructor.\n+   */\n+  public SubjectInheritingThread(Runnable target) {\n+    super();\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(ThreadGroup, Runnable)} constructor.\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, Runnable target) {\n+    // The target passed to Thread has no effect, we only pass it\n+    // because there is no super(group) constructor.\n+    super(group, target);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(Runnable, String)} constructor.\n+   */\n+  public SubjectInheritingThread(Runnable target, String name) {\n+    super(name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(String)} constructor.\n+   */\n+  public SubjectInheritingThread(String name) {\n+    super(name);\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(ThreadGroup, String)} constructor.\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, String name) {\n+    super(group, name);\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(ThreadGroup, Runnable, String)}\n+   * constructor.\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, Runnable target, String name) {\n+    super(group, name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to pre-Java 22 {@link Thread#start()}. It saves the current\n+   * Subject before starting the new thread, which is then used as the Subject for\n+   * the Runnable or the overridden work() method.\n+   */\n+  @Override\n+  public final void start() {\n+    startSubject = SubjectUtil.current();\n+    super.start();\n+  }\n+\n+  /**\n+   * This is the equivalent of {@link Thread#run()}. Override this instead of\n+   * {@link #run()} Subject will be propagated like in pre-Java 22 Thread.\n+   */\n+  public void work() {\n+    if (hadoopTarget != null) {\n+      hadoopTarget.run();\n+    }\n+  }\n+\n+  /**\n+   * This cannot be overridden in this class. Override the {@link #work()} method\n+   * instead which behaves like pre-Java 22 {@link Thread#run()}\n+   */\n+  @Override\n+  public final void run() {\n+    SubjectUtil.doAs(startSubject, new PrivilegedAction<Void>() {\n\nReview Comment:\n   I think that's neglible compared to the cost of creating a new thread, but I added a new commit to avoid it if possible, @szetszwo .\r\n   \r\n   Please check #7892 7919\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-01T13:39:52.403+0000", "updated": "2025-09-01T13:39:52.403+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18017455", "id": "18017455", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3242441698\n\n   > @stoty , thanks for the update!\r\n   > \r\n   > > The current HadoopThread (now renamed to SubjectInheritingThread) intentionally follows the Thread syntax as close as possible for minimum changes in the callers.\r\n   > \r\n   > In this patch, we are changing\r\n   > \r\n   > * `new Thread(..)` -> `new SubjectInheritingThread(..)`\r\n   > \r\n   > My suggestion is to change\r\n   > \r\n   > * `new Thread(..)` -> `new SubjectInheritingThread.newBuilder()...build()`\r\n   > \r\n   > If we do it in separated JIRAs, we will need to rewrite the almost all code this PR.\r\n   \r\n   Unfortunately, that would only handle less than half of the thread creations.\r\n   \r\n   You cannot override the run() / work() method if you use a factory.\r\n   We'd have to convert the run()/work() overrides to Runnables as well, and that cannot be handled by a simple search and replace.\r\n   \r\n   This patch is huge enough as is.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-01T13:44:26.667+0000", "updated": "2025-09-01T13:44:26.667+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18017457", "id": "18017457", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2313987803\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/SubjectInheritingThread.java:\n##########\n@@ -0,0 +1,148 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior of threads after the\n+ * JEP411/JEP486 changes.\n+ * <p>\n+ * Java propagates the current Subject to any new Threads in all version up to\n+ * Java 21. In Java 22-23 the Subject is only propagated if the SecurityManager\n+ * is enabled, while in Java 24+ it is never propagated.\n+ * <p>\n+ * Hadoop security heavily relies on the original behavior, as Subject is at the\n+ * core of JAAS. This class wraps thread. It overrides start() and saves the\n+ * Subject of the current thread, and wraps the payload in a\n+ * Subject.doAs()/callAs() call to restorere it in the newly created Thread.\n+ * <p>\n+ * When specifying a Runnable, this class is used in exactly the same way as\n+ * Thread.\n+ * <p>\n+ * {@link #run()} cannot be directly overridden, as that would also override the\n+ * subject restoration logic. SubjectInheritingThread provides a {@link work()}\n+ * method instead, which is wrapped and invoked by its own final {@link run()}\n+ * method.\n+ */\n+public class SubjectInheritingThread extends Thread {\n+\n+  private Subject startSubject;\n+  // {@link Thread#target} is private, so we need our own\n+  private Runnable hadoopTarget;\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread()} constructor, but the code to run\n+   * must be specified by overriding the {@link #work()} instead of the {link\n+   * #run()} method.\n+   */\n+  public SubjectInheritingThread() {\n+    super();\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(Runnable)} constructor.\n+   */\n+  public SubjectInheritingThread(Runnable target) {\n+    super();\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(ThreadGroup, Runnable)} constructor.\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, Runnable target) {\n+    // The target passed to Thread has no effect, we only pass it\n+    // because there is no super(group) constructor.\n+    super(group, target);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(Runnable, String)} constructor.\n+   */\n+  public SubjectInheritingThread(Runnable target, String name) {\n+    super(name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(String)} constructor.\n+   */\n+  public SubjectInheritingThread(String name) {\n+    super(name);\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(ThreadGroup, String)} constructor.\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, String name) {\n+    super(group, name);\n+  }\n+\n+  /**\n+   * Behaves similar to {@link Thread#Thread(ThreadGroup, Runnable, String)}\n+   * constructor.\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, Runnable target, String name) {\n+    super(group, name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similar to pre-Java 22 {@link Thread#start()}. It saves the current\n+   * Subject before starting the new thread, which is then used as the Subject for\n+   * the Runnable or the overridden work() method.\n+   */\n+  @Override\n+  public final void start() {\n+    startSubject = SubjectUtil.current();\n+    super.start();\n+  }\n+\n+  /**\n+   * This is the equivalent of {@link Thread#run()}. Override this instead of\n+   * {@link #run()} Subject will be propagated like in pre-Java 22 Thread.\n+   */\n+  public void work() {\n+    if (hadoopTarget != null) {\n+      hadoopTarget.run();\n+    }\n+  }\n+\n+  /**\n+   * This cannot be overridden in this class. Override the {@link #work()} method\n+   * instead which behaves like pre-Java 22 {@link Thread#run()}\n+   */\n+  @Override\n+  public final void run() {\n+    SubjectUtil.doAs(startSubject, new PrivilegedAction<Void>() {\n\nReview Comment:\n   I think that's neglible compared to the cost of creating a new thread, but I added a new commit to avoid it if possible, @szetszwo .\r\n   \r\n   Please check #7919\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-01T13:47:21.653+0000", "updated": "2025-09-01T13:47:21.653+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18017718", "id": "18017718", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "szetszwo commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3246043904\n\n   > You cannot override the run() / work() method if you use a factory.\r\n   \r\n   @stoty , builder is more flexible than constructors.  We definitely can override method as today. \r\n   ```java\r\n   //TestByteArrayManager\r\n     static class AllocatorThread extends Thread {\r\n   ```\r\n   \r\n   ```java\r\n   // existing code\r\n           final AllocatorThread t = new AllocatorThread(arrayLength, bam);\r\n   ```\r\n   Instead of call `new AllocatorThread(..)` above, we will have\r\n   ```java\r\n   // new code\r\n           final Thread t =  SubjectInheritingThread.newBuilder()\r\n               .setThread(new AllocatorThread(arrayLength, bam))\r\n               .build();\r\n   ```\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-02T16:34:14.108+0000", "updated": "2025-09-02T16:34:14.108+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18017896", "id": "18017896", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3249122071\n\n   I spent some time trying to implement that @szetszwo .\r\n   \r\n   At the core, we'd need a wrapper like this:\r\n   \r\n   ` \r\n     public static class SubjectInheritingWrapper extends Thread {\r\n   \r\n       private Thread wrapped;\r\n       private Subject startSubject;\r\n   \r\n       public SubjectInheritingWrapper(Thread wrapped) {\r\n         this.wrapped = wrapped;\r\n       }\r\n   \r\n       @Override\r\n       public synchronized void start() {\r\n         startSubject = SubjectUtil.current();\r\n         wrapped.start();\r\n       }\r\n   \r\n       @Override\r\n       public final void run() {\r\n         SubjectUtil.doAs(startSubject, new PrivilegedAction<Void>() {\r\n   \r\n           @Override\r\n           public Void run() {\r\n             wrapped.run();\r\n             return null;\r\n           }\r\n   \r\n         });\r\n       }\r\n       \r\n       public void interrupt() {\r\n         wrapped.interrupt();\r\n       }\r\n       \r\n       public boolean isInterrupted() {\r\n         return wrapped.isInterrupted();\r\n       }\r\n       \r\n       // setDaemon is final!!!\r\n       public void setDaemon()...\r\n     }`\r\n     \r\n   run() and start() are wrappable, but Thread is full of **final** methods which cannot be overriden, and would not work on the wrapper (which is never actually started, only the wrapped thread is).\r\n   \r\n   Say, we want to call setDaemon() on the wrapper. Since we cannot override it, it would set the daemon flag on the wrapper, not the wrapped thread, which is never even start() ed , and wouldn't work.\r\n   \r\n   So a wrapper like this would invisibly break the Thread contract in many ways.\r\n   I don't think it's worth the risk of the hidden bugs that this could cause.\r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-03T12:50:47.966+0000", "updated": "2025-09-03T12:50:47.966+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18017950", "id": "18017950", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "szetszwo commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3250102379\n\n   @stoty , thanks for trying it out!  The code should look like below:\r\n   ```java\r\n   public class SubjectDoAsThread extends Thread {\r\n     private final Runnable runnable;\r\n     private Subject startSubject;\r\n   \r\n     public static class Builder {\r\n       private ThreadGroup group;\r\n       private String name;\r\n       private Runnable runnable;\r\n   \r\n       public Builder setThread(Thread thread) {\r\n         this.group = thread.getThreadGroup();\r\n         this.name = thread.getName();\r\n         this.runnable = thread;\r\n         return this;\r\n       }\r\n   \r\n       public SubjectDoAsThread build() {\r\n         return new SubjectDoAsThread(group, name, runnable);\r\n       }\r\n     }\r\n   \r\n     private SubjectDoAsThread(ThreadGroup group, String name, Runnable runnable) {\r\n       super(group, name);\r\n       this.runnable = Objects.requireNonNull(runnable, \"runnable == null\");\r\n     }\r\n   \r\n     @Override\r\n     public final void start() {\r\n       startSubject = SubjectUtil.current();\r\n       super.start();\r\n     }\r\n   \r\n     @Override\r\n     public final void run() {\r\n       SubjectUtil.doAs(startSubject, (PrivilegedAction<Void>) () -> {\r\n         runnable.run();\r\n         return null;\r\n       });\r\n     }\r\n   }\r\n   ```\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-03T17:15:47.222+0000", "updated": "2025-09-03T17:15:47.222+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18018114", "id": "18018114", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3253524501\n\n   That looks like it could work @szetszwo .\r\n   \r\n   There is still the issue that if there is any logic in the wrapped Thread's start() method, then it won't be run,\r\n   but we can document that (and the current SubjectInheritingThread also makes that final, so we know that none of the Threads in Hadoop does that)\r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-04T12:43:37.364+0000", "updated": "2025-09-04T12:43:37.364+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18019150", "id": "18019150", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3270609216\n\n   I've spent some more tim on this @szetszwo , and I am even more convinced that using the Builder approach is NOT a good universal solution.\r\n   \r\n   I've implemented something close to your example above, then I randomy chose org.apache.hadoop.hdfs.server.namenode.ha.EditLogTailer to test it.\r\n   \r\n   Two problems became immediately apparent with the builder approach: \r\n   \r\n   1. EditLogTailerThread has an internal state and a setShouldRun() method to set it. This immediately makes the Builder approach you've shown a non-starter, as the thread created by the Builder is of a different Type, and does not have a setShouldRun()  method (nor the required internal state)\r\n   \r\n   2. An EditLogTailerThread member is defined in the class. Even if we could get away with changing the type (which in many cases we can do), we'd still have to either\r\n   a.) change the type to Thread, thereby weakening the type checks\r\n   b.) add another member for the wrapped thread, in which case we need go over the code, and carefully check which member we need to use where, adding a lot of possibilities for mistakes.\r\n   \r\n   That means that only the Threads which set a Runner can be converted easily, the ones which subclass Thread would need to be evaulated on a case-by-case basis, which is exactly what I don't want to do due to both the time requirement and the error-prone nature of the process.\r\n   \r\n   @pan3793 @slfan1989 @jojochuang @cnauroth @steveloughran @Hexiaoqiao @ayushtkn @szetszwo \r\n   \r\n   Please review the current state of #7919 which is the same patch as this split into three and with some minor improvements.\r\n   \r\n   My plan is to rebase/reorder the #7919  . Please check #7919\r\n   \r\n    * Do you think we should implement and use Thread Builder approach in this patch ? (see my reservations above)\r\n    * Is the way I split the patch acceptable (patches without JIRA id will be merged into the other ones)\r\n    * What other changes (if any) do you think are necessary for patch to be accepted M\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-09T12:52:57.796+0000", "updated": "2025-09-09T12:52:57.796+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18019212", "id": "18019212", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "szetszwo commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3271843449\n\n   @stoty , the code will look like below:\r\n   ```diff\r\n   diff --git a/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/ha/EditLogTailer.java b/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/ha/EditLogTailer.java\r\n   index cf416307f47..3260b770ac0 100644\r\n   -", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-09T18:32:21.553+0000", "updated": "2025-09-09T18:32:21.553+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18019288", "id": "18019288", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "slfan1989 commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3273390158\n\n   @stoty Thank you for your contribution! However, I may not be able to thoroughly review this PR until next Monday or Tuesday.\r\n   \r\n   Currently, the JUnit 5 upgrade for the HDFS module has been mostly completed. I'm now working on completely removing the dependency on JUnit 4 from the trunk branch of the Hadoop project. This may take some time, as there are still a few missing pieces that need to be fixed.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-10T05:38:53.197+0000", "updated": "2025-09-10T05:38:53.197+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18019289", "id": "18019289", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "pan3793 commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3273429535\n\n   > Do you think we should implement and use Thread Builder approach in this patch ? (see my reservations above)\r\n   \r\n   I think introducing Builder here is a kind of overdesign. @szetszwo do you have cases in your mind that can not be covered by @stoty's approach? If not, I strongly support @stoty's approach.\r\n   \r\n   > Is the way I split the patch acceptable (patches without JIRA id will be merged into the other ones)\r\n   \r\n   Thanks for splitting! I think HADOOP-19668 and HADOOP-19669 can be committed together; the current state is also fine.\r\n   \r\n   > What other changes (if any) do you think are necessary for patch to be accepted?\r\n   \r\n   I think it's already in good shape.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-10T06:01:34.325+0000", "updated": "2025-09-10T06:01:34.325+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18019298", "id": "18019298", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3273592159\n\n   Yes, the solution you propose works @szetszwo , but it's more complex and error-prone ot implement than the current one.\r\n   \r\n   Now we are juggling two thread objects, and it is very easy to start the wrong one, especially when you're converting hundreds of threads.\r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-10T07:03:34.715+0000", "updated": "2025-09-10T07:03:34.715+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18019759", "id": "18019759", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "slfan1989 commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3283565732\n\n   @stoty I\u2019d like to confirm with you whether you\u2019d prefer us to create a separate development branch for you.\r\n   \r\n   Pan and I had an offline discussion on this topic. He believes the changes are manageable and therefore a separate branch may not be necessary. I think his point makes sense to some extent, but from the perspective of development efficiency and risk control, I would still recommend creating a dedicated development branch. This would allow us to iterate more quickly without impacting existing functionality.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-12T04:01:09.518+0000", "updated": "2025-09-12T04:01:09.518+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18019765", "id": "18019765", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3283717527\n\n   > @stoty I\u2019d like to confirm with you whether you\u2019d prefer us to create a separate development branch for you.\r\n   > \r\n   > Pan and I had an offline discussion on this topic. He believes the changes are manageable and therefore a separate branch may not be necessary. I think his point makes sense to some extent, but from the perspective of development efficiency and risk control, I would still recommend creating a dedicated development branch. This would allow us to iterate more quickly without impacting existing functionality.\r\n   \r\n   I don't think a separate branch is necessary, @slfan1989 .\r\n   \r\n   These changes are designed to be transparent, especially now that we've added a shortcut to avoid the subject manipulation for Java 21 and earlier, as suggested by @szetszwo .\r\n   \r\n   IF this breaks anything, we can find and fix that faster once it's in trunk.\r\n   \r\n   Any changes affecting Java 8/11 will be causght by the existing CI processes, and we can also start work on setting up CI for Java 17/21/25 and start working out any such issues.\r\n   \r\n   Users will alse have an easier time testing Hadoop with Java 21/25 in their use cases once it's supported on trunk.\r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-12T05:25:06.203+0000", "updated": "2025-09-12T05:25:06.203+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18019766", "id": "18019766", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3283724388\n\n   A related question @slfan1989 :\r\n   What is current stance on dropping pre Java 17 support from trunk ?\r\n   That would allow freeing up CI resources, and start migrating off problematic old component versions like Jetty 9.4.\r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-12T05:27:10.575+0000", "updated": "2025-09-12T05:27:10.575+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18019772", "id": "18019772", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "slfan1989 commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3283808201\n\n   > > @stoty I\u2019d like to confirm with you whether you\u2019d prefer us to create a separate development branch for you.\r\n   > > Pan and I had an offline discussion on this topic. He believes the changes are manageable and therefore a separate branch may not be necessary. I think his point makes sense to some extent, but from the perspective of development efficiency and risk control, I would still recommend creating a dedicated development branch. This would allow us to iterate more quickly without impacting existing functionality.\r\n   > \r\n   > I don't think a separate branch is necessary, @slfan1989 .\r\n   > \r\n   > These changes are designed to be transparent, especially now that we've added a shortcut to avoid the subject manipulation for Java 21 and earlier, as suggested by @szetszwo .\r\n   > \r\n   > IF this breaks anything, we can find and fix that faster once it's in trunk.\r\n   > \r\n   > Any changes affecting Java 8/11 will be causght by the existing CI processes, and we can also start work on setting up CI for Java 17/21/25 and start working out any such issues.\r\n   > \r\n   > Users will alse have an easier time testing Hadoop with Java 21/25 in their use cases once it's supported on trunk.\r\n   \r\n   @stoty Thank you for your reply, and also for your efforts in driving the Java 22+ upgrade. I hope the work goes smoothly, and I'll do my best to support it.\r\n   \r\n   \r\n   >> A related question @slfan1989 :\r\n   >> What is current stance on dropping pre Java 17 support from trunk ?\r\n   >> That would allow freeing up CI resources, and start migrating off problematic old component versions like Jetty 9.4.\r\n   \r\n   From my understanding, the trunk branch will soon drop support for Java 8 and Java 11, and move forward with Java 17 as the new baseline for development. We also plan to finalize the release scope of Hadoop 3.5 as soon as possible and initiate the corresponding release process.\r\n   \r\n   As for CI support for Java 21 and above, further discussion may be needed. I plan to respond to the previous DISCUSS thread early next week and continue driving the related efforts. In the meantime, input and suggestions from other community members would be very welcome.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-12T05:53:20.808+0000", "updated": "2025-09-12T05:53:20.808+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18020348", "id": "18020348", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "pan3793 commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3292055686\n\n   Kindly ping @szetszwo @steveloughran @cnauroth \r\n   \r\n   We need a final decision here. I think these two approaches are just different programming patterns, with no essential functionality difference. Java 25 is coming (scheduled on Sept 26, 2025), and I am eager for a Java 25-compatible Hadoop client to unblock downstream projects to support Java 25.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-15T13:00:46.997+0000", "updated": "2025-09-15T13:00:46.997+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18020435", "id": "18020435", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "szetszwo commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3293346778\n\n   @stoty , @pan3793 , Honestly, I do prefer adding a builder instead of having multiple constructors with different parameter combinations.  Also, a builder can build subclasses but constructors can't.\r\n   \r\n   In addition, extending the `Thread` class is not a good practice ", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-15T18:04:56.104+0000", "updated": "2025-09-15T18:04:56.104+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18021818", "id": "18021818", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3318003132\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |   0m  0s |  |  Docker mode activated.  |\r\n   | -1 :x: |  patch  |   0m 24s |  |  https://github.com/apache/hadoop/pull/7892 does not apply to trunk. Rebase required? Wrong Branch? See https://cwiki.apache.org/confluence/display/HADOOP/How+To+Contribute for help.  |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/14/console |\r\n   | versions | git=2.34.1 |\r\n   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-22T10:10:48.505+0000", "updated": "2025-09-22T10:10:48.505+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18021819", "id": "18021819", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3318006060\n\n   I have overwritten this PR with the split one, and rebased it to current trunk.\r\n   This is now the same as #7919 but without the Yetus changes for test enablement.\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-22T10:11:14.128+0000", "updated": "2025-09-22T10:11:14.128+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18024118", "id": "18024118", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "steveloughran commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2395491126\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/Shell.java:\n##########\n@@ -36,6 +36,7 @@\n import java.util.concurrent.atomic.AtomicBoolean;\n \n import org.apache.hadoop.classification.VisibleForTesting;\n+import org.apache.hadoop.util.concurrent.SubjectInheritingThread;\n\nReview Comment:\n   nit: import ordering\n\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/BlockingThreadPoolExecutorService.java:\n##########\n@@ -71,7 +72,7 @@ static ThreadFactory getNamedThreadFactory(final String prefix) {\n       public Thread newThread(Runnable r) {\n         final String name =\n             prefix + \"-pool\" + poolNum + \"-t\" + threadNumber.getAndIncrement();\n-        return new Thread(group, r, name);\n+        return new SubjectInheritingThread(group, r, name);\n\nReview Comment:\n   nice. I was wondering about this\n\n\n\n##########\nhadoop-common-project/hadoop-auth/src/main/java/org/apache/hadoop/security/authentication/util/SubjectUtil.java:\n##########\n@@ -71,6 +78,23 @@ private static MethodHandle lookupCallAs() {\n     }\n   }\n \n+  private static boolean checkThreadInheritsSubject() {\n\nReview Comment:\n   nit, javadoc\n\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/SubjectInheritingThread.java:\n##########\n@@ -0,0 +1,212 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior of threads after the\n+ * JEP411/JEP486 changes.\n+ * <p>\n+ * Java propagates the current Subject to any new Threads in all version up to\n+ * Java 21. In Java 22-23 the Subject is only propagated if the SecurityManager\n+ * is enabled, while in Java 24+ it is never propagated.\n+ * <p>\n+ * Hadoop security heavily relies on the original behavior, as Subject is at the\n+ * core of JAAS. This class wraps thread. It overrides start() and saves the\n+ * Subject of the current thread, and wraps the payload in a\n+ * Subject.doAs()/callAs() call to restore it in the newly created Thread.\n+ * <p>\n+ * When specifying a Runnable, this class is used in exactly the same way as\n+ * Thread.\n+ * <p>\n+ * {@link #run()} cannot be directly overridden, as that would also override the\n+ * subject restoration logic. SubjectInheritingThread provides a {@link work()}\n+ * method instead, which is wrapped and invoked by its own final {@link run()}\n+ * method.\n+ */\n+public class SubjectInheritingThread extends Thread {\n+\n+  private Subject startSubject;\n+  // {@link Thread#target} is private, so we need our own\n+  private Runnable hadoopTarget;\n+\n+  /**\n+   * Behaves similarly to {@link Thread#Thread()} constructor, but the code to run\n+   * must be specified by overriding the {@link #work()} instead of the {link\n+   * #run()} method.\n+   */\n+  public SubjectInheritingThread() {\n+    super();\n+  }\n+\n+  /**\n+   * Behaves similarly to {@link Thread#Thread(Runnable)} constructor.\n+   *\n+   * @param target the object whose {@code run} method is invoked when this thread\n+   *               is started. If {@code null}, this classes {@code run} method\n+   *               does nothing.\n+   */\n+  public SubjectInheritingThread(Runnable target) {\n+    super();\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similarly to {@link Thread#Thread(ThreadGroup, Runnable)}\n+   * constructor.\n+   *\n+   * @param group  the thread group. If {@code null} and there is a security\n+   *               manager, the group is determined by\n+   *               {@linkplain SecurityManager#getThreadGroup\n+   *               SecurityManager.getThreadGroup()}. If there is not a security\n+   *               manager or {@code\n+   *         SecurityManager.getThreadGroup()} returns {@code null}, the group is\n+   *               set to the current thread's thread group.\n+   *\n+   * @param target the object whose {@code run} method is invoked when this thread\n+   *               is started. If {@code null}, this thread's run method is\n+   *               invoked.\n+   * @throws SecurityException if the current thread cannot create a thread in the\n+   *                           specified thread group\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, Runnable target) {\n+    // The target passed to Thread has no effect, we only pass it\n+    // because there is no super(group) constructor.\n+    super(group, target);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similarly to {@link Thread#Thread(Runnable, String)} constructor.\n+   *\n+   * @param target the object whose {@code run} method is invoked when this thread\n+   *               is started. If {@code null}, this thread's run method is\n+   *               invoked.\n+   *\n+   * @param name   the name of the new thread\n+   *\n+   * @throws SecurityException if the current thread cannot create a thread in the\n+   *                           specified thread group\n+   */\n+  public SubjectInheritingThread(Runnable target, String name) {\n+    super(name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similarly to {@link Thread#Thread(String)} constructor.\n+   *\n+   * @param name the name of the new thread\n+   */\n+  public SubjectInheritingThread(String name) {\n+    super(name);\n+  }\n+\n+  /**\n+   * Behaves similarly to {@link Thread#Thread(ThreadGroup, String)} constructor.\n+   *\n+   * @param group the thread group. If {@code null} and there is a security\n+   *              manager, the group is determined by\n+   *              {@linkplain SecurityManager#getThreadGroup\n+   *              SecurityManager.getThreadGroup()}. If there is not a security\n+   *              manager or {@code\n+   *         SecurityManager.getThreadGroup()} returns {@code null}, the group is\n+   *              set to the current thread's thread group.\n+   *\n+   * @param name  the name of the new thread\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, String name) {\n+    super(group, name);\n+  }\n+\n+  /**\n+   * Behaves similarly to {@link Thread#Thread(ThreadGroup, Runnable, String)}\n+   * constructor.\n+   *\n+   * @param group  the thread group. If {@code null} and there is a security\n+   *               manager, the group is determined by\n+   *               {@linkplain SecurityManager#getThreadGroup\n+   *               SecurityManager.getThreadGroup()}. If there is not a security\n+   *               manager or {@code\n+   *         SecurityManager.getThreadGroup()} returns {@code null}, the group is\n+   *               set to the current thread's thread group.\n+   *\n+   * @param target the object whose {@code run} method is invoked when this thread\n+   *               is started. If {@code null}, this thread's run method is\n+   *               invoked.\n+   *\n+   * @param name   the name of the new thread\n+   *\n+   * @throws SecurityException if the current thread cannot create a thread in the\n+   *                           specified thread group or cannot override the\n+   *                           context class loader methods.\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, Runnable target, String name) {\n+    super(group, name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similarly to pre-Java 22 {@link Thread#start()}. It saves the current\n+   * Subject before starting the new thread, which is then used as the Subject for\n+   * the Runnable or the overridden work() method.\n+   */\n+  @Override\n+  public final void start() {\n+    if (!SubjectUtil.THREAD_INHERITS_SUBJECT) {\n+      startSubject = SubjectUtil.current();\n+    }\n+    super.start();\n+  }\n+\n+  /**\n+   * This is the equivalent of {@link Thread#run()}. Override this instead of\n+   * {@link #run()} Subject will be propagated like in pre-Java 22 Thread.\n+   */\n+  public void work() {\n\nReview Comment:\n   PITA having to rename all uses, but I can't see any other workaround\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-01T18:39:00.143+0000", "updated": "2025-10-01T18:39:00.143+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18024224", "id": "18024224", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2397492789\n\n\n##########\nhadoop-common-project/hadoop-auth/src/main/java/org/apache/hadoop/security/authentication/util/SubjectUtil.java:\n##########\n@@ -71,6 +78,23 @@ private static MethodHandle lookupCallAs() {\n     }\n   }\n \n+  private static boolean checkThreadInheritsSubject() {\n\nReview Comment:\n   Added javadoc\n\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/Shell.java:\n##########\n@@ -36,6 +36,7 @@\n import java.util.concurrent.atomic.AtomicBoolean;\n \n import org.apache.hadoop.classification.VisibleForTesting;\n+import org.apache.hadoop.util.concurrent.SubjectInheritingThread;\n\nReview Comment:\n   Fixed\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-02T07:35:47.215+0000", "updated": "2025-10-02T07:35:47.215+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18024228", "id": "18024228", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on code in PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#discussion_r2397515970\n\n\n##########\nhadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/util/concurrent/SubjectInheritingThread.java:\n##########\n@@ -0,0 +1,212 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.util.concurrent;\n+\n+import java.security.PrivilegedAction;\n+import javax.security.auth.Subject;\n+\n+import org.apache.hadoop.security.authentication.util.SubjectUtil;\n+\n+/**\n+ * Helper class to restore Subject propagation behavior of threads after the\n+ * JEP411/JEP486 changes.\n+ * <p>\n+ * Java propagates the current Subject to any new Threads in all version up to\n+ * Java 21. In Java 22-23 the Subject is only propagated if the SecurityManager\n+ * is enabled, while in Java 24+ it is never propagated.\n+ * <p>\n+ * Hadoop security heavily relies on the original behavior, as Subject is at the\n+ * core of JAAS. This class wraps thread. It overrides start() and saves the\n+ * Subject of the current thread, and wraps the payload in a\n+ * Subject.doAs()/callAs() call to restore it in the newly created Thread.\n+ * <p>\n+ * When specifying a Runnable, this class is used in exactly the same way as\n+ * Thread.\n+ * <p>\n+ * {@link #run()} cannot be directly overridden, as that would also override the\n+ * subject restoration logic. SubjectInheritingThread provides a {@link work()}\n+ * method instead, which is wrapped and invoked by its own final {@link run()}\n+ * method.\n+ */\n+public class SubjectInheritingThread extends Thread {\n+\n+  private Subject startSubject;\n+  // {@link Thread#target} is private, so we need our own\n+  private Runnable hadoopTarget;\n+\n+  /**\n+   * Behaves similarly to {@link Thread#Thread()} constructor, but the code to run\n+   * must be specified by overriding the {@link #work()} instead of the {link\n+   * #run()} method.\n+   */\n+  public SubjectInheritingThread() {\n+    super();\n+  }\n+\n+  /**\n+   * Behaves similarly to {@link Thread#Thread(Runnable)} constructor.\n+   *\n+   * @param target the object whose {@code run} method is invoked when this thread\n+   *               is started. If {@code null}, this classes {@code run} method\n+   *               does nothing.\n+   */\n+  public SubjectInheritingThread(Runnable target) {\n+    super();\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similarly to {@link Thread#Thread(ThreadGroup, Runnable)}\n+   * constructor.\n+   *\n+   * @param group  the thread group. If {@code null} and there is a security\n+   *               manager, the group is determined by\n+   *               {@linkplain SecurityManager#getThreadGroup\n+   *               SecurityManager.getThreadGroup()}. If there is not a security\n+   *               manager or {@code\n+   *         SecurityManager.getThreadGroup()} returns {@code null}, the group is\n+   *               set to the current thread's thread group.\n+   *\n+   * @param target the object whose {@code run} method is invoked when this thread\n+   *               is started. If {@code null}, this thread's run method is\n+   *               invoked.\n+   * @throws SecurityException if the current thread cannot create a thread in the\n+   *                           specified thread group\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, Runnable target) {\n+    // The target passed to Thread has no effect, we only pass it\n+    // because there is no super(group) constructor.\n+    super(group, target);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similarly to {@link Thread#Thread(Runnable, String)} constructor.\n+   *\n+   * @param target the object whose {@code run} method is invoked when this thread\n+   *               is started. If {@code null}, this thread's run method is\n+   *               invoked.\n+   *\n+   * @param name   the name of the new thread\n+   *\n+   * @throws SecurityException if the current thread cannot create a thread in the\n+   *                           specified thread group\n+   */\n+  public SubjectInheritingThread(Runnable target, String name) {\n+    super(name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similarly to {@link Thread#Thread(String)} constructor.\n+   *\n+   * @param name the name of the new thread\n+   */\n+  public SubjectInheritingThread(String name) {\n+    super(name);\n+  }\n+\n+  /**\n+   * Behaves similarly to {@link Thread#Thread(ThreadGroup, String)} constructor.\n+   *\n+   * @param group the thread group. If {@code null} and there is a security\n+   *              manager, the group is determined by\n+   *              {@linkplain SecurityManager#getThreadGroup\n+   *              SecurityManager.getThreadGroup()}. If there is not a security\n+   *              manager or {@code\n+   *         SecurityManager.getThreadGroup()} returns {@code null}, the group is\n+   *              set to the current thread's thread group.\n+   *\n+   * @param name  the name of the new thread\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, String name) {\n+    super(group, name);\n+  }\n+\n+  /**\n+   * Behaves similarly to {@link Thread#Thread(ThreadGroup, Runnable, String)}\n+   * constructor.\n+   *\n+   * @param group  the thread group. If {@code null} and there is a security\n+   *               manager, the group is determined by\n+   *               {@linkplain SecurityManager#getThreadGroup\n+   *               SecurityManager.getThreadGroup()}. If there is not a security\n+   *               manager or {@code\n+   *         SecurityManager.getThreadGroup()} returns {@code null}, the group is\n+   *               set to the current thread's thread group.\n+   *\n+   * @param target the object whose {@code run} method is invoked when this thread\n+   *               is started. If {@code null}, this thread's run method is\n+   *               invoked.\n+   *\n+   * @param name   the name of the new thread\n+   *\n+   * @throws SecurityException if the current thread cannot create a thread in the\n+   *                           specified thread group or cannot override the\n+   *                           context class loader methods.\n+   */\n+  public SubjectInheritingThread(ThreadGroup group, Runnable target, String name) {\n+    super(group, name);\n+    this.hadoopTarget = target;\n+  }\n+\n+  /**\n+   * Behaves similarly to pre-Java 22 {@link Thread#start()}. It saves the current\n+   * Subject before starting the new thread, which is then used as the Subject for\n+   * the Runnable or the overridden work() method.\n+   */\n+  @Override\n+  public final void start() {\n+    if (!SubjectUtil.THREAD_INHERITS_SUBJECT) {\n+      startSubject = SubjectUtil.current();\n+    }\n+    super.start();\n+  }\n+\n+  /**\n+   * This is the equivalent of {@link Thread#run()}. Override this instead of\n+   * {@link #run()} Subject will be propagated like in pre-Java 22 Thread.\n+   */\n+  public void work() {\n\nReview Comment:\n   The only way would be converting everything to use a separate  Runnable instead of subclassing Thread as suggested by Nicholas, but IMO that would be a much more intrusive change, with a high chance of getting some the hundreds of conversions wrong.\n\n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-02T07:41:15.782+0000", "updated": "2025-10-02T07:41:15.782+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18024229", "id": "18024229", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "stoty commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3359676121\n\n   > wow, this is a big patch. but we need it, don't we?\r\n   \r\n   Yes. IMO the Java language development process has really dropped the ball here.\r\n   Changing the Subject APIs while providing replacements is one thing, but breaking the whole Java authorization model was a big mistake.\r\n   \r\n   Strictly speaking we don't need to convert EVERY Thread instance, especially in the non-secure tests, but figuring out the cases where we can safely drop the Subject / UGI from the new Thread would be super hard and error-prone (and also fragile in case authenticated operations are added later there).\r\n   \r\n   > \r\n   > only looked at it briefly -will need to go through the full change before approval but I don't see any reason to block the change so far\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-02T07:48:53.839+0000", "updated": "2025-10-02T07:48:53.839+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18024245", "id": "18024245", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "hadoop-yetus commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3360239893\n\n   :broken_heart: **-1 overall**\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   | Vote | Subsystem | Runtime |  Logfile | Comment |\r\n   |:----:|----------:|--------:|:--------:|:-------:|\r\n   | +0 :ok: |  reexec  |  22m 57s |  |  Docker mode activated.  |\r\n   |||| _ Prechecks _ |\r\n   | +1 :green_heart: |  dupname  |   0m  0s |  |  No case conflicting files found.  |\r\n   | +0 :ok: |  codespell  |   0m  1s |  |  codespell was not available.  |\r\n   | +0 :ok: |  detsecrets  |   0m  1s |  |  detect-secrets was not available.  |\r\n   | -1 :x: |  @author  |   0m  0s | [/results-author.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/artifact/out/results-author.txt) |  The patch appears to contain 4 @author tags which the community has agreed to not allow in code contributions.  |\r\n   | -1 :x: |  test4tests  |   0m  0s |  |  The patch doesn't appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch.  |\r\n   |||| _ trunk Compile Tests _ |\r\n   | -1 :x: |  mvninstall  |  53m  0s | [/branch-mvninstall-root.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/artifact/out/branch-mvninstall-root.txt) |  root in trunk failed.  |\r\n   | +1 :green_heart: |  compile  |   1m 28s |  |  trunk passed with JDK Ubuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04  |\r\n   | +1 :green_heart: |  compile  |   1m 14s |  |  trunk passed with JDK Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09  |\r\n   | +1 :green_heart: |  checkstyle  |   0m 55s |  |  trunk passed  |\r\n   | +1 :green_heart: |  mvnsite  |   1m 22s |  |  trunk passed  |\r\n   | +1 :green_heart: |  javadoc  |   1m 11s |  |  trunk passed with JDK Ubuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04  |\r\n   | +1 :green_heart: |  javadoc  |   1m 41s |  |  trunk passed with JDK Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09  |\r\n   | +1 :green_heart: |  spotbugs  |   3m 12s |  |  trunk passed  |\r\n   | +1 :green_heart: |  shadedclient  |  42m 11s |  |  branch has no errors when building and testing our client artifacts.  |\r\n   |||| _ Patch Compile Tests _ |\r\n   | -1 :x: |  mvninstall  |   0m 30s | [/patch-mvninstall-hadoop-hdfs-project_hadoop-hdfs.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/artifact/out/patch-mvninstall-hadoop-hdfs-project_hadoop-hdfs.txt) |  hadoop-hdfs in the patch failed.  |\r\n   | -1 :x: |  compile  |   0m 31s | [/patch-compile-hadoop-hdfs-project_hadoop-hdfs-jdkUbuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/artifact/out/patch-compile-hadoop-hdfs-project_hadoop-hdfs-jdkUbuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04.txt) |  hadoop-hdfs in the patch failed with JDK Ubuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04.  |\r\n   | -1 :x: |  javac  |   0m 31s | [/patch-compile-hadoop-hdfs-project_hadoop-hdfs-jdkUbuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/artifact/out/patch-compile-hadoop-hdfs-project_hadoop-hdfs-jdkUbuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04.txt) |  hadoop-hdfs in the patch failed with JDK Ubuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04.  |\r\n   | -1 :x: |  compile  |   0m 29s | [/patch-compile-hadoop-hdfs-project_hadoop-hdfs-jdkPrivateBuild-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/artifact/out/patch-compile-hadoop-hdfs-project_hadoop-hdfs-jdkPrivateBuild-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09.txt) |  hadoop-hdfs in the patch failed with JDK Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09.  |\r\n   | -1 :x: |  javac  |   0m 29s | [/patch-compile-hadoop-hdfs-project_hadoop-hdfs-jdkPrivateBuild-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/artifact/out/patch-compile-hadoop-hdfs-project_hadoop-hdfs-jdkPrivateBuild-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09.txt) |  hadoop-hdfs in the patch failed with JDK Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09.  |\r\n   | +1 :green_heart: |  blanks  |   0m  0s |  |  The patch has no blanks issues.  |\r\n   | -0 :warning: |  checkstyle  |   0m 18s | [/buildtool-patch-checkstyle-hadoop-hdfs-project_hadoop-hdfs.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/artifact/out/buildtool-patch-checkstyle-hadoop-hdfs-project_hadoop-hdfs.txt) |  The patch fails to run checkstyle in hadoop-hdfs  |\r\n   | -1 :x: |  mvnsite  |   0m 30s | [/patch-mvnsite-hadoop-hdfs-project_hadoop-hdfs.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/artifact/out/patch-mvnsite-hadoop-hdfs-project_hadoop-hdfs.txt) |  hadoop-hdfs in the patch failed.  |\r\n   | -1 :x: |  javadoc  |   0m 31s | [/patch-javadoc-hadoop-hdfs-project_hadoop-hdfs-jdkUbuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/artifact/out/patch-javadoc-hadoop-hdfs-project_hadoop-hdfs-jdkUbuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04.txt) |  hadoop-hdfs in the patch failed with JDK Ubuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04.  |\r\n   | -1 :x: |  javadoc  |   0m 30s | [/patch-javadoc-hadoop-hdfs-project_hadoop-hdfs-jdkPrivateBuild-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/artifact/out/patch-javadoc-hadoop-hdfs-project_hadoop-hdfs-jdkPrivateBuild-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09.txt) |  hadoop-hdfs in the patch failed with JDK Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09.  |\r\n   | -1 :x: |  spotbugs  |   0m 29s | [/patch-spotbugs-hadoop-hdfs-project_hadoop-hdfs.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/artifact/out/patch-spotbugs-hadoop-hdfs-project_hadoop-hdfs.txt) |  hadoop-hdfs in the patch failed.  |\r\n   | -1 :x: |  shadedclient  |  11m 13s |  |  patch has errors when building and testing our client artifacts.  |\r\n   |||| _ Other Tests _ |\r\n   | -1 :x: |  unit  |   0m 32s | [/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/artifact/out/patch-unit-hadoop-hdfs-project_hadoop-hdfs.txt) |  hadoop-hdfs in the patch failed.  |\r\n   | -1 :x: |  asflicense  |   0m 33s | [/results-asflicense.txt](https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/artifact/out/results-asflicense.txt) |  The patch generated 1 ASF License warnings.  |\r\n   |  |   | 142m 39s |  |  |\r\n   \r\n   \r\n   | Subsystem | Report/Notes |\r\n   |----------:|:-------------|\r\n   | Docker | ClientAPI=1.51 ServerAPI=1.51 base: https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/artifact/out/Dockerfile |\r\n   | Optional Tests | dupname asflicense compile javac javadoc mvninstall mvnsite unit shadedclient spotbugs checkstyle codespell detsecrets |\r\n   | uname | Linux fbae4de0f31e 5.15.0-156-generic #166-Ubuntu SMP Sat Aug 9 00:02:46 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux |\r\n   | Build tool | maven |\r\n   | Personality | dev-support/bin/hadoop.sh |\r\n   | git revision | trunk / d1155950df2132a64c0963deef8f218477f387dd |\r\n   | Default Java | Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09 |\r\n   | Multi-JDK versions | /usr/lib/jvm/java-11-openjdk-amd64:Ubuntu-11.0.27+6-post-Ubuntu-0ubuntu120.04 /usr/lib/jvm/java-8-openjdk-amd64:Private Build-1.8.0_452-8u452-ga~us1-0ubuntu1~20.04-b09 |\r\n   |  Test Results | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/testReport/ |\r\n   | Max. process+thread count | 529 (vs. ulimit of 5500) |\r\n   | modules | C: hadoop-hdfs-project/hadoop-hdfs U: hadoop-hdfs-project/hadoop-hdfs |\r\n   | Console output | https://ci-hadoop.apache.org/job/hadoop-multibranch/job/PR-7892/15/console |\r\n   | versions | git=2.25.1 maven=3.9.11 spotbugs=4.2.2 |\r\n   | Powered by | Apache Yetus 0.14.0 https://yetus.apache.org |\r\n   \r\n   \r\n   This message was automatically generated.\r\n   \r\n   \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-02T09:55:55.594+0000", "updated": "2025-10-02T09:55:55.594+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13618780/comment/18030000", "id": "18030000", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "body": "pan3793 commented on PR #7892:\nURL: https://github.com/apache/hadoop/pull/7892#issuecomment-3405131340\n\n   Kindly ping @steveloughran, do you have further comments/advisors on this PR. There has been about one month since Java 25 GA, I see an increasing number of big data projects that depend on hadoop blocked by this PR to support Java 25. \n\n\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-15T08:17:00.301+0000", "updated": "2025-10-15T08:17:00.301+0000"}], "maxResults": 77, "total": 77, "startAt": 0}, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/2", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/critical.svg", "name": "Critical", "id": "2"}, "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/1", "description": "The issue is open and ready for the assignee to start work on it.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png", "name": "Open", "id": "1", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2", "id": 2, "key": "new", "colorName": "blue-gray", "name": "To Do"}}}}