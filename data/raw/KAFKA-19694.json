{"expand": "renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations", "id": "13628477", "self": "https://issues.apache.org/jira/rest/api/2/issue/13628477", "key": "KAFKA-19694", "fields": {"summary": "StreamsRebalanceListener is not triggered on Consumer.close()", "description": "In the consumer, we invoke the consumer rebalance {{onPartitionRevoked}} or {{onPartitionLost}} callbacks, when the consumer closes. The point is that the application may want to commit, or wipe the state if we are closing unsuccessfully.\r\n\r\nIn the {{{}StreamsRebalanceListener{}}}, we did not implement this behavior, which means when closing the consumer we may lose some progress, and in the worst case also miss that we have to wipe our local state state since we got fenced.\r\n\r\nWe should implement something like the {{ConsumerRebalanceListenerInvoker}} and invoke it in {{{}Consumer.close{}}}.", "reporter": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=lucasbru", "name": "lucasbru", "key": "JIRAUSER302322", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=JIRAUSER302322&avatarId=53242", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=JIRAUSER302322&avatarId=53242", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=JIRAUSER302322&avatarId=53242", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=JIRAUSER302322&avatarId=53242"}, "displayName": "Lucas Brutschy", "active": true, "timeZone": "Europe/Berlin"}, "comment": {"comments": [], "maxResults": 0, "total": 0, "startAt": 0}, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/3", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg", "name": "Major", "id": "3"}, "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}}}