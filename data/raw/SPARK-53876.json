{"expand": "renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations", "id": "13631289", "self": "https://issues.apache.org/jira/rest/api/2/issue/13631289", "key": "SPARK-53876", "fields": {"summary": "Addition of column-level Parquet compression preference in Spark", "description": "h4. *Problem*\r\n\r\nApache Spark currently allows only *global compression configuration* for Parquet files using:\r\n\r\n{{spark.sql.parquet.compression.codec = snappy | gzip | zstd | uncompressed}}\r\n\r\nHowever, many production datasets contain heterogeneous columns \u2014 for example:\r\n * text or categorical columns that compress better with {*}ZSTD{*},\r\n\r\n * numeric columns that perform better with {*}SNAPPY{*}.\r\n\r\nToday, Spark applies a single codec to the entire file, preventing users from optimizing storage and I/O performance per column.\r\n\r\n\r\nh4. Proposed Improvement\r\n\r\nIntroduce a new configuration key to define *per-column compression codecs* in a map format:\r\n\r\n{{spark.sql.parquet.column.compression.map = colA:zstd,colB:snappy,colC:gzip}}\r\n\r\n*Behavior:*\r\n * The global codec ({{{}spark.sql.parquet.compression.codec{}}}) remains the default for all columns.\r\n\r\n * Any column listed in {{spark.sql.parquet.column.compression.map}} will use its specified codec.\r\n\r\n * Unspecified columns continue to use the global codec.\r\n\r\n*Example:*\r\n\r\n{{--conf spark.sql.parquet.compression.codec=snappy \\}}\r\n\r\n{{--conf spark.sql.parquet.column.compression.map=\"country:zstd,price:snappy,comment:gzip\"\r\n\r\nEffect:-\r\n\r\n}}\r\n||Column||Codec||\r\n|country|zstd|\r\n|price|snappy|\r\n|comment|gzip|\r\n|all others|snappy (global default)|\r\n\r\n{{}}\r\n\r\n\u00a0", "reporter": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=prajwalrao", "name": "prajwalrao", "key": "JIRAUSER311164", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34055", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"}, "displayName": "Prajwal H G", "active": true, "timeZone": "Etc/UTC"}, "comment": {"comments": [{"self": "https://issues.apache.org/jira/rest/api/2/issue/13631289/comment/18033870", "id": "18033870", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=dongjoon", "name": "dongjoon", "key": "dongjoon", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=dongjoon&avatarId=42503", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dongjoon&avatarId=42503", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dongjoon&avatarId=42503", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dongjoon&avatarId=42503"}, "displayName": "Dongjoon Hyun", "active": true, "timeZone": "America/Los_Angeles"}, "body": "Apache Spark community has a policy which manages `Fix Version` and `Target Version` like the following. So, please don't set it when you file a JIRA issue.\r\nhttps://spark.apache.org/contributing.html\r\n{quote}Do not set the following fields:\r\n- Fix Version. This is assigned by committers only when resolved.\r\n- Target Version. This is assigned by committers to indicate a PR has been accepted for possible fix by the target version.{quote}", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=dongjoon", "name": "dongjoon", "key": "dongjoon", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=dongjoon&avatarId=42503", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dongjoon&avatarId=42503", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dongjoon&avatarId=42503", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dongjoon&avatarId=42503"}, "displayName": "Dongjoon Hyun", "active": true, "timeZone": "America/Los_Angeles"}, "created": "2025-10-29T15:52:18.803+0000", "updated": "2025-10-29T15:52:18.803+0000"}], "maxResults": 1, "total": 1, "startAt": 0}, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/3", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg", "name": "Major", "id": "3"}, "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/1", "description": "The issue is open and ready for the assignee to start work on it.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png", "name": "Open", "id": "1", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2", "id": 2, "key": "new", "colorName": "blue-gray", "name": "To Do"}}}}