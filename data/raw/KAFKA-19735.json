{"expand": "renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations", "id": "13629913", "self": "https://issues.apache.org/jira/rest/api/2/issue/13629913", "key": "KAFKA-19735", "fields": {"summary": "Add automatic commit offset caching in subscribe mode", "description": "Suppose that no new messages have been written to the target topic for a long time, for example, the producer has not generated new data for nearly an hour. On the consumer side, when the user sets enable.auto.commit=true, the\u00a0 OFFSET_COMMIT request will still be repeatedly submitted every 5 seconds. This not only wastes network resources but also increases the burden on __consumer_offset.\r\n\r\n\u00a0\r\nTherefore, maybe we can add a cache for committed offsets to check if the currently committed offset is consistent with the most recently successfully committed offset. If they are the same, this offset commit can be ignored. Of course, all the above applies to the subscribe mode.\r\n\r\n\u00a0\r\nAdvantages:\r\n * Reduce unnecessary network requests\r\n * Alleviate the processing pressure on the broker side\r\n * Relieve the pressure of log cleaning for __consumer_offset\r\n\r\n\u00a0\r\nDisadvantage:\r\n * There may be hidden bugs that need to be discussed and identified\r\n\u00a0\r\n\u00a0", "reporter": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=kangning", "name": "kangning", "key": "JIRAUSER306086", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=JIRAUSER306086&avatarId=53662", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=JIRAUSER306086&avatarId=53662", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=JIRAUSER306086&avatarId=53662", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=JIRAUSER306086&avatarId=53662"}, "displayName": "kangning.li", "active": true, "timeZone": "Etc/UTC"}, "comment": {"comments": [{"self": "https://issues.apache.org/jira/rest/api/2/issue/13629913/comment/18023119", "id": "18023119", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=lianetm", "name": "lianetm", "key": "JIRAUSER300183", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=JIRAUSER300183&avatarId=52523", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=JIRAUSER300183&avatarId=52523", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=JIRAUSER300183&avatarId=52523", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=JIRAUSER300183&avatarId=52523"}, "displayName": "Lianet Magrans", "active": true, "timeZone": "America/Toronto"}, "body": "Hey, in case it helps:\r\n * I filed something related a while back here https://issues.apache.org/jira/browse/KAFKA-16233 \u00a0\r\n * why subscribe mode only? I expect that whatever improvement we want to consider in this area would be for consumers with auto.commit enabled + group Id (regardless of using subscribe or not). A consumer using assign can auto commit too (if it has group ID + auto.commit enabled)", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=lianetm", "name": "lianetm", "key": "JIRAUSER300183", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=JIRAUSER300183&avatarId=52523", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=JIRAUSER300183&avatarId=52523", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=JIRAUSER300183&avatarId=52523", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=JIRAUSER300183&avatarId=52523"}, "displayName": "Lianet Magrans", "active": true, "timeZone": "America/Toronto"}, "created": "2025-09-26T14:01:25.965+0000", "updated": "2025-09-26T14:01:25.965+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13629913/comment/18028606", "id": "18028606", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=kangning", "name": "kangning", "key": "JIRAUSER306086", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=JIRAUSER306086&avatarId=53662", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=JIRAUSER306086&avatarId=53662", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=JIRAUSER306086&avatarId=53662", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=JIRAUSER306086&avatarId=53662"}, "displayName": "kangning.li", "active": true, "timeZone": "Etc/UTC"}, "body": "[~lianetm] \u00a0 Sorry for the late reply. I think in assign mode, apart from the current consumer being able to modify the offset of the corresponding TopicPartition, the Admin can also make modifications. Let\u2019s assume such a scenario: the offset cached by the consumer is 10, and all subsequent requests to commit offset 10 will return successfully quickly without being sent to the broker. At this point, if the Admin is used to set the offset to 11, the consumer will not be aware of this change. As a result, the consumer caches an invalid offset, which is inconsistent with expectations.\u00a0 \u00a0WDYT ?\u00a0", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=kangning", "name": "kangning", "key": "JIRAUSER306086", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=JIRAUSER306086&avatarId=53662", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=JIRAUSER306086&avatarId=53662", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=JIRAUSER306086&avatarId=53662", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=JIRAUSER306086&avatarId=53662"}, "displayName": "kangning.li", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-10-09T09:47:46.906+0000", "updated": "2025-10-09T09:48:44.497+0000"}], "maxResults": 2, "total": 2, "startAt": 0}, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/4", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg", "name": "Minor", "id": "4"}, "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/1", "description": "The issue is open and ready for the assignee to start work on it.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png", "name": "Open", "id": "1", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2", "id": 2, "key": "new", "colorName": "blue-gray", "name": "To Do"}}}}