{
  "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
  "id": "13632993",
  "self": "https://issues.apache.org/jira/rest/api/2/issue/13632993",
  "key": "KAFKA-19850",
  "fields": {
    "fixVersions": [],
    "resolution": null,
    "customfield_12312322": null,
    "customfield_12312323": null,
    "customfield_12312320": null,
    "customfield_12310420": "9223372036854775807",
    "customfield_12312321": null,
    "customfield_12312328": null,
    "customfield_12312329": null,
    "customfield_12312326": null,
    "customfield_12310300": null,
    "customfield_12312327": null,
    "customfield_12312324": null,
    "customfield_12312720": null,
    "customfield_12312325": null,
    "lastViewed": null,
    "priority": {
      "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
      "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
      "name": "Major",
      "id": "3"
    },
    "labels": [],
    "customfield_12312333": null,
    "customfield_12312334": null,
    "customfield_12313422": "false",
    "customfield_12310310": "0.0",
    "customfield_12312331": null,
    "customfield_12312332": null,
    "aggregatetimeoriginalestimate": null,
    "timeestimate": null,
    "customfield_12312330": null,
    "versions": [
      {
        "self": "https://issues.apache.org/jira/rest/api/2/version/12355509",
        "id": "12355509",
        "name": "4.2.0",
        "archived": false,
        "released": false
      }
    ],
    "customfield_12311120": null,
    "customfield_12313826": null,
    "customfield_12312339": null,
    "issuelinks": [
      {
        "id": "12710774",
        "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12710774",
        "type": {
          "id": "12310560",
          "name": "Problem/Incident",
          "inward": "is caused by",
          "outward": "causes",
          "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310560"
        },
        "inwardIssue": {
          "id": "13613982",
          "key": "KAFKA-19078",
          "self": "https://issues.apache.org/jira/rest/api/2/issue/13613982",
          "fields": {
            "summary": "Implement automatic controller addition to cluster metadata partition",
            "status": {
              "self": "https://issues.apache.org/jira/rest/api/2/status/5",
              "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
              "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
              "name": "Resolved",
              "id": "5",
              "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
              }
            },
            "priority": {
              "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
              "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
              "name": "Major",
              "id": "3"
            },
            "issuetype": {
              "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
              "id": "7",
              "description": "The sub-task of the issue",
              "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
              "name": "Sub-task",
              "subtask": true,
              "avatarId": 21146
            }
          }
        }
      }
    ],
    "customfield_12313825": null,
    "assignee": null,
    "customfield_12312337": null,
    "customfield_12313823": null,
    "customfield_12312338": null,
    "customfield_12311920": null,
    "customfield_12313822": null,
    "customfield_12312335": null,
    "customfield_12313821": null,
    "customfield_12312336": null,
    "customfield_12313820": null,
    "status": {
      "self": "https://issues.apache.org/jira/rest/api/2/status/1",
      "description": "The issue is open and ready for the assignee to start work on it.",
      "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
      "name": "Open",
      "id": "1",
      "statusCategory": {
        "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
        "id": 2,
        "key": "new",
        "colorName": "blue-gray",
        "name": "To Do"
      }
    },
    "components": [],
    "customfield_12312026": null,
    "customfield_12312023": null,
    "customfield_12312024": null,
    "aggregatetimeestimate": null,
    "customfield_12312022": null,
    "customfield_12310921": null,
    "customfield_12310920": "9223372036854775807",
    "customfield_12312823": null,
    "creator": {
      "self": "https://issues.apache.org/jira/rest/api/2/user?username=showuon",
      "name": "showuon",
      "key": "showuon",
      "avatarUrls": {
        "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=showuon&avatarId=42594",
        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=showuon&avatarId=42594",
        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=showuon&avatarId=42594",
        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=showuon&avatarId=42594"
      },
      "displayName": "Luke Chen",
      "active": true,
      "timeZone": "Etc/UTC"
    },
    "subtasks": [],
    "reporter": {
      "self": "https://issues.apache.org/jira/rest/api/2/user?username=showuon",
      "name": "showuon",
      "key": "showuon",
      "avatarUrls": {
        "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=showuon&avatarId=42594",
        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=showuon&avatarId=42594",
        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=showuon&avatarId=42594",
        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=showuon&avatarId=42594"
      },
      "displayName": "Luke Chen",
      "active": true,
      "timeZone": "Etc/UTC"
    },
    "aggregateprogress": {
      "progress": 0,
      "total": 0
    },
    "customfield_12313520": null,
    "customfield_12310250": null,
    "progress": {
      "progress": 0,
      "total": 0
    },
    "customfield_12313924": null,
    "votes": {
      "self": "https://issues.apache.org/jira/rest/api/2/issue/KAFKA-19850/votes",
      "votes": 0,
      "hasVoted": false
    },
    "customfield_12313920": null,
    "issuetype": {
      "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
      "id": "4",
      "description": "An improvement or enhancement to an existing feature or task.",
      "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
      "name": "Improvement",
      "subtask": false,
      "avatarId": 21140
    },
    "timespent": null,
    "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@782a16a6[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@262105be[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4d44d6bf[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@63e6365c[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@47c0581a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@3951c498[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@524b1c23[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@4d84e0[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@45881c7b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@724a6556[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@786ad538[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@14ec3451[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
    "customfield_12314141": null,
    "customfield_12314140": null,
    "project": {
      "self": "https://issues.apache.org/jira/rest/api/2/project/12311720",
      "id": "12311720",
      "key": "KAFKA",
      "name": "Kafka",
      "projectTypeKey": "software",
      "avatarUrls": {
        "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12311720&avatarId=35864",
        "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311720&avatarId=35864",
        "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311720&avatarId=35864",
        "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311720&avatarId=35864"
      },
      "projectCategory": {
        "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/10560",
        "id": "10560",
        "description": "Apache Kafka projects",
        "name": "Kafka"
      }
    },
    "aggregatetimespent": null,
    "customfield_12312520": null,
    "customfield_12312521": "Fri Oct 31 11:39:52 UTC 2025",
    "customfield_12314422": null,
    "customfield_12314421": null,
    "customfield_12314146": null,
    "customfield_12314420": null,
    "customfield_12314145": null,
    "customfield_12314144": null,
    "customfield_12314143": null,
    "resolutiondate": null,
    "workratio": -1,
    "customfield_12312923": null,
    "customfield_12312920": null,
    "customfield_12312921": null,
    "watches": {
      "self": "https://issues.apache.org/jira/rest/api/2/issue/KAFKA-19850/watchers",
      "watchCount": 5,
      "isWatching": false
    },
    "created": "2025-10-31T10:23:35.000+0000",
    "customfield_10022": null,
    "updated": "2025-10-31T11:39:52.000+0000",
    "timeoriginalestimate": null,
    "description": "In v4.2.0, we are able to auto join a controller with the configuration `controller.quorum.auto.join.enable=true` set ([KIP-853|https://cwiki.apache.org/confluence/display/KAFKA/KIP-853%3A+KRaft+Controller+Membership+Changes#KIP853:KRaftControllerMembershipChanges-Controllerautojoining](KAFKA-19078)). This is a good improvement for controller addition, but it has a UX issue, which is that when a controller is removed via removeVoterRequest, it will be added immediately due to `controller.quorum.auto.join.enable=true`. In the KIP, we also mention you have to stop the controller before removing the controller:\r\n\r\n \r\n{noformat}\r\ncontroller.quorum.auto.join.enable:\r\n\r\nControls whether a KRaft controller should automatically join the cluster \r\nmetadata partition for its cluster id. If the configuration is set to \r\ntrue the controller must be stopped before removing the controller with kafka-metadata-quorum remove-controller.{noformat}\r\n \r\n\r\nThis is not a user friendly behavior in my opinion. And it will cause many confusion to users and thought there is something wrong in the controller removal. Furthermore, in the kubernetes environment which is controlled by the operator, it is not the cloud native way to shutdown a node, do some operation, then start it up. \r\n\r\n \r\n\r\nSo, I propose we can improve it by \"the removed controller will not be auto joined before this controller restarted\". That is:\r\n1. Once the controller is removed from voters set, it won't be auto joined even if `controller.quorum.auto.join.enable=true`\r\n\r\n2. The controller can be manually join the voters in this state\r\n\r\n3. The controller node will be auto join the voters set after node restarted.\r\n\r\n \r\n\r\nSo basically, the semantics is not changed, it just add some unexpected remove/add loop. Thoughts?\r\n\r\n \r\n\r\n ",
    "customfield_10010": null,
    "customfield_12314523": null,
    "customfield_12314127": null,
    "customfield_12314522": null,
    "customfield_12314126": null,
    "customfield_12314521": null,
    "customfield_12314125": null,
    "customfield_12314520": null,
    "customfield_12314124": null,
    "customfield_12312340": null,
    "customfield_12314123": null,
    "customfield_12312341": null,
    "customfield_12312220": null,
    "customfield_12314122": null,
    "customfield_12314121": null,
    "customfield_12314120": null,
    "customfield_12314129": null,
    "customfield_12314524": null,
    "customfield_12314128": null,
    "summary": "KRaft voter auto join will add a removed voter immediately",
    "customfield_12314130": null,
    "customfield_12310291": null,
    "customfield_12310290": null,
    "customfield_12314138": null,
    "customfield_12314137": null,
    "environment": null,
    "customfield_12314136": null,
    "customfield_12314135": null,
    "customfield_12311020": null,
    "customfield_12314134": null,
    "duedate": null,
    "customfield_12314132": null,
    "customfield_12314131": null,
    "customfield_12311820": "0|z1ye54:",
    "customfield_12314139": null
  }
}