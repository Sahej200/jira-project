{"expand": "renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations", "id": "13633064", "self": "https://issues.apache.org/jira/rest/api/2/issue/13633064", "key": "SPARK-54122", "fields": {"summary": "Improve the testing experience for TransformWithState", "description": "Currently it's hard to write unit tests for user's implementation of StatefulProcessor used in TransformWithState. User either needs to test it by running actual streaming query, or they need to refactor business logic into a separate function (that will be called from handleInputRows), and write unit tests for that function.\r\n\u00a0\r\nI propose to add a simple testing framework for TransformWithState that will allow users easily test their business logic inside StatefulProcessor.\r\n\u00a0\r\nOn high-level, it's a class TwsTester that takes StatefulProcessor and allows to feed in input rows and immediately returns what rows would be produced by TWS. It also allows to set and inspect state. This can be used in unit tests without having to run streaming query and it won't need RocksDB (it will use in-memory state store). I will start with implementing this for Scala users, potentially making it available for Python users later.", "reporter": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=fedimser", "name": "fedimser", "key": "JIRAUSER311356", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=JIRAUSER311356&avatarId=54569", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=JIRAUSER311356&avatarId=54569", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=JIRAUSER311356&avatarId=54569", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=JIRAUSER311356&avatarId=54569"}, "displayName": "Dmytro Fedoriaka", "active": true, "timeZone": "Etc/UTC"}, "comment": {"comments": [], "maxResults": 0, "total": 0, "startAt": 0}, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/4", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg", "name": "Minor", "id": "4"}, "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/1", "description": "The issue is open and ready for the assignee to start work on it.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png", "name": "Open", "id": "1", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2", "id": 2, "key": "new", "colorName": "blue-gray", "name": "To Do"}}}}