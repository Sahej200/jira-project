{"expand": "renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations", "id": "13631343", "self": "https://issues.apache.org/jira/rest/api/2/issue/13631343", "key": "KAFKA-19785", "fields": {"summary": "Two Kafka brokers were not active in 3 node cluster setup", "description": "Hi Team,\r\n\r\nWe were facing kafka issue where two of the kafka brokers were fenced and Kafka was not able to process messages. We are using Kafka 4.0.0 version. Below are the errors.\r\n\r\n\u00a0\r\n\r\nSep 22 09:41:42 s99ossv152 kafka[42245]: [2025-09-22 07:41:42,419] ERROR Encountered fatal fault: Unexpected error in raft IO thread (org.apache.kafka.server.fault.ProcessTerminatingFaultHandler)\r\nSep 22 09:41:42 s99ossv152 kafka[42245]: java.lang.IllegalStateException: Received request or response with leader OptionalInt[3] and epoch 55 *which is inconsistent with current leader* OptionalInt.empty and epoch 55\r\nSep 22 09:41:42 s99ossv152 kafka[42245]: #011at org.apache.kafka.raft.KafkaRaftClient.maybeTransition(KafkaRaftClient.java:2528) ~[kafka-raft-4.0.0.jar:?]\r\nSep 22 09:41:42 s99ossv152 kafka[42245]: #011at org.apache.kafka.raft.KafkaRaftClient.maybeHandleCommonResponse(KafkaRaftClient.java:2484) ~[kafka-raft-4.0.0.jar:?]\r\nSep 22 09:41:42 s99ossv152 kafka[42245]: #011at org.apache.kafka.raft.KafkaRaftClient.handleFetchResponse(KafkaRaftClient.java:1707) ~[kafka-raft-4.0.0.jar:?]\r\nSep 22 09:41:42 s99ossv152 kafka[42245]: #011at org.apache.kafka.raft.KafkaRaftClient.handleResponse(KafkaRaftClient.java:2568) ~[kafka-raft-4.0.0.jar:?]\r\nSep 22 09:41:42 s99ossv152 kafka[42245]: #011at org.apache.kafka.raft.KafkaRaftClient.handleInboundMessage(KafkaRaftClient.java:2724) ~[kafka-raft-4.0.0.jar:?]\r\nSep 22 09:41:42 s99ossv152 kafka[42245]: #011at org.apache.kafka.raft.KafkaRaftClient.poll(KafkaRaftClient.java:3460) ~[kafka-raft-4.0.0.jar:?]\r\nSep 22 09:41:42 s99ossv152 kafka[42245]: #011at org.apache.kafka.raft.KafkaRaftClientDriver.doWork(KafkaRaftClientDriver.java:64) [kafka-raft-4.0.0.jar:?]\r\nSep 22 09:41:42 s99ossv152 kafka[42245]: #011at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:136) [kafka-server-common-4.0.0.jar:?]\r\n\r\nBelow metrics shows Fenceborker count as 2.0\r\n\r\nkafka_controller_KafkaController_Value\\{name=\"ActiveBrokerCount\",} 1.0\r\nkafka_controller_KafkaController_Value\\{name=\"GlobalTopicCount\",} 23.0\r\nkafka_controller_KafkaController_Value{name=\"{*}FencedBrokerCount{*}\",} 2.0\r\n\r\nPlease help us to resolve this issue.", "reporter": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=sravani09", "name": "sravani09", "key": "JIRAUSER308976", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Sravani", "active": true, "timeZone": "Asia/Kolkata"}, "comment": {"comments": [], "maxResults": 0, "total": 0, "startAt": 0}, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/3", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg", "name": "Major", "id": "3"}, "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/1", "description": "The issue is open and ready for the assignee to start work on it.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png", "name": "Open", "id": "1", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2", "id": 2, "key": "new", "colorName": "blue-gray", "name": "To Do"}}}}